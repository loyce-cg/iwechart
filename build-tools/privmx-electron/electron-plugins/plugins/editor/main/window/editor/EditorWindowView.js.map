{"version":3,"sources":["window/editor/EditorWindowView.ts"],"names":[],"mappings":"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","file":"EditorWindowView.js","sourcesContent":["import {JQuery as $, webUtils, window as wnd, Q, Types, component} from \"pmc-web\";\nimport {app} from \"pmc-mail\";\nimport {func as mainTemplate} from \"./template/main.html\";\nimport {func as toolbarTemplate} from \"./template/toolbar.html\";\nimport {func as editorBannerTemplate} from \"./template/editor-banner.html\";\nimport {Mindmap} from \"./editors/Mindmap\";\nimport {TextEdit} from \"./editors/TextEdit\";\nimport {HtmlEdit} from \"./editors/HtmlEdit\";\nimport {Editor, EditorOptions} from \"./editors/Editor\";\nimport {NotesPreferences} from \"../../main/EditorPlugin\";\nimport {Model, EntryModel} from \"./EditorWindowController\";\nimport { StyledEditor } from \"./editors/StyledEditor\";\n\nexport interface State {\n    docked: boolean;\n    editMode: boolean;\n    previewMode: boolean;\n    entry: EntryModel;\n    dirty: boolean;\n    customHtml: string;\n    rightSideHtml: string;\n    editModeFromPreview: boolean;\n    canPrint: boolean;\n    canSaveAsPdf: boolean;\n    boundTasksStr: string;\n}\n\ndeclare var html2pdf: any;\n\nexport class EditorWindowView extends wnd.base.BaseWindowView<Model> {\n    \n    static readonly MAX_FILENAME_WIDTH: number = 230;\n    \n    currentViewId: number;\n    $toolbar: JQuery;\n    $editor: JQuery;\n    toolbarTmpl: Types.webUtils.MailTemplate<State>;\n    state: State;\n    editor: Editor<any>;\n    lastEditAttemptEventData: any;\n    $savingBanner: JQuery;\n    showingFileMenu: boolean;\n    lastMouseMoveEvent: JQueryMouseEventObject;\n    previewMode: boolean;\n    isCtrlKeyDown: boolean = false;\n    $buttonsOverlay: JQuery;\n    $toolbarContents: JQuery;\n    editModeFromPreview: boolean = false;\n    personsComponent: component.persons.PersonsView;\n    notifications: component.notification.NotificationView;\n    editorButtons: component.editorbuttons.EditorButtonsView;\n    taskTooltip: component.tasktooltip.TaskTooltipView;\n    taskChooser: component.taskchooser.TaskChooserView;\n    overlayVisibilityTimer: NodeJS.Timer;\n    $mainContent:  JQuery;\n    toolbarOverflownWidth: number = -1;\n    fileLoadedDeferred: Q.Deferred<void> = Q.defer();\n    entry: EntryModel;\n    html2canvasScaleMultiplier: number = 1;\n    taskStatuses: { [taskId: string]: string } = {};\n    printMode: boolean = false;\n    \n    constructor(parent: Types.app.ViewParent) {\n        super(parent, mainTemplate);\n        this.personsComponent = this.addComponent(\"persons\", new component.persons.PersonsView(this, this.helper));\n        this.notifications = this.addComponent(\"notifications\", new component.notification.NotificationView(this));\n        this.editorButtons = this.addComponent(\"editorbuttons\", new component.editorbuttons.EditorButtonsView(this));\n        this.taskTooltip = this.addComponent(\"tasktooltip\", new component.tasktooltip.TaskTooltipView(this));\n        this.taskChooser = this.addComponent(\"taskchooser\", new component.taskchooser.TaskChooserView(this));\n        this.taskTooltip.refreshAvatars = () => {\n            this.personsComponent.refreshAvatars();\n        }\n    }\n    \n    initWindow(model: Model) {\n        this.printMode = !!model.printMode;\n        return Q().then(() => {\n            if (model.printMode) {\n                $(\"html\").addClass(\"print-mode\");\n                $(\"body\").addClass(\"print-mode\");\n            }\n            $(\"body\").attr(\"data-style-name\", model.initialStyleName);\n            this.$mainContent = this.$main.find(\".main-content\");\n            this.personsComponent.$main = this.$main;\n            this.editorButtons.$main = this.$main;\n            this.editorButtons.$container = this.$mainContent;\n            this.notifications.$container = this.$main.find(\".notifications\");\n            this.currentViewId = model.currentViewId;\n            this.previewMode = model.previewMode;\n            this.$toolbar = this.$mainContent.find(\".toolbar-container\");\n            this.$editor = this.$mainContent.find(\".editor\");\n            this.$statusBar = this.$mainContent.find(\".status-bar\");\n            this.taskTooltip.$container = this.$main;\n            this.taskChooser.$container = this.$main;\n            this.toolbarTmpl = this.templateManager.createTemplate(toolbarTemplate);\n            \n            return Q().then(() => {\n                return this.personsComponent.triggerInit();\n            }).then(() => {\n                return Q.all([\n                    this.notifications.triggerInit(),\n                    this.editorButtons.triggerInit(),\n                    this.taskTooltip.triggerInit(),\n                    this.taskChooser.triggerInit(),\n                ]);\n            });\n        })\n        .then(() => {\n            this.editorButtons.onContainerSizeChangedHandler(() => {\n                this.updatePaddingBottom();\n            });\n            this.updatePaddingBottom();\n            $(window).resize(this.onResizeWindow.bind(this));\n            \n            if (model.previewMode && model.docked) {\n                this.$mainContent.on(\"click\", this.onFocusedIn.bind(this));\n                this.bindTabSwitch();\n                this.bindEnterPressed();\n                \n            }\n            this.bindToolbarActions();\n            // this.$main.on(\"keydown\", this.onKeyDown.bind(this));\n            \n            this.prepareForDistractionFreeMode();\n            this.refreshPreviewMode();\n            this.bindEditorKeyPresses();\n        });\n    }\n        \n    bindToolbarActions(): void {\n        this.$mainContent.on(\"click\", \"[data-action=save]\", this.onSaveClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=enter-edit-mode]\", this.onEnterEditModeClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=exit-edit-mode]\", this.onExitEditModeClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=exit-edit-mode-and-close]\", this.onExitEditModeAndCloseClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=close]\", this.onCloseClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=rename]\", this.onRenameClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=open-mindmap-help]\", this.onOpenMindmapHelpClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=reload]\", this.onReloadClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=distracton-free-mode-toggle]\", this.onDistractionFreeModeToggleClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=popup-window]\", this.onPopupWindowClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=edit]\", this.onOpenEditWindowClick.bind(this));\n        this.$mainContent.on(\"click\", \".toolbar-container [data-action=download]\", this.onDownloadClick.bind(this));\n        this.$mainContent.on(\"click\", \".toolbar-container [data-action=attach-to-task]\", this.onAttachToTaskClick.bind(this));\n        this.$mainContent.on(\"click\", \".toolbar-container [data-action=send]\", this.onSendClick.bind(this));\n        this.$mainContent.on(\"click\", \".toolbar-container [data-action=print]\", this.onPrintClick.bind(this));\n        this.$mainContent.on(\"click\", \".toolbar-container [data-action=save-as-pdf]\", this.onSaveAsPdfClick.bind(this));\n        this.$mainContent.on(\"click\", \".toolbar-container [data-action=lock]\", this.onLockFileClick.bind(this));\n        this.$mainContent.on(\"click\", \".toolbar-container [data-action=unlock]\", this.onUnlockFileClick.bind(this));\n\n        this.$mainContent.on(\"click\", \".toolbar-container [data-action=history]\", this.onHistoryClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=open-toolbar-more]\", this.onOpenToolbarMoreClick.bind(this));\n        this.$mainContent.on(\"click\", \".context-menu-backdrop2\", this.onCloseToolbarMoreClick.bind(this));\n        this.$mainContent.on(\"click\", \".context-menu-toolbar-more\", this.onToolbarMoreItemClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-action=open-tools-menu]\", this.onToolbarToolsClick.bind(this));\n        this.$mainContent.on(\"click\", \".context-menu-toolbar-tools\", this.onToolbarToolsItemClick.bind(this));\n        this.$mainContent.on(\"click\", \"[data-task-id]\", this.onTaskClick.bind(this));\n    }\n    \n    toggleEditorHidden(hidden: boolean): void {\n        let $editor = this.$main.closest(\"body\");\n        $editor.toggleClass(\"hide\", hidden);\n    }\n    \n    onResizeWindow(): void {\n        this.updateToolbarItemsVisibility();\n    }\n    \n    updateToolbarItemsVisibility(): void {\n        let $toolbar = this.$toolbar.find(\".toolbar\");\n        let elementsFit = this.doInnerElementsFit($toolbar.get(0));\n        $toolbar.find(\".right-side-buttons\").toggleClass(\"invisible\", ! elementsFit);\n        $toolbar.parent().find(\".more-button\").toggleClass(\"hide\", elementsFit);\n    }\n    \n    onFocusedIn() {\n        this.triggerEvent(\"focusedIn\");\n    }\n    \n    load(currentViewId: number, text: string, docked: boolean, editMode: boolean, entry: EntryModel, newFile: boolean, preferences: NotesPreferences): void {\n        if (this.currentViewId != currentViewId) {\n            return;\n        }\n        let Type: {new(options: EditorOptions): Editor<any>, mimetype: string};\n        if (entry.mimeType == \"application/x-smm\") {\n            Type = Mindmap;\n        }\n        else if ((<any>entry.mimeType).startsWith(\"text/\")) {\n            Type = TextEdit;\n        }\n        else if (entry.mimeType == \"application/x-stt\") {\n            Type = entry.extl == \".stx\" ? TextEdit : HtmlEdit;\n        }\n        else if (entry.extl == \".smm\") {\n            Type = Mindmap;\n        }\n        else if (entry.extl == \".stx\" || entry.extl == \".txt\") {\n            Type = TextEdit;\n        }\n        else if (entry.extl == \".stt\") {\n            Type = HtmlEdit;\n        }\n        else {\n            throw new Error(this.i18n(\"plugin.editor.window.editor.error.unknownFileType\"));\n        }\n        this.entry = entry;\n        this.$mainContent.find(\"> .buttons\").toggleClass(\"hide\", !entry.canBeEditable);\n        this.$body.attr(\"data-style-name\", \"none\");\n        this.$body.attr(\"data-editor-margin\", \"0%\");\n        this.$editor.hide();\n        this.editor = new Type({\n            parent: this,\n            initState: text,\n            editMode: editMode,\n            newFile: newFile,\n            preferences: preferences,\n            previewMode: this.previewMode,\n            taskStatuses: this.taskStatuses,\n        });\n        this.editor.attach(this.$editor);\n        this.$editor.off('.editor');\n        this.$editor.on('focus.editor', () => {\n            this.editor.focus();\n        });\n        this.$editor.on('click.editor', () => {\n            this.editor.focus();\n        });\n        \n        this.state = {\n            docked: docked,\n            editMode: editMode,\n            previewMode: this.previewMode,\n            entry: entry,\n            dirty: false,\n            editModeFromPreview: false,\n            customHtml: this.editor.getCustomToolbarMenuHtml(),\n            rightSideHtml: this.editor.getCustomToolbarRightSideMenuHtml(),\n            canPrint: entry.mimeType == \"application/x-smm\" || entry.mimeType == \"application/x-stt\",\n            canSaveAsPdf: entry.mimeType == \"application/x-smm\" || entry.mimeType == \"application/x-stt\",\n            boundTasksStr: this.entry.boundTasksStr,\n        };\n        this.updateRelatedSection();\n        this.$toolbar.empty().append(this.toolbarTmpl.renderToJQ(this.state));\n        this.renderName();\n        this.editor.addEventListener(\"editAttemptWhenNotEditable\", this.onEditAttemptWhenNotEditable.bind(this));\n        this.editor.addEventListener(\"change\", this.onDirtyChange.bind(this));\n        this.editor.addEventListener(\"linkClick\", this.onLinkClick.bind(this));\n\n        this.editor.addEventListener(\"copy\", this.onEditorCopy.bind(this));\n        this.editor.addEventListener(\"paste\", this.onEditorPaste.bind(this));\n\n        this.triggerEvent(\"mimeTypeDetect\", Type.mimetype);\n        this.triggerEvent(\"newFileFlagConsumed\");\n        if (editMode) {\n            this.showEditModeBanner();\n        }\n        this.$editor.show();\n        this.$editor.addClass(\"pf-scrollable-horizontal\");\n        this.makeCustomScroll(this.$editor);\n        let $inner = this.$editor.children(\".pf-content\");\n        this.makeCustomScroll($inner);\n        this.$editor.data(\"pf-scroll\").$content = $inner.data(\"pf-scroll\").$content;\n        if (this.previewMode) {\n            this.addButtonsOverlay();\n        }\n        if (!this.previewMode) {\n            if (this.editor) {\n                this.editor.focus();\n            }\n        }\n        \n        this.refreshPreviewMode();\n        this.updateToolbarItemsVisibility();\n        this.$main.find(\".print-header\").text(entry.fileName);\n        this.updatePaddingBottom();\n        this.fileLoadedDeferred.resolve();\n    }\n    \n    getStyleName(): string {\n        if (this.editor instanceof StyledEditor) {\n            return this.editor && this.editor.data && this.editor.data.style ? this.editor.data.style.name : \"default\";\n        }\n        return null;\n    }\n    \n    setStyle(styleName: string, fontSize: string, margin: string): void {\n        this.$body.attr(\"data-style-name\", styleName);\n    }\n    \n    switchToEditMode(data: string): void {\n        this.editor.setEditMode(true);\n        this.showEditModeBanner();\n        if (data && this.lastEditAttemptEventData) {\n            let eventData = this.lastEditAttemptEventData;\n            this.lastEditAttemptEventData = null;\n            if (this.editor instanceof Mindmap) {\n                setTimeout(() => {\n                    $(eventData.event.target).trigger(eventData.event);\n                }, 1);\n            }\n            if (this.editor instanceof HtmlEdit) {\n                setTimeout(() => {\n                    if (this.editor) {\n                        this.editor.focus();\n                    }\n                }, 1);\n            }\n        }\n        this.state.editMode = true;\n        this.renderEditMode();\n        if (this.editor) {\n            this.editor.focus();\n        }\n    }\n    \n    setContent(currentViewId: number, text: string): void {\n        if (this.currentViewId != currentViewId) {\n            return;\n        }\n        this.editor.initState = text;\n        this.editor.backToInitState();\n        if (!this.previewMode) {\n            if (this.editor) {\n                this.editor.focus();\n            }\n        }\n    }\n    \n    updateContentPreview(currentViewId: number, text: string): void {\n        if (this.currentViewId != currentViewId) {\n            return;\n        }\n        this.editor.initState = text;\n        this.editor.backToInitState();\n        this.refreshPreviewMode();\n    }\n    \n    reset(): void {\n        if (this.editor) {\n            this.editor.backToInitState();\n            this.editor.focus();\n        }\n    }\n    \n    switchToEditModeAndChangeContent(text: string): void {\n        if (this.editor) {\n            this.editor.initState = text;\n            this.editor.backToInitState();\n            this.editor.setEditMode(true);\n            this.showEditModeBanner();\n            this.state.editMode = true;\n            this.renderEditMode();\n            this.editor.focus();\n        }\n    }\n    \n    exitEditModeWithoutChange(): void {\n        if (this.editor) {\n            this.editor.setEditMode(false);\n            this.state.editMode = false;\n            this.renderEditMode();\n            this.editor.focus();\n        }\n    }\n    \n    exitEditModeWithConfirm(text: string): void {\n        if (this.editor) {\n            this.editor.confirmSave(text);\n            this.editor.setEditMode(false);\n            this.state.editMode = false;\n            this.renderEditMode();\n            this.editor.focus();\n        }\n    }\n    \n    exitEditModeWithRevert(): void {\n        if (this.editor) {\n            this.editor.backToInitState();\n            this.editor.setEditMode(false);\n            this.state.editMode = false;\n            this.renderEditMode();\n            this.editor.focus();\n        }\n    }\n    \n    canGetState(): boolean {\n        return this.editor != null;\n    }\n    \n    getState(): string {\n        this.editor.beforeSave();\n        return this.editor.getState();\n    }\n    \n    getElements() {\n        return this.editor.getElements();\n    }\n    \n    isDirty(): boolean {\n        return this.editor && this.editor.isChanged();\n    }\n    \n    updateEntry(entry: EntryModel): void {\n        if (this.state) {\n            this.state.entry = entry;\n            this.renderName();\n            this.updateRelatedSection();\n        }\n    }\n    \n    confirmSave(text: string): void {\n        if (this.editor) {\n            this.editor.confirmSave(text);\n            this.editor.focus();\n        }\n    }\n    \n    focus(): void {\n        if (this.editor) {\n            this.editor.focus();\n        }\n    }\n    \n    onEditAttemptWhenNotEditable(data: any): void {\n        this.lastEditAttemptEventData = data;\n        this.triggerEvent(\"enterEditModeByChange\", true);\n    }\n    \n    onDirtyChange(dirty: boolean): void {\n        this.state.dirty = dirty;\n        this.renderDirty();\n    }\n    \n    onLinkClick(data: {url: string}): void {\n        this.triggerEventInTheSameTick(\"openUrl\", data.url);\n    }\n    \n    onSaveClick(): void {\n        this.triggerEvent(\"save\");\n    }\n    \n    onHistoryClick(): void {\n        this.triggerEvent(\"history\");\n    }\n    \n    onEnterEditModeClick(): void {\n        this.triggerEvent(\"enterEditMode\");\n    }\n    \n    onExitEditModeClick(): void {\n        this.triggerEvent(\"exitEditMode\");\n    }\n    \n    afterExitedEditMode(): void {\n        if (this.editModeFromPreview) {\n            this.editModeFromPreview = false;\n            this.addButtonsOverlay();\n            \n            this.previewMode = true;\n            this.state.previewMode = true;\n            this.state.editMode = false;\n            this.editor.editMode = false;\n            let $editorContents = this.$mainContent.find(\".editor\").detach();\n            this.editorButtons.$buttons.detach();\n            this.$mainContent.empty();\n            this.$mainContent.append($editorContents);\n            this.$mainContent.append(this.editorButtons.$buttons);\n        }\n    }\n    \n    onExitEditModeAndCloseClick(): void {\n        this.triggerEvent(\"exitEditModeAndClose\");\n    }\n    \n    onCloseClick(): void {\n        this.triggerEvent(\"close\");\n    }\n    \n    onRenameClick(): void {\n        this.triggerEvent(\"rename\");\n    }\n    \n    onOpenMindmapHelpClick(): void {\n        this.triggerEvent(\"openMindmapHelp\");\n    }\n    \n    onReloadClick(): void {\n        this.triggerEvent(\"reload\");\n    }\n    \n    onDistractionFreeModeToggleClick(): void {\n        this.triggerEventInTheSameTick(\"distractionFreeModeToggle\");\n    }\n    \n    onPopupWindowClick(): void {\n        this.triggerEvent(\"popupWindow\");\n    }\n    \n    renderDirty(): void {\n        if (this.state.dirty) {\n            this.$toolbar.find(\".toolbar\").addClass(\"dirty\");\n            this.$toolbar.find(\".toolbar [data-action=save]\").prop(\"disabled\", false);\n        }\n        else {\n            this.$toolbar.find(\".toolbar\").removeClass(\"dirty\");\n            this.$toolbar.find(\".toolbar [data-action=save]\").prop(\"disabled\", true);\n        }\n        if (this.state.editMode) {\n            this.triggerEvent(\"dirtyChange\", this.state.dirty);\n        }\n    }\n    \n    renderEditMode(): void {\n        if (this.state.editMode) {\n            this.$toolbar.find(\".toolbar\").addClass(\"edit-mode\");\n            this.$body.find(\".context-menu-toolbar-more\").addClass(\"edit-mode\");\n        }\n        else {\n            this.$toolbar.find(\".toolbar\").removeClass(\"edit-mode\");\n            this.$body.find(\".context-menu-toolbar-more\").removeClass(\"edit-mode\");\n        }\n        this.refreshPreviewMode();\n        this.triggerEvent(\"dirtyChange\", this.state.dirty);\n    }\n    \n    renderName(): void {\n        let rev = this.state.entry.fileName.split(\"\").reverse().join(\"\");\n        this.fontMetrics.add(rev);\n        this.fontMetrics.measure();\n        let l = this.fontMetrics.getMaxTextLength(rev, EditorWindowView.MAX_FILENAME_WIDTH, false);\n        let newText = (l < rev.length ? \"...\" : \"\") + rev.substr(0, l).split(\"\").reverse().join(\"\");\n        this.$toolbar.find(\".toolbar .file-name-with-rename-trigger .file-name\").text(newText);\n        $(\"body\").find(\".context-menu-file\").remove();\n    }\n    \n    showEditModeBanner(): void {\n        let text = this.helper.i18n(\"plugin.editor.window.editor.editModeBanner.text\");\n        let $banner = this.createBanner(text);\n        this.showAndHideBanner($banner, 500);\n    }\n    \n    showSavingBanner(): void {\n        if (!this.$savingBanner) {\n            let text = this.helper.i18n(\"plugin.editor.window.editor.savingBanner.text\");\n            this.$savingBanner = this.createBanner(text);\n            this.showBanner(this.$savingBanner);\n        }\n    }\n    \n    hideSavingBanner(): void {\n        if (this.$savingBanner) {\n            Q.delay(500)\n            .then(() => {\n                this.hideBanner(this.$savingBanner)\n                .then(() => {\n                    delete this.$savingBanner;\n                });\n            });\n        }\n    }\n    \n    createBanner(text: string): JQuery {\n        return this.templateManager.createTemplate(editorBannerTemplate).renderToJQ({text: text});\n    }\n    \n    showBanner($banner: JQuery): Q.Promise<void> {\n        return Q.Promise<void>(resolve => {\n            this.$mainContent.append($banner);\n            $banner.animate({opacity: 1}, 500, () => {\n                setTimeout(() => {\n                    resolve(null);\n                }, 500);\n            });\n        });\n    }\n    \n    hideBanner($banner: JQuery): Q.Promise<void> {\n        return Q.Promise<void>(resolve => {\n            $banner.animate({opacity: 0}, 500, () => {\n                $banner.remove();\n                resolve(null);\n            });\n        });\n    }\n    \n    showAndHideBanner($banner: JQuery, delay: number): void {\n        this.showBanner($banner)\n        .then(() => {\n            return Q.delay(delay)\n            .then(() => {\n                return this.hideBanner($banner);\n            });\n        });\n    }\n    \n    prepareForDistractionFreeMode(): void {\n        let hidingBarsForDFM = false;\n        let showingBarsForDFM = false;\n        this.$body.on(\"distraction-free-mode-on\", () => {\n            this.$body.addClass(\"distraction-free-mode\");\n            this.$toolbar.css({top: -this.$toolbar.outerHeight()});\n            this.$statusBar.css({bottom: -this.$statusBar.outerHeight()});\n            showingBarsForDFM = false;\n            hidingBarsForDFM = false;\n        });\n        this.$body.on(\"distraction-free-mode-off\", () => {\n            this.$body.removeClass(\"distraction-free-mode\");\n            this.$toolbar.css({top: 0});\n            this.$statusBar.css({bottom: 0});\n        });\n        this.$body.on(\"mousemove\", (event: JQueryMouseEventObject) => {\n            if (this.$body.hasClass(\"distraction-free-mode\")) {\n                if ((!showingBarsForDFM && event.pageY <= 5) || (showingBarsForDFM && event.pageY <= this.$toolbar.outerHeight())) {\n                    if (!showingBarsForDFM) {\n                        showingBarsForDFM = true;\n                        hidingBarsForDFM = false;\n                        this.$toolbar.stop(true, false).animate({top: 0});\n                        this.$statusBar.stop(true, false).animate({bottom: 0});\n                    }\n                }\n                else {\n                    if (!this.showingFileMenu) {\n                        this.$toolbar.trigger(\"mouseout\");\n                    }\n                }\n            }\n            this.lastMouseMoveEvent = event;\n        });\n        this.$body.on(\"mouseout\", \".toolbar-container,.status-bar\", event => {\n            if (this.$body.hasClass(\"distraction-free-mode\")) {\n                if (this.$toolbar.find(\"[data-prevent-toolbar-hide-when-visible]:visible\").length) {\n                    return;\n                }\n                if (event.pageY <= this.$toolbar.outerHeight()) {\n                    return;\n                }\n                if (!hidingBarsForDFM) {\n                    hidingBarsForDFM = true;\n                    showingBarsForDFM = false;\n                    this.$toolbar.stop(true, false).animate({top: -this.$toolbar.outerHeight()});\n                    this.$statusBar.stop(true, false).animate({bottom: -this.$statusBar.outerHeight()});\n                }\n            }\n        });\n    }\n    \n    refreshPreviewMode() {\n        this.$mainContent.toggleClass(\"preview-mode\", this.previewMode);\n        this.$mainContent.toggleClass(\"pf-scrollable\", this.previewMode);\n        this.$mainContent.removeClass(\"released\");\n        this.$buttonsOverlay = null;\n        \n        let $htmlEditor = this.$editor.find(\".html-editor\");\n        $htmlEditor.attr(\"contenteditable\", this.previewMode ? \"false\" : \"true\")\n        \n        if (this.previewMode) {\n            // mozliwosc zaznaczania tekstu\n            $htmlEditor.removeClass(\"unselectable\").addClass(\"selectable\");\n            \n            this.makeCustomScroll(this.$editor.parent());\n            this.addButtonsOverlay();\n        }\n    }\n    \n    reopen(currentViewId: number, alwaysTriggerLoad: boolean = false) {\n        this.currentViewId = currentViewId;\n        if (this.isViewLoaded() || alwaysTriggerLoad) {\n            this.triggerEvent(\"load\");\n        }\n    }\n    \n    release(currentViewId: number) {\n        this.destroyScroll(this.$editor);\n        this.currentViewId = currentViewId;\n        this.editor = null;\n        this.$editor.html(\"\");\n        this.$mainContent.addClass(\"released\");\n        this.$toolbar.html(\"\");\n        this.$buttonsOverlay = null;\n    }\n    \n    onDownloadClick(): void {\n        this.triggerEvent(\"download\");\n    }\n    \n    onAttachToTaskClick(): void {\n        this.triggerEvent(\"attachToTask\");\n    }\n    onSendClick(): void {\n        this.triggerEvent(\"send\");\n    }\n    onPrintClick(): void {\n        this.triggerEvent(\"print\");\n    }\n    onSaveAsPdfClick(): void {\n        this.triggerEvent(\"saveAsPdf\");\n    }\n    \n    onOpenEditWindowClick(e: MouseEvent) {\n        if (!this.state.docked) {\n            this.editModeFromPreview = true;\n            this.state.editModeFromPreview = true;\n            this.removeButtonsOverlay();\n            \n            this.previewMode = false;\n            this.state.previewMode = false;\n            \n            this.state.editMode = true;\n            this.editor.editMode = true;\n            let $editorContents = this.$mainContent.find(\".editor\").detach();\n            this.$mainContent.empty().append(\"<div class='toolbar-container'></div>\");\n            this.$toolbar = this.$mainContent.find(\".toolbar-container\");\n            \n            this.toolbarTmpl = this.templateManager.createTemplate(toolbarTemplate);\n            this.$toolbar.empty().append(this.toolbarTmpl.renderToJQ(this.state));\n            this.renderName();\n            // this.bindToolbarActions();\n            this.$mainContent.append($editorContents);\n            \n            this.triggerEvent(\"enterFromPreviewToEditMode\");\n            \n            e.stopPropagation();\n            return false;\n        }\n    }\n    \n    onEditorPaste(): void {\n        this.triggerEvent(\"clipboardPaste\");\n    }\n    \n    onEditorCopy(data: app.common.clipboard.ClipboardData): void {\n        this.triggerEvent(\"clipboardCopy\", data);\n    }\n    \n    clipboardPaste(data: app.common.clipboard.ClipboardData): void {\n        this.editor.paste(data);\n    }\n    \n    bindEditorKeyPresses(): void {\n        $(document).on(\"keydown\", e => {\n            if ((e.ctrlKey || e.metaKey) && !e.altKey && e.keyCode == 83) {\n                this.triggerEvent(\"save\");\n                return false;\n            }\n            else if (e.keyCode === webUtils.KEY_CODES.downArrow) {\n                if (this.previewMode) {\n                    e.preventDefault();\n                    this.scrollPreview(false);\n                }\n            }\n            else if (e.keyCode === webUtils.KEY_CODES.upArrow) {\n                if (this.previewMode) {\n                    e.preventDefault();\n                    this.scrollPreview(true);\n                }\n            }\n            else if (e.keyCode == webUtils.KEY_CODES.openBracket && webUtils.WebUtils.hasCtrlModifier(<any>e)) {\n                this.setSmallerFontSize();\n            }\n            else if (e.keyCode == webUtils.KEY_CODES.closeBraket && webUtils.WebUtils.hasCtrlModifier(<any>e)) {\n                this.setLargerFontSize();\n            }\n        });\n    }\n    \n    setSmallerFontSize(): void {\n        this.setAdjacentFontSize(-1);\n    }\n    \n    setLargerFontSize(): void {\n        this.setAdjacentFontSize(1);\n    }\n    \n    setAdjacentFontSize(direction: -1|1): void {\n        if (!this.editor || !(this.editor instanceof StyledEditor)) {\n            return;\n        }\n        let availableSizes = this.getAvailableFontSizesArray();\n        let currSizeStr = this.editor.getFontSize();\n        let currSize = availableSizes.filter(x => x.cssSize == currSizeStr)[0];\n        if (!currSize) {\n            return;\n        }\n        let idx = availableSizes.indexOf(currSize);\n        let newIdx = idx + direction;\n        if (newIdx < 0 || newIdx > (availableSizes.length - 1)) {\n            return;\n        }\n        let newSize = availableSizes[newIdx];\n        // this.setEditorFontSize(newSize.cssSize);\n        this.editor.setStyle(undefined, newSize.cssSize, undefined);\n    }\n    \n    getAvailableFontSizesArray(): { cssSize: string, displayedSize: string }[] {\n        let arr: { cssSize: string, displayedSize: string }[] = [];\n        for (let cssSize in component.mindmap.Mindmap.AVAILABLE_FONT_SIZES) {\n            let displayedSize = component.mindmap.Mindmap.AVAILABLE_FONT_SIZES[cssSize];\n            arr.push({ cssSize, displayedSize });\n        }\n        return arr.sort((a, b) => parseFloat(a.cssSize) - parseFloat(b.cssSize));\n    }\n    \n    scrollPreview(up: boolean) {\n        const offset: number = 40;\n        let $conv = this.$editor.children(\".pf-content\").children(\".pf-content\");\n        let currPos = $conv.scrollTop();\n        $conv.scrollTop(up ? currPos - offset : currPos + offset);\n    }\n    \n    addButtonsOverlay() {\n        let $editorContent = this.$mainContent.find(\".editor\").detach();\n        // this.$toolbarContents = this.$main.find(\".toolbar-container\").detach();\n        this.editorButtons.$buttons.removeClass(\"hidden-buttons\");\n        this.$mainContent.append($editorContent);\n    }\n    \n    removeButtonsOverlay() {\n        this.editorButtons.$buttons.addClass(\"hidden-buttons\");\n    }\n\n    doInnerElementsFit(element: HTMLElement): boolean {\n        if (! element) {\n            return;\n        }\n        return element.clientHeight < 50;\n    }\n    \n    getElementWidth(element: HTMLElement): number {\n        let style = window.getComputedStyle(element);\n        let totalWidth = 0;\n        totalWidth += element.offsetWidth, // or use style.width\n        totalWidth += parseFloat(style.marginLeft) + parseFloat(style.marginRight),\n        totalWidth += parseFloat(style.paddingLeft) + parseFloat(style.paddingRight),\n        totalWidth += parseFloat(style.borderLeftWidth) + parseFloat(style.borderRightWidth);\n        return totalWidth;\n    }\n    \n    onOpenToolbarMoreClick(): void {\n        let $menu = this.$mainContent.find(\".context-menu-toolbar-more\");\n        let $menuContent = $menu.find(\".context-menu-content\");\n        let $btns = this.$toolbar.find(\"button[data-action]\");\n        let offset = $btns.first().offset().top + 10;\n        $menuContent.empty();\n        let empty = true;\n        let dropDownOpenerInvisible: boolean = false;\n        $btns.each((_idx, btn) => {\n            let $btn = $(btn);\n            let isDropDownOpener = $btn.is(\"[data-action=open-tools-menu]\");\n            let isInDropDown = $btn.parent().is(\".context-menu-content\");\n            if (isInDropDown || $btn.offset().top > offset || ($btn.hasClass(\"float-right\") && ($btn.parent().hasClass(\"invisible\") || $btn.parent().parent().hasClass(\"invisible\")))) {\n                if (isDropDownOpener) {\n                    dropDownOpenerInvisible = true;\n                    return;\n                }\n                if (isInDropDown && !dropDownOpenerInvisible) {\n                    return;\n                }\n                let $parent = $btn.parent();\n                if (!$parent.is(\".style-switcher\") && !$parent.is(\".font-size-switcher\")) {\n                    let $newBtn = $btn.clone(true);\n                    if (isInDropDown) {\n                        $parent = $parent.parent().parent();\n                    }\n                    $newBtn.toggleClass(\"read-mode-buttons\", $parent.hasClass(\"read-mode-buttons\"));\n                    $newBtn.toggleClass(\"edit-mode-buttons\", $parent.hasClass(\"edit-mode-buttons\"));\n                    $menuContent.append($newBtn);\n                    empty = false;\n                }\n            }\n            else if (isDropDownOpener || (!isDropDownOpener && !isInDropDown)) {\n                dropDownOpenerInvisible = false;\n            }\n        });\n        if (!empty) {\n            $menu.addClass(\"visible\");\n        }\n    }\n    \n    onCloseToolbarMoreClick(): void {\n        this.$mainContent.find(\".context-menu-toolbar-more\").removeClass(\"visible\");\n        this.$mainContent.find(\".context-menu-toolbar-tools\").removeClass(\"visible\");\n    }\n    \n    onToolbarMoreItemClick(e: MouseEvent): void {\n        let $btn = $(e.currentTarget);\n        if (!$btn.is(\":disabled\")) {\n            this.$mainContent.find(\".context-menu-toolbar-more\").removeClass(\"visible\");\n        }\n    }\n    \n    onToolbarToolsItemClick(e: MouseEvent): void {\n        let $btn = $(e.currentTarget);\n        if (!$btn.is(\":disabled\")) {\n            this.$mainContent.find(\".context-menu-toolbar-tools\").removeClass(\"visible\");\n        }\n    }\n    \n    onToolbarToolsClick(e: MouseEvent): void {\n        let $btn = $(e.currentTarget);\n        let offset = $btn.offset();\n        if (!$btn.is(\":disabled\")) {\n            let $el = $btn.parent().find(\".context-menu-toolbar-tools\");\n            $el.find(\"style\").remove();\n            let hw = $btn.outerWidth() / 2;\n            $el.append(\"<style type='text/css'>.context-menu-toolbar-tools .context-menu-content:before { right: auto; left: \" + hw + \"px; }</style>\");\n            $el.find(\".context-menu-content\").css({\n                right: \"auto\",\n                left: offset.left,\n            })\n            $el.addClass(\"visible\");\n        }\n    }\n    \n    onTaskClick(e: MouseEvent): void {\n        if ($.contains(this.taskChooser.$main[0], <any>e.target)) {\n            return;\n        }\n        let $ele = $(e.target);\n        let taskId = $ele.closest(\"[data-task-id]\").data(\"task-id\");\n        this.taskChooser.movePopup(e.pageX,  e.pageY, 300, 150);\n        this.triggerEvent(\"openTask\", taskId);\n    }\n    \n    prepareToPrint(scaling: boolean = false): void {\n        this.html2canvasScaleMultiplier = 1.0;\n        this.fileLoadedDeferred.promise.then(() => {\n            if (scaling) {\n                let $elem = this.$main.find(\".main-content\").first();\n                let $mindmap = $elem.find(\".mindmap-root .mindmap\");\n                if ($mindmap.length > 0) {\n                    let availWidth = $mindmap.parent().innerWidth();\n                    let mindmapWidth = $mindmap.find(\"svg\").outerWidth(true);\n                    let scale = mindmapWidth > availWidth ? (availWidth / mindmapWidth) : 1.0;\n                    this.html2canvasScaleMultiplier = 1.0 / scale;\n                    $mindmap.css({\n                        transform: \"scale(\" + scale + \")\",\n                        transformOrigin: \"left top\",\n                        marginTop: \"10px\",\n                    });\n                }\n            }\n            (<HTMLFrameElement>frameElement).style.height = document.body.clientHeight + \"px\";\n            this.triggerEvent(\"preparedToPrint\");\n        });\n    }\n    \n    saveAsPdf(): void {\n        this.fileLoadedDeferred.promise.then(() => {\n            let $elem = this.$main.find(\".main-content\").first();\n            let $mindmap = $elem.find(\".mindmap-root .mindmap\");\n            if ($mindmap.length > 0) {\n                $mindmap.find(\"path\").css({\n                    stroke: \"#ccc\",\n                    strokeWidth: \"1px\",\n                    fill: \"none\",\n                });\n                $mindmap.find(\".node.selected\").removeClass(\"selected\");\n                let h = $mindmap.height() + 10;\n                let $el = $mindmap.parent();\n                while ($el.length > 0) {\n                    $el.height(h);\n                    $el = $el.parent();\n                }\n                $elem.find(\".mindmap-root .mindmap\").replaceWith($mindmap);\n            }\n            $elem.width($elem.width());\n            $elem.height($elem.height() + 10);\n            html2pdf()\n            .from($elem[0])\n            .set({\n                margin: 16,\n                filename: this.entry.fileName.substr(0, this.entry.fileName.lastIndexOf(\".\")) + \".pdf\",\n                image: { type: \"jpeg\", quality: 0.98 },\n                html2canvas: { scale: 2 * this.html2canvasScaleMultiplier },\n                jsPDF: { unit: \"pt\", format: \"A4\", orientation: \"portrait\" }\n            })\n            .output().then((data: string) => {\n                this.triggerEvent(\"pdfOutput\", data);\n            });\n        });\n    }\n    \n    setBoundTasksStr(boundTasksStr: string): void {\n        if (this.state) {\n            this.state.boundTasksStr = boundTasksStr;\n            this.$toolbar.empty().append(this.toolbarTmpl.renderToJQ(this.state));\n            this.renderName();\n        }\n    }\n    \n    updateTaskStatuses(): Q.Promise<void> {\n        let text = this.editor.getState();\n        let matches = text.match(/\\B#[0-9]{3,}\\b/g);\n        if (!matches) {\n            return;\n        }\n        let taskIdsObj: { [taskId: string]: boolean } = {};\n        for (let taskHashId of matches) {\n            let taskId = taskHashId.substr(1);\n            taskIdsObj[taskId] = true;\n        }\n        let taskIds = Object.keys(taskIdsObj);\n        this.channelPromise<string>(\"getTaskStatuses\", JSON.stringify(taskIds)).then(taskStatusesStr => {\n            this.setTaskStatuses(taskStatusesStr);\n        });\n    }\n    \n    setTaskStatuses(taskStatusesStr: string): void {\n        let taskStatuses: { [taskId: string]: string } = JSON.parse(taskStatusesStr);\n        let changed: boolean = false;\n        for (let taskId in taskStatuses) {\n            if (this.taskStatuses[taskId] != taskStatuses[taskId]) {\n                changed = true;\n                this.taskStatuses[taskId] = taskStatuses[taskId];\n            }\n        }\n        for (let taskId in this.taskStatuses) {\n            if (this.taskStatuses[taskId] != taskStatuses[taskId]) {\n                changed = true;\n                delete this.taskStatuses[taskId];\n            }\n        }\n        if (changed && this.editor) {\n            this.editor.updateTaskBadges();\n        }\n    }\n    \n    updateRelatedSection() {\n        if (this.editor && this.state && this.state.entry) {\n            this.editor.relatedHostHash = this.state.entry.hostHash;\n            this.editor.relatedSectionId = this.state.entry.sectionId;\n        }\n    }\n    \n    updateFileName(newFileName: string, newFullFileName: string, newTitle: string): void {\n        if (this.state && this.state.entry && this.state.entry.fileName) {\n            this.state.entry.fileName = newFileName;\n        }\n        this.$toolbar.find(\".file-name\").text(newFileName);\n    }\n    \n    updatePaddingBottom(): void {\n        if (!this.state || this.state.editMode) {\n            return;\n        }\n        let buttonsHeight = this.editorButtons.getButtonsHeight();\n        this.$editor.find(\".editor-textarea\").css(\"padding-bottom\", buttonsHeight + 12);\n    }\n\n    onLockFileClick(e: MouseEvent): void {\n        this.triggerEvent(\"lockFile\");\n    }\n\n    onUnlockFileClick(e: MouseEvent): void {\n        this.triggerEvent(\"unlockFile\");\n    }\n\n    updateLockInfoOnActionButtons(locked: boolean, canUnlock: boolean): void {\n        let unlockAvail = locked && canUnlock;\n        this.$toolbar.find(\"[data-action=unlock]\").toggleClass(\"hide\", !unlockAvail);\n        this.$toolbar.find(\"[data-action=lock]\").toggleClass(\"hide\", locked);\n    }\n    \n}\n\n(<any>EditorWindowView.prototype).className = \"com.privmx.plugin.editor.window.editor.EditorWindowView\";"],"sourceRoot":"../../../src"}