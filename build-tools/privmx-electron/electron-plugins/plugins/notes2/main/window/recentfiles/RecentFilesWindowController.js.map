{"version":3,"sources":["window/recentfiles/RecentFilesWindowController.ts"],"names":[],"mappings":"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","file":"RecentFilesWindowController.js","sourcesContent":["import {utils, component, privfs, window, Q, Types, mail} from \"pmc-mail\";\nimport {Notes2Plugin} from \"../../main/Notes2Plugin\";\nimport {RecentOpenedFile, RecentService} from \"../../main/RecentService\";\nimport {Locations, LocationInfo, FilesMeta, FileInfo} from \"../../main/LocationService\";\nimport Inject = utils.decorators.Inject;\nimport Dependencies = utils.decorators.Dependencies;\nimport * as fs from \"fs\";\nimport { LocalFS } from \"../../main/LocalFS\";\nimport { i18n } from \"./i18n\";\n\nexport interface LocationModel {\n    id: string;\n    channelName?: string;\n    channelScope?: string;\n    hashmail?: string;\n    convModel?: Types.webUtils.ConversationModel;\n}\n\nexport interface EntryViewModel extends LocationModel {\n    fileName: string;\n    fileId: string;\n    icon: string;\n    modified: number;\n    systemLabel: string;\n    did: string;\n}\n\n@Dependencies([\"persons\", \"conversationlist\", \"conv2list\", \"extlist\", \"notification\"])\nexport class RecentFilesWindowController extends window.base.BaseWindowController {\n    \n    static textsPrefix: string = \"plugin.notes2.window.recentfiles.\";\n    \n    static registerTexts(localeService: mail.LocaleService): void {\n        localeService.registerTexts(i18n, this.textsPrefix);\n    }\n    \n    @Inject identity: privfs.identity.Identity;\n    \n    deferred: Q.Deferred<RecentOpenedFile>;\n    loadRecentFilesListDeferred: Q.Deferred<void>;\n    afterViewLoadedDeferred: Q.Deferred<void>;\n    notes2Plugin: Notes2Plugin;\n    allowClose: boolean = false;\n    \n    recentOpenedFiles: RecentOpenedFile[] = [];\n    locations: Locations;\n    filesMeta: FilesMeta;\n    recentFilesLocations: {id: string, locationInfo: LocationInfo}[] = [];\n    dataPreparedPromise: Q.Promise<void> = null;\n    metaCache: { [id: string]: FileInfo } = {};\n    \n    conversations: component.conversationlist.ConversationListController;\n    conv2list: component.conv2list.Conv2ListController;\n    personsComponent: component.persons.PersonsController;\n    activeCollection: utils.collection.WithActiveCollection<EntryViewModel>;\n    mutableCollection: utils.collection.MutableCollection<EntryViewModel>;\n    sortedCollection: utils.collection.SortedCollection<EntryViewModel>;\n    recentList: component.extlist.ExtListController<EntryViewModel>;\n    notifications: component.notification.NotificationController;\n    \n    constructor(parent: Types.app.WindowParent) {\n        super(parent, __filename, __dirname);\n        this.ipcMode = true;\n        this.notes2Plugin = this.app.getComponent(\"notes2-plugin\");\n        this.setPluginViewAssets(\"notes2\");\n        this.openWindowOptions = {\n            toolbar: false,\n            maximized: false,\n            show: false,\n            position: \"center\",\n            width: 560,\n            height: 360,\n            minWidth: 400,\n            minHeight: 230,\n            resizable: true,\n            modal: false,\n            title: this.i18n(\"plugin.notes2.window.recentfiles.title\"),\n        };\n        this.deferred = Q.defer();\n        this.afterViewLoadedDeferred = Q.defer();\n    }\n    \n    init(): Q.IWhenable<void> {\n        this.loadRecentFilesList();\n            \n        this.personsComponent = this.addComponent(\"personsComponent\", this.componentFactory.createComponent(\"persons\", [this]));\n        this.conversations = this.addComponent(\"conversations\", this.componentFactory.createComponent(\"conversationlist\", [this, \"\"]));\n        this.conv2list = this.addComponent(\"conv2list\", this.componentFactory.createComponent(\"conv2list\", [this, {}]));\n        this.mutableCollection = this.addComponent(\"mutableCollection\", new utils.collection.MutableCollection([]));\n        this.sortedCollection = this.addComponent(\"sortedCollection\", new utils.collection.SortedCollection(this.mutableCollection, (x, y) => y.modified - x.modified));\n        this.activeCollection = this.addComponent(\"activeCollection\", new utils.collection.WithActiveCollection(this.sortedCollection));\n        this.recentList = this.addComponent(\"recentList\", this.componentFactory.createComponent(\"extlist\", [this, this.activeCollection]));\n        this.notifications = this.addComponent(\"notifications\", this.componentFactory.createComponent(\"notification\", [this]));\n        this.recentList.ipcMode = true;\n    }\n    \n    onViewLoad(): void {\n        this.afterViewLoadedDeferred.resolve();\n    }\n    \n    checkDataPrepared(): Q.Promise<void> {\n        if (this.dataPreparedPromise) {\n            return this.dataPreparedPromise;\n        }\n        return this.dataPreparedPromise = Q().then(() => {\n            return Q.all([\n                this.app.mailClientApi.checkLoginCore(),\n                this.app.mailClientApi.loadUserPreferences()\n            ]);\n        })\n        .then(() => {\n            return this.notes2Plugin.locationService.getLocationsInfo();\n        })\n        .then(res => {\n            this.locations = res;\n        });\n    }\n    \n    loadRecentFilesList(): Q.Promise<void> {\n        let allIds: string[] = [];\n        let allDids: string[] = [];\n        let previousLoadRecentFilesListDeferred = this.loadRecentFilesListDeferred;\n        this.loadRecentFilesListDeferred = Q.defer();\n        let loadRecentFilesListDeferred = this.loadRecentFilesListDeferred;\n        Q().then(() => {\n            if (previousLoadRecentFilesListDeferred && previousLoadRecentFilesListDeferred.promise.isPending()) {\n                return previousLoadRecentFilesListDeferred.promise;\n            }\n        })\n        .then(() => {\n            return this.checkDataPrepared();\n        })\n        .then(() => {\n            this.callViewMethod(\"recentFilesListLoading\");\n            return this.notes2Plugin.recentService.getRecentOpenedFiles();\n        })\n        .then(res => {\n            this.recentOpenedFiles = res;\n            this.recentOpenedFiles.filter(x => !(x.id in this.metaCache) && !x.isLocal).forEach(item => {\n                allIds.push(item.id);\n                allDids.push(item.did);\n            });\n            return this.notes2Plugin.locationService.getFilesMetaByIds(allIds, allDids, this.locations);\n        })\n        .then(filesMeta => {\n            this.filesMeta = filesMeta;\n            \n            for (let id of allIds) {\n                if (!(id in this.filesMeta)) {\n                    this.metaCache[id] = null;\n                }\n            }\n            for (let id in this.filesMeta) {\n                this.metaCache[id] = this.filesMeta[id];\n            }\n            for (let id in this.metaCache) {\n                if (this.metaCache[id]) {\n                    this.filesMeta[id] = this.metaCache[id];\n                }\n            }\n            \n            let locationsToGet: Q.Promise<{id: string, locationInfo: LocationInfo}>[] = [];\n            this.recentOpenedFiles.forEach(file => {\n                if (file.isLocal && this.app.isElectronApp() && fs.existsSync(file.id) && LocalFS.isWritable(file.id)) {\n                    locationsToGet.push(Q().then(() => {\n                        let x = LocalFS.getEntry(file.id);\n                        filesMeta[file.id] = {\n                            icon: this.app.shellRegistry.resolveIcon(x.mime),\n                            meta: {\n                                modifiedDate: x.mtime.getTime(),\n                                size: x.size,\n                            },\n                        };\n                        return {\n                            id: file.id,\n                            locationInfo: { type: \"local\", locationName: \"\", section: null },\n                        };\n                    }));\n                    return;\n                }\n                if (!(file.id in filesMeta)) {\n                    return;\n                }\n                let nameFromMeta = filesMeta[file.id].name;\n                if (nameFromMeta && file.name != nameFromMeta) {\n                    file.name = nameFromMeta;\n                    let f = this.notes2Plugin.recentService.recentOpenFiles.filter(x => x.did == file.did)[0];\n                    if (f) {\n                        f.name = nameFromMeta;\n                    }\n                }\n                let getOneFileLocation = Q().then(() => this.notes2Plugin.locationService.getLocationByEntryId(file.id, this.locations)\n                .then(locationInfo => {\n                    return {id: file.id, locationInfo: locationInfo};\n                }));\n                locationsToGet.push(getOneFileLocation);\n            });\n            return Q.all(locationsToGet);\n        })\n        .then(results => {\n            // Uwaga: przy otwieraniu plików z lokalnego filesystemu dopisywały się one do recent files, ale bez locationInfo, co powodowało błąd.\n            // hack: pliki z lokalnego filesystemu są ignorowane (do ewentualnego przegadania)\n            this.recentFilesLocations = results.filter(x => x.locationInfo != undefined);\n            this.recentOpenedFiles = this.recentOpenedFiles.filter(x => {\n                let exists = false;\n                this.recentFilesLocations.forEach(location => {\n                    if (location.id == x.id) {\n                        exists = true;\n                        return;\n                    }\n                });\n                return exists;\n            });\n            let locations: {[id: string]: {location: LocationInfo, locationModel: LocationModel} & FileInfo} = {};\n            this.recentFilesLocations.forEach(fileInfo => {\n                locations[fileInfo.id] = {\n                    location: fileInfo.locationInfo,\n                    locationModel: this.getLocationModel(fileInfo.locationInfo),\n                    icon: this.filesMeta[fileInfo.id].icon,\n                    meta: this.filesMeta[fileInfo.id].meta\n                };\n            });\n            let list: EntryViewModel[] = [];\n            this.recentOpenedFiles.forEach(file => {\n                let location = locations[file.id];\n                let item = {\n                    id: location.locationModel.id,\n                    channelName: location.locationModel.channelName,\n                    channelScope: location.locationModel.channelScope,\n                    hashmail: location.locationModel.hashmail,\n                    convModel: location.locationModel.convModel,\n                    fileName: file.name,\n                    fileId: file.id,\n                    icon: location.icon,\n                    modified: location.meta.modifiedDate,\n                    systemLabel: this.app.isElectronApp() ? (<any>this.app).getSystemLabel() : \"\",\n                    did: file.did,\n                };\n                if (location.location && location.location.tree && location.location.tree.collection) {\n                    let found = location.location.tree.collection.find(x => x.ref.did == file.did);\n                    if (!found) {\n                        return;\n                    }\n                    item.fileName = found.name;\n                }\n                list.push(item);\n            });\n            this.mutableCollection.clear();\n            this.mutableCollection.addAll(list);\n            this.activeCollection.setActive(this.activeCollection.get(0));\n            return this.afterViewLoadedDeferred.promise;\n        })\n        .fin(() => {\n            loadRecentFilesListDeferred.resolve();\n            this.callViewMethod(\"recentFilesListLoaded\");\n        });\n        return loadRecentFilesListDeferred.promise;\n    }\n    \n    afterRecentFileRenamed(file: RecentOpenedFile): void {\n        let elem = this.mutableCollection.find(x => x.did == file.did);\n        if (elem) {\n            elem.fileId = file.id;\n            elem.fileName = file.name;\n            this.mutableCollection.triggerUpdateElement(elem);\n        }\n    }\n    \n    invalidateCache(fileId: string): void {\n        if (fileId in this.metaCache) {\n            delete this.metaCache[fileId];\n            this.loadRecentFilesList();\n        }\n    }\n    \n    createNewDeferred(): void {\n        this.deferred = Q.defer();\n    }\n    \n    getPromise(): Q.Promise<RecentOpenedFile> {\n        return this.deferred.promise;\n    }\n    \n    getLocationModel(location: LocationInfo): LocationModel {\n        let model: LocationModel = {\n            id: location.type,\n        }\n        if (location.type == \"conversation\") {\n            let active = this.conversations.conversationCollection.getBy(\"id\", location.locationName);\n            model.convModel = utils.Converter.convertConversation(active, null);\n        }\n        else if (location.type == \"channel\") {\n            if (location.section && location.section.isUserGroup()) {\n                let active = this.conv2list.conversationCollection.find(x => x.section == location.section);\n                model.id = \"conversation\";\n                model.convModel = utils.Converter.convertConv2(active, 0, null, 0, true, 0, false, false, false, null);\n            }\n            else {\n                model.channelName = location.locationName;\n                model.channelScope = location.scope;\n            }\n            if (location.section && location.section.isPrivate()) {\n                model.hashmail = this.identity.hashmail;\n            }\n        }\n        else if (location.type == \"local\") {\n        }\n        else {\n            model.hashmail = this.identity.hashmail;\n        }\n        return model;\n    }\n    \n    onViewSetActive(fileId: string, did: string) {\n        let active = this.activeCollection.find(x => x.fileId == fileId && x.did == did);\n        if (active != null) {\n            this.activeCollection.setActive(active);\n        }\n    }\n    \n    onViewOpenSelected(): void {\n        let active = this.activeCollection.getActive();\n        if (active == null) {\n            return;\n        }\n        let file = utils.Lang.find(this.recentOpenedFiles, x => x.id == active.fileId);\n        if (file == null) {\n            return;\n        }\n        this.deferred.resolve(file);\n        this.close();\n    }\n    \n    onViewSelectUp() {\n        if (this.activeCollection.active) {\n            let currentIndex = this.activeCollection.active.index;\n            if (currentIndex > 0) {\n                this.activeCollection.setActive(this.activeCollection.get(currentIndex - 1));\n            }\n        }\n        else {\n            this.activeCollection.setActive(this.activeCollection.get(0));\n        }\n    }\n    \n    onViewSelectDown() {\n        if (this.activeCollection.active) {\n            let currentIndex = this.activeCollection.active.index;\n            if (currentIndex < this.activeCollection.size() - 1) {\n                this.activeCollection.setActive(this.activeCollection.get(currentIndex + 1));\n            }\n        }\n        else {\n            this.activeCollection.setActive(this.activeCollection.get(0));\n        }\n    }\n    \n    onViewClearList() {\n        if (this.notes2Plugin.recentService && this.notes2Plugin.recentService.recentOpenFiles && this.notes2Plugin.recentService.recentOpenFiles.length == 0) {\n            return;\n        }\n        let notificationId = this.notifications.showNotification(this.i18n(\"plugin.notes2.window.recentfiles.notifier.clearingList\"), {autoHide: false, progress: true});\n        Q().then(() => {\n            return this.loadRecentFilesListDeferred ? this.loadRecentFilesListDeferred.promise : null;\n        })\n        .then(() => {\n            return this.notes2Plugin.recentService.clearRecentFiles();\n        })\n        .then(() => {\n            return this.loadRecentFilesList();\n        })\n        .fin(() => {\n            this.notifications.hideNotification(notificationId);\n        });\n    }\n    \n    onViewRefresh(): void {\n        this.dataPreparedPromise = null;\n        let t0 = new Date().getTime();\n        Q().then(() => {\n            this.callViewMethod(\"setRefreshing\", true);\n            return this.loadRecentFilesList();\n        })\n        .then(() => {\n            let t1 = new Date().getTime();\n            let dt = t1 - t0;\n            let timeLeft = 500 - dt;\n            if (timeLeft > 0) {\n                let def = Q.defer();\n                setTimeout(() => {\n                    def.resolve();\n                }, timeLeft);\n                return def.promise;\n            }\n        })\n        .fin(() => {\n            this.callViewMethod(\"setRefreshing\", false);\n        })\n    }\n    \n    onViewClose(): void {\n        this.close();\n    }\n    \n    onNwinClose(): void {\n        this.close();\n    }\n    \n    \n    hide() {\n        this.nwin.hide();\n    }\n    \n}\n\n(<any>RecentFilesWindowController.prototype).className = \"com.privmx.plugin.notes2.window.recentfiles.RecentFilesWindowController\";"],"sourceRoot":"../../../src"}