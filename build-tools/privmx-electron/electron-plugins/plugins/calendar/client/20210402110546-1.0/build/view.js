!function e(t,n,i){function a(o,r){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!r&&l)return l(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[o]={exports:{}};t[o][0].call(d.exports,(function(e){return a(t[o][1][e]||e)}),d,d.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(e,t,n){(function(e){!function(e,i){"object"==typeof n&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):e.ResizeObserver=i()}(this,(function(){"use strict";var t=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,i){return e[0]===t&&(n=i,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),i=this.__entries__[n];return i&&i[1]},t.prototype.set=function(t,n){var i=e(this.__entries__,t);~i?this.__entries__[i][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,i=e(n,t);~i&&n.splice(i,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,i=this.__entries__;n<i.length;n++){var a=i[n];e.call(t,a[1],a[0])}},t}()}(),n="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,i=void 0!==e&&e.Math===Math?e:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(i):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var s=["top","right","bottom","left","width","height","size","weight"],o="undefined"!=typeof MutationObserver,r=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,i=!1,s=0;function o(){n&&(n=!1,e()),i&&l()}function r(){a(o)}function l(){var e=Date.now();if(n){if(e-s<2)return;i=!0}else n=!0,i=!1,setTimeout(r,t);s=e}return l}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){n&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),o?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){n&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;s.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),l=function(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var a=i[n];Object.defineProperty(e,a,{value:t[a],enumerable:!1,writable:!1,configurable:!0})}return e},c=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||i},d=v(0,0,0,0);function h(e){return parseFloat(e)||0}function p(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+h(e["border-"+n+"-width"])}),0)}function u(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return d;var i=c(e).getComputedStyle(e),a=function(e){for(var t={},n=0,i=["top","right","bottom","left"];n<i.length;n++){var a=i[n],s=e["padding-"+a];t[a]=h(s)}return t}(i),s=a.left+a.right,o=a.top+a.bottom,r=h(i.width),l=h(i.height);if("border-box"===i.boxSizing&&(Math.round(r+s)!==t&&(r-=p(i,"left","right")+s),Math.round(l+o)!==n&&(l-=p(i,"top","bottom")+o)),!function(e){return e===c(e).document.documentElement}(e)){var u=Math.round(r+s)-t,m=Math.round(l+o)-n;1!==Math.abs(u)&&(r-=u),1!==Math.abs(m)&&(l-=m)}return v(a.left,a.top,r,l)}var m="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof c(e).SVGGraphicsElement}:function(e){return e instanceof c(e).SVGElement&&"function"==typeof e.getBBox};function f(e){return n?m(e)?function(e){var t=e.getBBox();return v(0,0,t.width,t.height)}(e):u(e):d}function v(e,t,n,i){return{x:e,y:t,width:n,height:i}}var g=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=v(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=f(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),y=function(e,t){var n,i,a,s,o,r,c,d=(i=(n=t).x,a=n.y,s=n.width,o=n.height,r="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,c=Object.create(r.prototype),l(c,{x:i,y:a,width:s,height:o,top:a,right:i+s,bottom:o+a,left:i}),c);l(this,{target:e,contentRect:d})},w=function(){function e(e,n,i){if(this.activeObservations_=[],this.observations_=new t,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=n,this.callbackCtx_=i}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new g(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new y(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),k="undefined"!=typeof WeakMap?new WeakMap:new t,b=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=r.getInstance(),i=new w(t,n,this);k.set(this,i)};return["observe","unobserve","disconnect"].forEach((function(e){b.prototype[e]=function(){var t;return(t=k.get(this))[e].apply(t,arguments)}})),void 0!==i.ResizeObserver?i.ResizeObserver:b}))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("pmc-web"),a=e("../window/main/MainWindowView"),s=e("../window/calendar/CalendarWindowView"),o=e("../component/datePicker/DatePickerView"),r=e("../component/dateTimePicker/DateTimePickerView"),l=e("../component/calendarPanel/CalendarPanelView");i.Starter.objectFactory.register(a.MainWindowView),i.Starter.objectFactory.register(s.CalendarWindowView),i.Starter.addEventListener("instanceregistered",(function(e){if(e.instance&&"com.privmx.core.window.sectionsummary.SectionSummaryWindowView"==e.instance.className){var t=new l.CalendarPanelView(e.instance,e.instance.personsComponent);t.$container=i.JQuery('<div class="calendar-component"></div>'),e.instance.registerModule("calendar",t)}}),"calendar","ethernal"),i.Starter.addEventListener("request-date-picker-view",(function(e){var t=new o.DatePickerView(e.parent);e.parent.registerDatePickerView(e.name,t)}),"calendar","ethernal"),i.Starter.addEventListener("request-date-time-picker-view",(function(e){var t=new r.DateTimePickerView(e.parent);e.parent.registerDateTimePickerView(e.name,t)}),"calendar","ethernal")},{"../component/calendarPanel/CalendarPanelView":3,"../component/datePicker/DatePickerView":17,"../component/dateTimePicker/DateTimePickerView":19,"../window/calendar/CalendarWindowView":23,"../window/main/MainWindowView":25,"pmc-web":27}],3:[function(e,t,n){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=e("pmc-web"),o=e("./template/main.html"),r=e("../../main/Types"),l=e("../datePicker/DatePickerView"),c=e("./renderers/MonthRenderer"),d=e("./renderers/WeekRenderer"),h=e("../../main/DateUtils"),p=e("./renderers/SingleWeekRenderer"),u=e("./renderers/SingleDayRenderer"),m=e("./template/icon.html"),f=e("./template/actions-menu.html"),v=function(e){function t(t,n){var i=e.call(this,t)||this;return i.personsComponent=n,i.isActive=!1,i.isVisible=!0,i.fragmentsContainers={},i.renderers={},i.selectedDay=null,i.selectedTask=null,i.mouseX=0,i.mouseY=0,i.tasks={},i._overrideMode=null,i.emptyTgIconTemplates=null,i.order=50,i.searchStr=null,i.personTooltip=new s.component.persontooltip.PersonTooltipView(i.templateManager,i.personsComponent),i.notifications=i.addComponent("notifications",new s.component.notification.NotificationView(i,{xs:!0})),i.taskTooltip=i.addComponent("tasktooltip",new s.component.tasktooltip.TaskTooltipView(i)),i.taskTooltip.refreshAvatars=function(){i.personsComponent.refreshAvatars()},i.fileTooltip=i.addComponent("filetooltip",new s.component.filetooltip.FileTooltipView(i)),i.fileTooltip.refreshAvatars=function(){i.personsComponent.refreshAvatars()},i.datePicker=i.addComponent("datePicker",new l.DatePickerView(i)),i.customSelectMode=i.addComponent("customSelectMode",new s.component.customselect.CustomSelectView(i,{})),i.customSelectFilter=i.addComponent("customSelectFilter",new s.component.customselect.CustomSelectView(i,{})),i.customSelectExtraCalendars=i.addComponent("customSelectExtraCalendars",new s.component.customselect.CustomSelectView(i,{})),s.Starter.dispatchEvent({type:"request-fast-list-creator",parent:i,name:"fastListCreator"}),s.Starter.dispatchEvent({type:"request-icon-picker-data",parent:i,name:"iconPickerData"}),i}return a(t,e),t.prototype.init=function(e){var t=this,n=this.templateManager.createTemplate(m.func);this.emptyTgIconTemplates={};for(var i=0,a=this.iconPickerData.items;i<a.length;i++){var o=a[i];if(o){var r=JSON.parse(o);this.emptyTgIconTemplates[this.getIconId(r)]=n.renderToJQ(o)[0]}}var l=JSON.parse(e);return this.setModel(l),this.$container.on("click",".btn.settings",this.onSettingsButtonClick.bind(this)),this.$container.on("click",".btn.refresh",this.onRefreshButtonClick.bind(this)),this.$container.on("click",".context-menu-backdrop2",this.onSettingsMenuBackdropClick.bind(this)),this.$container.on("change","input[data-setting]",this.onSettingChanged.bind(this)),this.$container.on("click","button[data-setting]",this.onSettingChanged.bind(this)),this.$container.on("click","li.option-chooser-option:not(.active)",this.onOptionChooserOptionClick.bind(this)),this.$container.on("click",'[data-action="task-new"]',this.onNewTaskClick.bind(this)),s.JQuery(document.body).on("click",".actions-menu [data-action-id]",this.onActionsMenuClick.bind(this)),this.$container.on("click","[data-task-id]",this.onTaskClick.bind(this)),this.$container.on("dblclick","[data-task-id]",this.onDoubleTaskClick.bind(this)),this.$container.on("click","[data-day]",this.onDayClick.bind(this)),this.$container.on("dblclick","[data-day]",this.onDayDoubleClick.bind(this)),this.$container.on("mouseover","[data-task-id]",this.onTaskMouseOver.bind(this)),this.$container.on("mouseout","[data-task-id]",this.onTaskMouseOut.bind(this)),this.$container.on("dragstart","[data-task-id]",this.onTaskDragStart.bind(this)),this.$container.on("dragend","[data-task-id]",this.onTaskDragEnd.bind(this)),this.$container.on("dragover","[data-day]",this.onDragOverDay.bind(this)),this.$container.on("drop","[data-day]",this.onDropOnDay.bind(this)),this.$container.on("click",".today-btn",this.onGoToTodayClick.bind(this)),this.$container.on("click","[data-action=zoom-in]",this.onZoomInClick.bind(this)),this.$container.on("click","[data-action=zoom-out]",this.onZoomOutClick.bind(this)),this.$container.on("mousemove",(function(e){t.mouseX=e.pageX,t.mouseY=e.pageY})),this.customSelectMode.onChange((function(e){t.settingChanged("mode",e)})),this.customSelectFilter.onChange((function(e){e&&t.settingChanged("filter",e)})),this.customSelectExtraCalendars.onChange((function(e){t.model&&t.model.canChooseExtraCalendars&&(t.triggerEvent("setExtraCalendars",e),t.model.extraCalendars=e.split(",").filter((function(e){return!!e})))})),this.personTooltip.init(this.$container),this.notifications.$container=this.$container.find(".notifications-container-wrapper"),this.datePicker.$container=this.$container.find(".datepicker-container"),this.taskTooltip.$container=this.$container,this.fileTooltip.$container=this.$container,this.datePicker.overridePrevNextAbsDelta=this.getPrevNextAbsDelta.bind(this),s.Q.all([this.notifications.triggerInit()]).then((function(){return t.personsComponent.refreshAvatars(),t.customSelectExtraCalendars.updateMainSelectedItem=t.updateMainSelectedItem.bind(t),s.Q.all([t.taskTooltip.triggerInit(),t.fileTooltip.triggerInit(),t.customSelectMode.triggerInit(),t.customSelectFilter.triggerInit(),t.datePicker.triggerInit(),t.customSelectExtraCalendars.triggerInit()])}))},t.prototype.getIconId=function(e){return e.type+"--"+("fa"==e.type?e.fa:e.shape)},t.prototype.registerFastListCreator=function(e,t){"fastListCreator"==e&&(this.fastListCreator=t)},t.prototype.registerIconPickerData=function(e,t){"iconPickerData"==e&&(this.iconPickerData=t)},t.prototype.setModel=function(e){var t=this;if(this.model=e,e){var n=new Date;this.selectDay(n.getDate()+"."+n.getMonth()+"."+n.getFullYear()),s.Q().then((function(){for(var n in e.tasks)t.parent.fontMetrics.add(e.tasks[n].title);for(var i in e.files)t.parent.fontMetrics.add(e.files[i].fileName);t.parent.fontMetrics.add("0123456789:↳"),t.parent.fontMetrics.measure()})),this.searchStr=e.searchStr}this.render()},t.prototype.setData=function(e){this.setModel(JSON.parse(e))},t.prototype.render=function(){var e=this,t=this.$container.find(".notifications-container-wrapper"),n=this.$container.find(".datepicker-container"),i=this.$container.find(".tooltip-component");if(this.$container.empty(),this.model){var a=this.templateManager.createTemplate(s.component.template.conversation);if(this.$container.append(this.templateManager.createTemplate(o.func).renderToJQ(this.model,a)),this.fragmentsContainers[r.Modes.MONTH]=this.$container.find(".mode.mode-month")[0],this.fragmentsContainers[r.Modes.WEEK]=this.$container.find(".mode.mode-week")[0],this.fragmentsContainers[r.Modes.SINGLE_WEEK]=this.$container.find(".mode.mode-singleweek")[0],this.fragmentsContainers[r.Modes.SINGLE_DAY]=this.$container.find(".mode.mode-singleday")[0],t.length>0&&this.$container.find(".notifications-container-wrapper").replaceWith(t),n.length>0&&this.$container.find(".datepicker-container").replaceWith(n),i.length>0&&this.$container.append(i),this.personsComponent.refreshAvatars(),this.$settingsMenu=this.$container.find(".context-menu-settings"),this.$top=this.$container.find(".top"),window.ResizeObserver)new window.ResizeObserver(this.onTopResize.bind(this)).observe(this.$top[0]);if(window.ResizeObserver)new window.ResizeObserver((function(){e.updateSettingsMenuRight(),e.updateActionsMenuPosition()})).observe(this.$container[0]);this.$topLeft=this.$top.children(".left"),this.$topDatePickerContainer=this.$top.children(".datepicker-container"),this.$topButtonContainer=this.$top.children(".button-container"),this.$topNewTask=this.$top.find("[data-action='task-new']"),this.$topFilterContainer=this.$top.find(".filter-container"),this.$topModeContainer=this.$top.find(".mode-container"),this.$topExtraCalendarsContainer=this.$top.find(".extra-calendars-container");var l=this.$container.closest(".calendars");this.$dragDropHintText=l.find(".dragdrop-hint-text"),this.$dragDropHintRects=l.find(".dragdrop-hint-rects"),0==this.$dragDropHintText.length&&(this.$dragDropHintText=s.JQuery("<div class='dragdrop-hint-text'></div>"),l.append(this.$dragDropHintText)),0==this.$dragDropHintRects.length&&(this.$dragDropHintRects=s.JQuery("<div class='dragdrop-hint-rects'></div>"),l.append(this.$dragDropHintRects)),this.$calendars=l,this.customSelectMode.setContainer(this.$container.find(".mode-container")),this.customSelectFilter.setContainer(this.$container.find(".filter-container")),this.customSelectExtraCalendars.setContainer(this.$container.find(".extra-calendars-container")),this.customSelectExtraCalendars.$container.find(".component-custom-select-main").addClass("with-wide-dropdown"),this.$goToChat=this.$container.find(".go-to-chat"),this.$goToNotes=this.$container.find(".go-to-notes"),this.$goToTasks=this.$container.find(".go-to-tasks"),this.$goToChat.toggleClass("hidden",!this.model.otherPluginsAvailability.chat),this.$goToNotes.toggleClass("hidden",!this.model.otherPluginsAvailability.notes),this.$goToTasks.toggleClass("hidden",!this.model.otherPluginsAvailability.tasks),this.updateClasses(),this.updateSettingsMenu()}else this.$container.append('<div class="notifications-container-wrapper"></div>'),this.$container.append('<div class="datepicker-container"></div>')},t.prototype.settingChanged=function(e,t,n){if(void 0===n&&(n=!0),this.model&&this.model.projectId){if(this.triggerEvent("settingChanged",e,t,n),this.model&&this.model.settings){this.model.settings[e]=t;var i=this.getRenderer().getRendererName();0==e.indexOf("renderer-settings-")&&e!="renderer-settings-"+i&&"show-files"!=e||(this.updateClasses(),this.repaint())}this.updateSettingsMenu()}},t.prototype.getSetting=function(e){return this.model.settings[e]},t.prototype.setSetting=function(e,t){this.model.settings[e]=t},t.prototype.updateSettingsMenu=function(){var e=this.model.uniqueSafeId;for(var t in this.model.settings)this.$container.find("input#calendar-settings-"+t+"-"+e+"-"+this.model.calendarId).prop("checked",this.getSetting(t));for(var n=!0,i=this.$container.find(".panel.calendar-panel-component").children(".context-menu-settings").find(".context-menu-content").children("li"),a=0;a<i.length;++a){var s=i.eq(a);s.is(".subitem")?(s.toggleClass("disabled",!n),s.find("input").prop("disabled",!n)):n=s.find("input").is(":checked")}var o=this.getSetting("sort-files-by"),r=this.$container.find('.settings-item--sort-files-by ul.option-chooser[data-setting="sort-files-by"]').find("li.option-chooser-option[data-option]"),l=r.filter(".active");l.attr("data-option")!=o&&(l.removeClass("active"),r.filter('[data-option="'+o+'"]').addClass("active"))},t.prototype.updateSettingsMenuRight=function(){var e=parseInt(this.$settingsMenu.parent().children(".top").css("right"));this.$settingsMenu.children(".context-menu-content").css("right",Math.round(this.$topNewTask.outerWidth(!0))-30+e)},t.prototype.updateCustomSelectMode=function(e){var t=this.customSelectMode.items.find((function(e){return"item"==e.type&&e.selected})),n=this.customSelectMode.items.find((function(t){return"item"==t.type&&t.value==e}));t.selected=!1,n.selected=!0,this.customSelectMode.updateItems()},t.prototype.updateCustomSelectFilter=function(e){var t=this.customSelectFilter.items.find((function(e){return"item"==e.type&&e.selected})),n=this.customSelectFilter.items.find((function(t){return"item"==t.type&&t.value==e}));t.selected=!1,n.selected=!0,this.customSelectFilter.updateItems()},t.prototype.setSelectedDate=function(e,t,n,i){void 0===i&&(i=!0),this.model.selectedDay=e,this.model.selectedMonth=t,this.model.selectedYear=n,i?this.getRenderer().goToDate(e,t,n):this.triggerEvent("setSelectedDate",e,t,n)},t.prototype.updateClasses=function(){var e=this.getMode();this.$container.toggleClass("with-mode-month",e==r.Modes.MONTH),this.$container.toggleClass("with-mode-week",e==r.Modes.WEEK),this.$container.toggleClass("with-mode-singleweek",e==r.Modes.SINGLE_WEEK),this.$container.toggleClass("with-mode-singleday",e==r.Modes.SINGLE_DAY),this.$container.toggleClass("no-creating-new-tasks",!this.model.canCreateNewTasks),this.$container.toggleClass("can-choose-extra-calendars",!!this.model.canChooseExtraCalendars),this.$container.toggleClass("cant-choose-extra-calendars",!this.model.canChooseExtraCalendars)},t.prototype.setIsVisible=function(e,t){this.isVisible!=e&&(this.isVisible=e)},t.prototype.onSettingsButtonClick=function(e){this.updateSettingsMenuRight(),this.$settingsMenu.addClass("visible")},t.prototype.onRefreshButtonClick=function(){this.triggerEvent("refresh")},t.prototype.onSettingsMenuBackdropClick=function(){this.$settingsMenu.removeClass("visible")},t.prototype.onSettingChanged=function(e){var t=s.JQuery(e.currentTarget).data("setting"),n=!this.model.settings[t];this.settingChanged(t,n)},t.prototype.onOptionChooserOptionClick=function(e){var t=s.JQuery(e.currentTarget),n=s.JQuery(e.currentTarget).parent().data("setting"),i=t.data("option");this.settingChanged(n,i)},t.prototype.onNewTaskClick=function(){this.dropdown=new s.component.dropdown.Dropdown({model:{items:[{id:"new-timeframe",labelKey:"plugin.calendar.component.calendarPanel.new-timeframe",icon:"fa fa-clock-o"},{id:"new-whole-day",labelKey:"plugin.calendar.component.calendarPanel.new-whole-day",icon:"fa fa-calendar"}]},template:this.templateManager.createTemplate(f.func),$container:s.JQuery(document.body),templateManager:this.templateManager}),this.$container.closest(".window-sectionsummary").length>0&&s.JQuery(document.body).addClass("for-window-sectionsummary"),this.updateActionsMenuPosition()},t.prototype.updateActionsMenuPosition=function(){if(this.dropdown){var e=s.JQuery(document.body).find(".component-dropdown"),t=this.$container.find(".btn[data-action='task-new']")[0].getBoundingClientRect();e.css({position:"fixed",left:t.left+t.width/2-90-60+"px",top:t.top+t.height+"px",zIndex:9999,margin:"8px 0 0 0"}),e.addClass("to-right"),e.find(".inner").css("height","auto"),e.find(".pf-content").css("position","static")}},t.prototype.onActionsMenuClick=function(e){if(this.isActive&&this.model&&1==this.model.calendarId){e.stopPropagation();var t=s.JQuery(e.target).closest("[data-action-id]").data("action-id");this.dropdown&&(this.dropdown.destroy(),this.dropdown=null);var n=null;if(this.selectedDay&&this.$container.closest(".two-calendars").length>0){var i=this.selectedDay.split(".").map((function(e){return parseInt(e)})),a=i[0],o=i[1],r=i[2],l=new Date;n=new Date(r,o,a,l.getHours(),l.getMinutes(),l.getSeconds(),l.getMilliseconds()).getTime()}this.triggerEvent("newTask",n,t)}},t.prototype.onTaskClick=function(e){e.stopImmediatePropagation();var t=e.currentTarget.getAttribute("data-task-id");if(t)this.getSetting("show-task-preview-panel")?this.selectTask(e.ctrlKey?null:t):this.triggerEvent("openTask",t);else{var n=e.currentTarget.getAttribute("data-file-id");this.triggerEvent("openFile",n)}},t.prototype.onDoubleTaskClick=function(e){var t=e.currentTarget.getAttribute("data-task-id");if(t)this.triggerEvent("openTask",t);else{var n=e.currentTarget.getAttribute("data-file-id");this.triggerEvent("openFile",n)}},t.prototype.onDayClick=function(e){var n=this,i=e.currentTarget.getAttribute("data-day");if(t.USE_CUSTOM_DOUBLE_CLICK)if(this.lastClickTid&&this.lastClickId==i){clearTimeout(this.lastClickTid),this.lastClickTid=null,this.lastClickId=null;var a=i.split(".").map((function(e){return parseInt(e)})),s=a[0],o=a[1],r=a[2],l=this.getTimeFromCalendarClickEvent(e);this.triggerEvent("newTask",new Date(r,o,s,l.h,l.m,l.s,l.ms).getTime())}else this.lastClickId=i,this.lastClickTid=setTimeout((function(){n.lastClickTid=null,n.lastClickId=null,n.selectDay(i)}),t.DOUBLE_CLICK_TIME);else this.selectDay(i)},t.prototype.onDayDoubleClick=function(e){if(!t.USE_CUSTOM_DOUBLE_CLICK){var n=s.JQuery(e.target);if(!n.is(".tasks")&&!n.is(".entry-tasks")&&(n.closest(".tasks").length>0||n.closest(".entry-tasks").length>0))return;var i=e.currentTarget.getAttribute("data-day").split(".").map((function(e){return parseInt(e)})),a=i[0],o=i[1],r=i[2],l=this.getTimeFromCalendarClickEvent(e);this.triggerEvent("newTask",new Date(r,o,a,l.h,l.m,l.s,l.ms).getTime())}},t.prototype.getTimeFromCalendarClickEvent=function(e){var t=s.JQuery(e.target);if(t.is(".virtual-scroll-zoom-element")){var n=e.offsetY/t.height()*86400,i=900*Math.max(0,Math.min(95,Math.round(n/900))),a=Math.floor(i/3600),o=Math.floor((i-3600*a)/60);return{h:a,m:o,s:Math.floor((i-3600*a-60*o)/60),ms:0}}var r=new Date;return{h:r.getHours(),m:r.getMinutes(),s:r.getSeconds(),ms:r.getMilliseconds()}},t.prototype.onTaskMouseOver=function(e){var t=e.currentTarget.getAttribute("data-task-id");this.$container.find(".hover").removeClass("hover"),this.$container.find("[data-task-id='"+t+"']").addClass("hover")},t.prototype.onTaskMouseOut=function(e){this.$container.find(".hover").removeClass("hover")},t.prototype.onGoToTodayClick=function(){var e=new Date;this.setSelectedDate(e.getDate(),e.getMonth(),e.getFullYear()),this.triggerEvent("goToToday")},t.prototype.onZoomInClick=function(){this.getRenderer().zoomIn()},t.prototype.onZoomOutClick=function(){this.getRenderer().zoomOut()},t.prototype.onTopResize=function(e){var t=e[0].contentRect.width,n=this.$topDatePickerContainer.data("cached-width")?this.$topDatePickerContainer.data("cached-width"):this.$topDatePickerContainer.outerWidth();this.$topDatePickerContainer.data("cached-width",n);var i=Math.max(this.$top.data("orig-width")||0,this.$topLeft.outerWidth()+n+this.$topButtonContainer.outerWidth());this.$top.data("orig-width",i),this.$top.toggleClass("multiline",i>=t),this.$calendars.toggleClass("multiline-header",i>=t),i>=t&&(i-=n);var a=i>=t;this.$topFilterContainer.toggleClass("narrow",a),this.$topModeContainer.toggleClass("narrow",a),this.$topNewTask.toggleClass("narrow",a&&i-t>=120),this.$topLeft.children().eq(0).toggleClass("narrow",a&&i-t>=120),this.updateSettingsMenuRight()},t.prototype.activate=function(){var e=this;this.isActive=!0,s.Q().then((function(){e.repaint()}))},t.prototype.deactivate=function(){this.isActive=!1},t.prototype.getRenderer=function(){var e=this.getModeStr();return e in this.renderers||(e==r.Modes.MONTH?(this.renderers[e]=new c.MonthRenderer(this,this.fastListCreator),this.renderers[e].init()):e==r.Modes.WEEK?(this.renderers[e]=new d.WeekRenderer(this,this.fastListCreator),this.renderers[e].init()):e==r.Modes.SINGLE_WEEK?(this.renderers[e]=new p.SingleWeekRenderer(this),this.renderers[e].init()):e==r.Modes.SINGLE_DAY&&(this.renderers[e]=new u.SingleDayRenderer(this),this.renderers[e].init())),this.renderers[e]},t.prototype.repaint=function(){this.getRenderer().repaint()},t.prototype.taskInRange=function(e,t,n,i){return n<t&&i>e},t.prototype.getFragmentsContainerRect=function(){var e,t=this.getMode(),n=this.fragmentsContainers[t];return n?t==r.Modes.MONTH?{x:(e=n.getBoundingClientRect()).left,y:e.top,w:e.width-c.MonthRenderer.LEFT_HEADERS_WIDTH,h:e.height-23}:t==r.Modes.WEEK||t==r.Modes.SINGLE_WEEK||t==r.Modes.SINGLE_DAY?{x:(e=n.getBoundingClientRect()).left,y:e.top,w:e.width,h:e.height}:{x:0,y:0,w:0,h:0}:{x:0,y:0,w:0,h:0}},t.prototype.overrideMode=function(e){this._overrideMode=e,this.model&&(this.updateClasses(),this.repaint())},t.prototype.getMode=function(){var e=this.getSetting("mode");return this._overrideMode&&(e=this._overrideMode),e},t.prototype.getModeStr=function(){return this.getMode()},t.prototype.setTasks=function(e,t){t&&(this.model.tasks={});var n=JSON.parse(e);for(var i in n){var a=n[i];this.model.tasks[a.id]=a,this.parent.fontMetrics.add(a.title),this.parent.fontMetrics.measure()}this.repaint()},t.prototype.setTask=function(e){var t=JSON.parse(e);this.model.tasks[t.id]=t,this.parent.fontMetrics.add(t.title),this.parent.fontMetrics.measure(),this.repaint()},t.prototype.delTask=function(e){delete this.model.tasks[e],this.repaint()},t.prototype.updateSelection=function(){this.$container.find(".selected-day").removeClass("selected-day"),this.$container.find(".selected-task").removeClass("selected-task"),this.selectedDay&&this.$container.find(".day[data-day='"+this.selectedDay+"']").addClass("selected-day"),this.selectedTask&&this.$container.find(".task[data-task-id='"+this.selectedTask+"']").addClass("selected-task")},t.prototype.selectDay=function(e){var n=this.getMode(),i=n==r.Modes.MONTH||(n==r.Modes.WEEK||n==r.Modes.SINGLE_WEEK)&&t.ENABLE_PREVIEW_IN_WEEK_MODE;e&&!i&&(e=null),this.selectedDay=e,this.updateSelection(),i&&(this.triggerEvent("requestDayPreview",this.selectedDay),this.getSetting("enable-day-preview-panel")||this.selectTask(null))},t.prototype.selectTask=function(e){this.selectedTask!=e&&(this.selectedTask=e,this.updateSelection(),this.triggerEvent("requestTaskPreview",this.selectedTask))},t.prototype.markTaskAsSelected=function(e){this.selectedTask!=e&&(this.selectedTask=e,this.updateSelection())},t.prototype.applySearchFilter=function(e){this.searchStr=e,this.isActive&&this.repaint()},t.prototype.onTaskDragStart=function(e){e.stopPropagation(),e.originalEvent.dataTransfer.setData("text/plain","123");var t=e.currentTarget.getAttribute("data-task-id");window._dragTaskId=t,this.taskTooltip.hide(),this.$calendars.addClass("dragdrop-on")},t.prototype.onTaskDragEnd=function(e){e.preventDefault(),e.stopPropagation(),this.$calendars.removeClass("dragdrop-on")},t.prototype.onDragOverDay=function(e){e.preventDefault(),e.stopPropagation(),this.handleDragOverAndDrop(e,!1)},t.prototype.onDropOnDay=function(e){e.preventDefault(),e.stopPropagation(),this.handleDragOverAndDrop(e,!0)},t.prototype.handleDragOverAndDrop=function(e,t){var n=s.JQuery(e.currentTarget),i=n.offset(),a=(e.pageX,i.left,e.pageY-i.top),o=n.hasClass("entry")?r.Modes.WEEK:r.Modes.MONTH,l=!!this.getSetting("precise-dragdrop")||o==r.Modes.WEEK;this.$calendars.toggleClass("dragdrop-with-hints",l);var d=n[0].getBoundingClientRect(),p=(d.width,d.height);o==r.Modes.MONTH?(1,p-=1):(p-=c.MonthRenderer.TOP_HEADERS_HEIGHT,a-=c.MonthRenderer.TOP_HEADERS_HEIGHT);var u=window._dragTaskId,m=this.model.tasks[u],f=m.wholeDays;this.$container.find(".dragdrop-current-target").removeClass("dragdrop-current-target"),t||o!=r.Modes.MONTH||s.JQuery(e.currentTarget).addClass("dragdrop-current-target");var v=e.currentTarget.getAttribute("data-day").split(".").map((function(e){return parseInt(e)})),g=v[0],y=v[1],w=v[2],k=0,b=864e5;if(o==r.Modes.WEEK){var D=this.getRenderer(),T=D.vsz.calcScaleFactor();k=D.vsz.totalVirtualHeight?Math.round(D.vsz.virtualScrollTop/D.vsz.totalVirtualHeight*24):0,b=T?Math.round(24/T):24,k*=36e5,b*=36e5}var C=f?0:k+a/p*b;if(l){var M=9e5;C=Math.round(C/M)*M,C=Math.min(855e5,Math.max(0,C))}else{var S=new Date(m.startTimestamp);C=h.DateUtils.getDayMsecs(S)}var _=m.endTimestamp-m.startTimestamp,P=new Date(w,y,g,0,0,0,C),E=new Date(w,y,g,0,0,0,C+(f?864e5:_));if(t)this.triggerEvent("setTaskStartTimestamp",u,P.getTime());else if(l){var I="";if(f){var x=this.formatDate(P);I=x.substr(0,x.length-6)}else I=this.formatDate(P)+" - "+this.formatDate(E);this.$dragDropHintText.text(I),this.$dragDropHintText.css({transform:"translate("+e.pageX+"px, "+e.pageY+"px)"})}},t.prototype.pad0s=function(e){return e<10?"0"+e:e.toString()},t.prototype.formatDate=function(e){return this.pad0s(e.getDate())+"."+this.pad0s(e.getMonth()+1)+"."+e.getFullYear()+" "+this.pad0s(e.getHours())+":"+this.pad0s(e.getMinutes())},t.prototype.getPrevNextAbsDelta=function(){return"week"==this.getRenderer().getRendererName()?null:this.getRenderer().getPrevNextAbsDelta()},t.prototype.updatePersonPresence=function(e,t){this.$container.find("[data-person-hashmail='"+e+"']").toggleClass("present",t)},t.prototype.updateMainSelectedItem=function(){var e=this.customSelectExtraCalendars,t=e.$selectedItemsContainer,n=e.items.filter((function(e){return"item"==e.type&&e.selected})).length,i=t.children("li.counter-item");0==i.length&&(t.append('<li class="item counter-item"><span class="plus">+</span><span class="count"></span><i class="privmx-icon privmx-icon-calendar"></i></li>'),i=t.children("li.counter-item")),i.find(".count").text(n).toggleClass("zero",0==n)},t.prototype.setFileModels=function(e,t){t&&(this.model.files={});var n=JSON.parse(e);for(var i in n){var a=n[i];this.model.files[i]=a,this.parent.fontMetrics.add(a.path),this.parent.fontMetrics.measure()}this.repaint()},t.prototype.setFileModel=function(e){var t=JSON.parse(e);this.model.files[t.identifier]=t,this.parent.fontMetrics.add(t.path),this.parent.fontMetrics.measure(),this.repaint()},t.prototype.delFileModel=function(e){delete this.model.files[e],this.repaint()},t.USE_CUSTOM_DOUBLE_CLICK=!1,t.DOUBLE_CLICK_TIME=400,t.ENABLE_PREVIEW_IN_WEEK_MODE=!1,t}(s.component.base.ComponentView);n.CalendarPanelView=v,v.prototype.className="com.privmx.plugin.calendar.component.calendarPanel.CalendarPanelView"},{"../../main/DateUtils":21,"../../main/Types":22,"../datePicker/DatePickerView":17,"./renderers/MonthRenderer":6,"./renderers/SingleDayRenderer":8,"./renderers/SingleWeekRenderer":9,"./renderers/WeekRenderer":11,"./template/actions-menu.html":12,"./template/icon.html":15,"./template/main.html":16,"pmc-web":27}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e){void 0===e&&(e=0),this.deltaH=e,this.totalVirtualHeight=24,this.virtualHeight=12,this.virtualScrollTop=8,this.minVirtualHeight=2,this.height=1e3,this.elements=[],this.$container=null,this.afterZoomChanged=null}return e.prototype.init=function(){var e=this.elements[0].$viewport;window.ResizeObserver&&new window.ResizeObserver(this.onElementResize.bind(this)).observe(e[0]);this.$container.on("mousewheel",this.onMouseWheel.bind(this)),this.repaint()},e.prototype.onElementResize=function(){this.height=this.elements[0].$viewport.height()+this.deltaH,this.repaint()},e.prototype.onMouseWheel=function(t){if(0!=t.deltaY){if(!t.ctrlKey||t.shiftKey||t.altKey){if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){t.preventDefault(),t.stopPropagation();n=(t.deltaY>0?-1:1)*this.pxToVirtual(e.SCROLL_PX);this.virtualScrollTop=Math.max(0,Math.min(this.calcMaxVirtualScrollTop(),this.virtualScrollTop+n))}}else{t.preventDefault(),t.stopPropagation();var n=(t.deltaY>0?1:-1)*e.ZOOM_VIRTUAL_COUNT,i=this.virtualHeight;this.virtualHeight=Math.max(this.minVirtualHeight,Math.min(this.totalVirtualHeight,this.virtualHeight+n));var a=(this.virtualHeight-i)/2;this.virtualScrollTop=Math.max(0,Math.min(this.calcMaxVirtualScrollTop(),this.virtualScrollTop-a)),this.afterZoomChanged&&this.afterZoomChanged()}this.repaint()}},e.prototype.repaint=function(){for(var e=this.calcScrollTop(),t=this.calcTotalHeight(),n=0,i=this.elements;n<i.length;n++){var a=i[n];a.$element.css({marginTop:-e,height:t}),a.$element.addClass("virtual-scroll-zoom-element")}},e.prototype.virtualToPx=function(e){return e*this.height/this.virtualHeight},e.prototype.pxToVirtual=function(e){return e/this.height*this.virtualHeight},e.prototype.calcScaleFactor=function(){return this.totalVirtualHeight/this.virtualHeight},e.prototype.calcTotalHeight=function(){return this.height*this.calcScaleFactor()},e.prototype.calcScrollTop=function(){return this.height/this.virtualHeight*this.virtualScrollTop},e.prototype.calcMaxVirtualScrollTop=function(){return Math.max(0,this.totalVirtualHeight-this.virtualHeight)},e.SCROLL_PX=50,e.ZOOM_VIRTUAL_COUNT=2,e}();n.VirtualScrollZoom=i,i.prototype.className="com.privmx.plugin.calendar.component.calendarPanel.VirtualScrollZoom"},{}],5:[function(e,t,n){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s,o=e("./Renderer");!function(e){e[e.DEFAULT=1]="DEFAULT",e[e.FIXED=2]="FIXED"}(s=n.ZoomMode||(n.ZoomMode={}));var r=function(e){function t(t,n){var i=e.call(this,t)||this;return i.fastListCreator=n,i.zoomMode=s.DEFAULT,i.fixedZoom=1,i.zoom=1,i.emptyEntryTemplate=null,i}return a(t,e),t.prototype.getEllipsisLength=function(){return t.ELLIPSIS_LENGTH<0&&(this.view.parent.fontMetrics.add("."),this.view.parent.fontMetrics.measure(),t.ELLIPSIS_LENGTH=this.view.parent.fontMetrics.getTextWidth("...")),t.ELLIPSIS_LENGTH},t.prototype.repaint=function(e){void 0===e&&(e=!1);try{this.view.updateClasses(),this.updateFastListEntries(),this.renderFastList(e)}catch(e){console.error("REPAINT ERROR",e)}},t.prototype.afterFastListResize=function(){this.repaint(!0)},t.prototype.createFastListEmptyElement=function(){return this.emptyEntryTemplate.cloneNode(!0)},t.prototype.centerFastList=function(){this.fastList.center()},t.prototype.updateZoom=function(){this.saveSettings()},t.prototype.applySettings=function(e){void 0===e&&(e=!0);var t=JSON.parse(this.view.getSetting("renderer-settings-"+this.getRendererName()));t||(t={zoom:1}),this.zoomMode==s.FIXED?this.zoom=this.fixedZoom:this.zoom=t.zoom,e&&this.repaint()},t.prototype.saveSettings=function(){var e={zoom:this.zoom};this.view.settingChanged("renderer-settings-"+this.getRendererName(),JSON.stringify(e))},t.ELLIPSIS_LENGTH=-1,t}(o.Renderer);n.FastListRenderer=r,r.prototype.className="com.privmx.plugin.calendar.component.calendarPanel.renderers.FastListRenderer"},{"./Renderer":7}],6:[function(e,t,n){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=e("pmc-web"),o=e("../../../main/DateUtils"),r=e("./FastListRenderer"),l=e("../template/entry-month.html"),c=e("../../../main/Types"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.$container=null,t.weekHeight=100,t.taskHeight=16,t.cachedWeekData=null,t.cachedDaysByName=null,t.centerAfterRenderArgs=null,t.expandedDay=null,t.$expandedDay=null,t}return a(t,e),t.prototype.init=function(){var e=this;if(!this.firstVisibleDate){var n=o.DateUtils.weekStartDate(new Date);this.firstValidDate=new Date(n.getFullYear()-t.VISIBLE_RANGE_DELTA_Y,0,1),this.lastValidDate=new Date(n.getFullYear()+t.VISIBLE_RANGE_DELTA_Y,0,0),this.firstVisibleDate=o.DateUtils.getWeekStart(this.firstValidDate),this.lastVisibleDate=o.DateUtils.getWeekEnd(this.lastValidDate)}this.emptyEntryTemplate=this.view.templateManager.createTemplate(l.func).renderToJQ()[0];var i=this.view.$container.find(".mode.mode-month");this.$container=i;var a=i.find(".fl-container")[0];s.JQuery(a).pfScroll(),a=a.childNodes[0];var r=i.find(".fl-padding-container")[0],c=i.find(".fl-entries-container")[0];return s.JQuery(c).on("mousewheel",this.onMouseWheel.bind(this)),s.JQuery(c).on("click",".more-tasks-info",this.onMoreClick.bind(this)),i.on("click",".expanded-day-backdrop",this.onExpandedDayBackdropClick.bind(this)),this.fastList=this.fastListCreator.create(a,r,c),this.fastList.setEmptyElementCreator(this.createFastListEmptyElement.bind(this)),this.fastList.setElementFiller(this.fillFastListElement.bind(this)),this.fastList.setAfterRender(this.afterFastListRender.bind(this)),this.fastList.setAfterContainerResize(this.afterFastListResize.bind(this)),this.applySettings(!1),s.Q().then((function(){var t=new Date;e.updateFastListEntries(),e.goToDate(t.getDate(),t.getMonth(),t.getFullYear()),e.fastList.init()}))},t.prototype.getRendererName=function(){return"month"},t.prototype.renderFastList=function(e){void 0===e&&(e=!1);var n=(this.fastList.container.getBoundingClientRect().width-t.LEFT_HEADERS_WIDTH)/7,i=this.weekHeight*this.zoom,a=Math.min(i,n/2),s=.8*a;a>30&&(s=.8*(30+.4*(a-30))),this.fastList.render(e),this.fastList.container.style.fontSize=s+"px"},t.prototype.afterFastListRender=function(e,t){if(t){var n=this.getActiveDate();n&&this.view.setSelectedDate(n.getDate(),n.getMonth(),n.getFullYear(),!1)}else this.goToDate(this.view.model.selectedDay,this.view.model.selectedMonth,this.view.model.selectedYear);this.view.updateSelection(),this.centerAfterRenderArgs&&this.fastList.center(this.centerAfterRenderArgs.entryId,this.centerAfterRenderArgs.delta)&&(this.centerAfterRenderArgs=null)},t.prototype.onMouseWheel=function(e){if(e.ctrlKey){e.preventDefault(),e.stopPropagation();var t=s.JQuery(this.fastList.container).offset().top,n=e.pageY-t,i=this.fastList.container.scrollTop+n,a=e.deltaY;a<0?this.zoomIn(i,n):a>0&&this.zoomOut(i,n)}},t.prototype.zoomInOut=function(e,n,i){void 0===n&&(n=null),void 0===i&&(i=null),null===i&&(i=s.JQuery(this.fastList.container).height()/2),null===n&&(n=this.fastList.container.scrollTop+i);e?this.zoom*t.ZOOM_FACTOR<=4&&(this.zoom*=t.ZOOM_FACTOR,n*=t.ZOOM_FACTOR):this.zoom/t.ZOOM_FACTOR>=.25&&(this.zoom/=t.ZOOM_FACTOR,n/=t.ZOOM_FACTOR);var a=n-i;this.fastList.container.scrollTo(0,Math.round(a)),this.updateZoom()},t.prototype.goToDate=function(e,t,n){var i=-1,a=new Date(n,t,e);for(var s in this.fastList.entries){if((o=this.fastList.entries[s]).data.start<=a&&o.data.end>a){i=parseInt(s);break}}if(i>=0){s=-1;for(var o,r=0,l=0,c=(o=this.fastList.entries[i]).data.weeks;l<c.length;l++){var d=c[l],h=d.date,p=new Date(d.date.getTime()+6048e5);if(a>=h&&a<p){s=r;break}++r}var u=s>=0?(s+.5)*this.weekHeight*this.zoom-o.height/2:0;this.fastList.center(i,u)||(this.centerAfterRenderArgs={entryId:i,delta:u})}},t.prototype.getActiveDate=function(){for(var e=this.fastList.prevContainerInfo?this.fastList.prevContainerInfo[1]:this.fastList.container.clientHeight,t=(this.fastList.prevContainerInfo?this.fastList.prevContainerInfo[0]:this.fastList.container.scrollTop)+e/2,n=this.weekHeight*this.zoom,i=0,a=this.fastList.entries;i<a.length;i++){var s=a[i];if(s.startsAt<t&&s.startsAt+s.height>=t)for(var o=s.startsAt,r=0;r<s.data.weeks.length;++r){if(o<t&&o+n>=t){var l=s.data.weeks[r].date;return l<this.firstValidDate?l=new Date(this.firstValidDate.getTime()):l>this.lastValidDate&&(l=new Date(this.lastValidDate.getTime())),l}o+=n}}return null},t.prototype.getPrevNextAbsDelta=function(){return 1},t.prototype.updateFastListEntries=function(){var e=[],n=[],i=this.firstVisibleDate.getFullYear(),a=this.firstVisibleDate.getMonth(),s=this.firstVisibleDate.getDate(),r=Math.round((this.lastVisibleDate.getTime()-this.firstVisibleDate.getTime())/6048e5),l=new Date,d={};if(this.cachedWeekData){var h=l.getTime();for(var p in n=this.cachedWeekData,d=this.cachedDaysByName){(y=d[p]).tasks=[],y.isToday=h>=y.startTimestamp&&h<y.startTimestamp+864e5,y.usedDayIndexes.fill(!1)}}else{for(var u=0;u<r;++u){for(var m=new Date(i,a,s+7*u),f=[],v=0;v<7;++v){var g=new Date(i,a,s+7*u+v),y={date:g,tasks:[],dayNumber:g.getDate(),isToday:o.DateUtils.isToday(g,l),isMonthEven:g.getMonth()%2==0,usedDayIndexes:Array(40).fill(!1),startTimestamp:g.getTime(),dayId:g.getDate()+"."+g.getMonth()+"."+g.getFullYear()};f.push(y),d[q=g.getDate()+"."+g.getMonth()+"."+g.getFullYear()]=y}n.push({date:m,days:f})}this.cachedWeekData=n,this.cachedDaysByName=d}var w=-this.getEllipsisLength()-t.HORIZONTAL_TASK_PADDING,k=this.view.getFragmentsContainerRect(),b=function(e){return(e<10?"0":"")+e};for(var D in this.view.model.tasks){var T=this.view.model.tasks[D];if(this.taskMatchesSearchString(D,T.title)&&this.taskMatchesFilter(D)){var C=T.startTimestamp,M=T.endTimestamp,S=new Date(T.startTimestamp),_=T.wholeDays,P=T.title.trim()+(_?"":" ("+b(S.getHours())+":"+b(S.getMinutes())+")"),E=P,I=T.endTimestamp-T.startTimestamp;if(_){var x=new Date(T.endTimestamp),$=new Date(S.getFullYear(),S.getMonth(),S.getDate());I=new Date(x.getFullYear(),x.getMonth(),x.getDate()+1)-$,C=$.getTime(),S=$}var O=Math.ceil((I+1e3*(60*(60*S.getHours()+S.getMinutes())+S.getSeconds()))/864e5),L=-999999;for(u=0;u<O;++u){if((q=(se=new Date(C+864e5*u)).getDate()+"."+se.getMonth()+"."+se.getFullYear())in d){var A=this.expandedDay==q,H=new Date(se.getFullYear(),se.getMonth(),se.getDate()),R=o.DateUtils.weekNumber(H),N=H.getTime(),F=new Date(se.getFullYear(),se.getMonth(),se.getDate()+1).getTime(),V="",z=0,W=0;if(L!=R||A){L=R,z=(F-N)/6048e5*k.w;var Y=(H.getDay()+6)%7;W=L!=R&&A?1:Math.min(O-u,7-Y);var B=0;0==u&&T.taskGroupIcons.length>0&&(B=13*T.taskGroupIcons.length);var j=A?P:E,J=this.view.parent.fontMetrics.getMaxTextLength(j,z*W+w-B,!0);if(V=j.substr(0,J)+(J==j.length?"":"..."),(E=E.substr(J)).length>0)E="..."+E.trim();else if(0==Y&&u>0){var K="↳"+T.title.trim(),U=this.view.parent.fontMetrics.getMaxTextLength(K,z*W+w-B,!0);V=K.substr(0,U)+(U==K.length?"":"...")}}var Q=R==o.DateUtils.weekNumber(new Date(T.endTimestamp)),G={model:T,fileModel:null,text:V,leftContinues:C<N,rightContinues:M>F&&!Q,dayIndex:null,width:z*W,marginLeft:null,taskGroupIcons:0==u?T.taskGroupIcons:[]};A&&G.leftContinues&&(G.width+=9,G.rightContinues&&(G.width+=9),G.marginLeft=-9),d[q].tasks.push(G)}}}}if(this.view.model.settings["show-files"])for(var Z in this.view.model.files){var q,X=this.view.model.files[Z];if(this.fileMatchesSearchString(X.fileName))if(this.fileMatchesFilter(Z))if(y=d[q=(se=new Date(X.createdAt)).getDate()+"."+se.getMonth()+"."+se.getFullYear()]){z=k.w/7,B=18,E=X.fileName,J=this.view.parent.fontMetrics.getMaxTextLength(E,z+w-B,!1),V=E.substr(0,J)+(J==E.length?"":"...");y.tasks.push({model:null,fileModel:X,text:V,leftContinues:!1,rightContinues:!1,dayIndex:null,width:k.w/7,marginLeft:null,taskGroupIcons:[]})}}var ee=this.view.getSetting("sort-files-by")==c.SortFilesBy.CREATED;for(var te in d)d[te].tasks.sort((function(e,t){if(e.fileModel&&!t.fileModel||!e.fileModel&&t.fileModel)return e.fileModel?1:-1;var n=e.model?e.model.startTimestamp:ee?e.fileModel.createdAt:e.fileModel.modifiedAt,i=t.model?t.model.startTimestamp:ee?t.fileModel.createdAt:t.fileModel.modifiedAt;return ee?n-i:i-n}));for(u=0;u<n.length;++u)for(R=n[u],v=0;v<R.days.length;++v)for(y=R.days[v],p=0;p<y.tasks.length;++p){if(null===(T=y.tasks[p]).dayIndex&&(T.dayIndex=y.usedDayIndexes.indexOf(!1),T.dayIndex>=0&&T.dayIndex<40&&(y.usedDayIndexes[T.dayIndex]=!0)),v+1<R.days.length)for(var ne=0,ie=R.days[v+1].tasks;ne<ie.length;ne++){var ae=ie[ne];if(ae.model&&T.model&&ae.model.id==T.model.id){ae.dayIndex=T.dayIndex,T.dayIndex>=0&&T.dayIndex<40&&(R.days[v+1].usedDayIndexes[T.dayIndex]=!0);break}}}for(var te in d)d[te].tasks.sort((function(e,t){return e.dayIndex-t.dayIndex}));for(u=0;u<n.length;++u){var se=n[u].date,oe=(M=new Date(se.getFullYear(),se.getMonth(),se.getDate()+7),this.view.parent.i18n("plugin.calendar.component.calendarPanel.month."+se.getMonth())+" "+se.getFullYear());(e.length<1||e[e.length-1].data.monthStr!=oe)&&e.push({data:{weeks:[],monthStr:oe,start:se,end:M},height:0,startsAt:0});var re=e[e.length-1];re.data.weeks.push(n[u]),re.height+=this.weekHeight*this.zoom,re.data.end=M}this.fastList.setEntries(e)},t.prototype.fillFastListElement=function(e,t){var n=Math.floor(this.weekHeight*this.zoom/this.taskHeight)-1;e.style.height=t.height+"px",e.children[0].textContent=t.data.monthStr,e.children[0].classList.toggle("even",t.data.weeks[0].days[0].isMonthEven);for(var i=this.view.model.taskStatuses,a=0;a<t.data.weeks.length;++a){var o=t.data.weeks[a];for(var r in e.children[1].children[a].classList.remove("hidden"),e.children[1].children[a].style.height=this.weekHeight*this.zoom+"px",o.days){var l=o.days[r],c=e.children[1].children[a].children[r],d=this.expandedDay==l.dayId;c.setAttribute("data-day",l.dayId),c.children[0].textContent=l.dayNumber.toString(),c.children[1].innerHTML="",c.classList.toggle("today",l.isToday),c.classList.toggle("even",l.isMonthEven),c.classList.toggle("expanded-day",d);var h=l.tasks.length,p=-1,u=0,m=n;d&&(m=99999);for(var f=0;f<h;++f){var v=l.tasks[f];if(null!==v.dayIndex){if(v.dayIndex>=m)break;if(++u,p=Math.max(p,v.dayIndex),v){(S=document.createElement("div")).setAttribute("draggable",v.model?"true":"false"),v.model?S.className="task has-task-tooltip":S.className="task has-file-tooltip",c.children[1].appendChild(S);var g=null===v.text||""===v.text&&0==v.width;if(S.classList.add("visible"),S.textContent=v.text,v.taskGroupIcons&&v.taskGroupIcons.length>0)for(var y=0,w=v.taskGroupIcons;y<w.length;y++){var k=w[y];(b=this.view.emptyTgIconTemplates[this.view.getIconId(k)].cloneNode(!0)).style.color=k.color,s.JQuery(S).prepend(b)}else if(v.fileModel&&v.fileModel.icon){var b;(b=document.createElement("span")).className="file-icon "+v.fileModel.icon,s.JQuery(S).prepend(b)}if(S.classList.toggle("placeholder",g),!g){S.style.width=v.width+"px",null!==v.marginLeft&&(S.style.marginLeft=v.marginLeft+"px",S.style.paddingLeft=4-v.marginLeft+"px"),S.setAttribute("data-task-id",v.model?v.model.id:""),S.setAttribute("data-file-id",v.fileModel?v.fileModel.identifier:"");for(var D=0,T=i;D<T.length;D++){var C=T[D];S.classList.remove("task-status-"+C)}S.classList.toggle("is-task",!!v.model),S.classList.toggle("is-file",!!v.fileModel),v.model&&S.classList.add("task-status-"+v.model.status),S.classList.toggle("left-continues",v.leftContinues),S.classList.toggle("right-continues",v.rightContinues)}}}}var M=p;for(f=0;f<1e3;++f){var S;if(!(S=c.children[1].children[f]))break;S.classList.toggle("visible",f<=p),l.tasks[f]&&(M=Math.max(M,l.tasks[f].dayIndex))}var _=h>(u=Math.min(u,p+1)),P=u*this.taskHeight;c.children[2].style.top=P+2+"px";var E=h-u,I="plugin.calendar.component.calendarPanel.more-tasks-info."+(1==E?"one":"many");c.children[2].textContent=_?this.view.parent.i18n(I,E):"",_&&(c.children[2].innerHTML+='<i class="fa fa-caret-down"></i>')}}for(a=t.data.weeks.length;a<6;++a)e.children[1].children[a].classList.add("hidden")},t.prototype.onMoreClick=function(e){var t=s.JQuery(e.currentTarget).closest("[data-day]"),n=t.data("day");n&&(this.expandedDay=n,this.$expandedDay=t,this.repaint(),this.$expandedDay.addClass("expanded-day"),this.$container.addClass("with-expanded-day"),this.view.onDayClick(e))},t.prototype.onExpandedDayBackdropClick=function(){this.expandedDay&&(this.$container.removeClass("with-expanded-day"),this.$expandedDay.removeClass("expanded-day"),this.expandedDay=null,this.$expandedDay=null,this.repaint())},t.VISIBLE_RANGE_DELTA_Y=10,t.HORIZONTAL_TASK_PADDING=8,t.LEFT_HEADERS_WIDTH=30,t.TOP_HEADERS_HEIGHT=23,t.ZOOM_FACTOR=1.1,t}(r.FastListRenderer);n.MonthRenderer=d,d.prototype.className="com.privmx.plugin.calendar.component.calendarPanel.renderers.MonthRenderer"},{"../../../main/DateUtils":21,"../../../main/Types":22,"../template/entry-month.html":13,"./FastListRenderer":5,"pmc-web":27}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../../main/Types"),a=function(){function e(){}return e.prepareString=function(e){return e.toLocaleLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/ł/g,"l")},e.prepareHaystack=function(e){return this.prepareString(e)},e.prepareNeedle=function(e){return this.prepareString(e)},e.matches=function(e,t){return this.prepareString(t).indexOf(e)>=0},e}();n.SearchFilter=a;var s=function(){function e(e){this.view=e}return e.prototype.zoomIn=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.zoomInOut(!0,e,t)},e.prototype.zoomOut=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.zoomInOut(!1,e,t)},e.prototype.taskMatchesSearchString=function(e,t){t=a.prepareHaystack(t).replace(/<(?:.|\n)*?>/gm,"");var n=this.view.searchStr;return n.length>0&&"#"==n[0]?0==e.indexOf(n.substr(1)):t.indexOf(n)>=0},e.prototype.taskMatchesFilter=function(e){var t=this.view.model.tasks[e],n=this.view.model.settings.filter;return n==i.Filter.allTasks||(n==i.Filter.onlyIdea?t.status==i.TaskStatus.IDEA:n==i.Filter.onlyTodo?t.status==i.TaskStatus.TODO:n==i.Filter.onlyInProgress?t.status==i.TaskStatus.INPROGRESS:n==i.Filter.onlyDone?t.status==i.TaskStatus.DONE:n!=i.Filter.onlyNotDone||t.status!=i.TaskStatus.DONE)},e.prototype.fileMatchesSearchString=function(e){e=a.prepareHaystack(e).replace(/<(?:.|\n)*?>/gm,"");var t=this.view.searchStr;return e.indexOf(t)>=0},e.prototype.fileMatchesFilter=function(e){return!0},e}();n.Renderer=s,a.prototype.className="com.privmx.plugin.calendar.component.calendarPanel.renderers.SearchFilter",s.prototype.className="com.privmx.plugin.calendar.component.calendarPanel.renderers.Renderer"},{"../../../main/Types":22}],8:[function(e,t,n){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.getRendererName=function(){return"singleday"},t.prototype.getVisibleDays=function(){for(var e=[],t=0;t<1;++t){var n=new Date(this.selectedDate.getFullYear(),this.selectedDate.getMonth(),this.selectedDate.getDate()+t);e.push(n)}return e},t.prototype.getPrevNextAbsDelta=function(){return 1},t}(e("./StaticDaysRenderer").StaticDaysRenderer);n.SingleDayRenderer=s,s.prototype.className="com.privmx.plugin.calendar.component.calendarPanel.renderers.SingleDayRenderer"},{"./StaticDaysRenderer":10}],9:[function(e,t,n){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.getRendererName=function(){return"singleweek"},t.prototype.getVisibleDays=function(){for(var e=(this.selectedDate.getDay()+6)%7,t=[],n=0;n<7;++n){var i=new Date(this.selectedDate.getFullYear(),this.selectedDate.getMonth(),this.selectedDate.getDate()+n-e);t.push(i)}return t},t.prototype.getPrevNextAbsDelta=function(){return 7},t}(e("./StaticDaysRenderer").StaticDaysRenderer);n.SingleWeekRenderer=s,s.prototype.className="com.privmx.plugin.calendar.component.calendarPanel.renderers.SingleWeekRenderer"},{"./StaticDaysRenderer":10}],10:[function(e,t,n){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=e("pmc-web"),o=e("./Renderer"),r=e("../../../main/DateUtils"),l=e("./WeekRenderer"),c=e("../VirtualScrollZoom"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.$container=null,t.$fixedTasksContainer=null,t.$secondContainer=null,t.$entriesContainer=null,t.selectedDate=null,t.vsz=null,t}return a(t,e),t.prototype.init=function(){var e=this;(this.selectedDate||(this.selectedDate=new Date),this.$container=this.view.$container.find(".mode.mode-"+this.getRendererName()),this.$fixedTasksContainer=this.$container.find(".fixed-tasks-container"),this.$secondContainer=this.$container.find(".second-container"),this.$entriesContainer=this.$container.find(".entries-container"),this.$fixedTasksContainer.find(".entry-tasks").pfScroll(),window.ResizeObserver)&&new window.ResizeObserver(this.onContainerResize.bind(this)).observe(this.$secondContainer[0]);var t=new c.VirtualScrollZoom;t.afterZoomChanged=function(){s.Q().then((function(){e.updateTasksLineClamp()}))},t.$container=this.$container,this.$secondContainer.find(".entry-tasks").each((function(e,n){t.elements.push({$element:s.JQuery(n),$viewport:s.JQuery(n).closest(".entry.day")})}));var n=this.$container.find(".hours-container-inner");t.elements.push({$element:n,$viewport:n.closest(".hours-container")}),t.init(),this.vsz=t,this.$container.on("mousewheel",this.onMouseWheel.bind(this))},t.prototype.onMouseWheel=function(e){if(e.shiftKey){var t=0;e.deltaY<0?t=this.getPrevNextAbsDelta():e.deltaY>0&&(t=-this.getPrevNextAbsDelta()),0!=t&&this.goToDate(this.selectedDate.getDate()+t,this.selectedDate.getMonth(),this.selectedDate.getFullYear(),!0)}},t.prototype.zoomInOut=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null)},t.prototype.goToDate=function(e,t,n,i){void 0===i&&(i=!1),this.selectedDate=new Date(n,t,e),this.view.setSelectedDate(this.selectedDate.getDate(),this.selectedDate.getMonth(),this.selectedDate.getFullYear(),!1),this.repaint(),i&&this.view.triggerEvent("updateLeftCalendarFromDayPreview",e,t,n)},t.prototype.repaint=function(){if(this.view.isVisible){var e=this.getEntries();this.fillEntries(e),this.updateFixedTasksContainerHeight(),this.updateTasksLineClamp(),this.view.updateSelection()}},t.prototype.getEntries=function(){for(var e=this.$entriesContainer[0].getBoundingClientRect(),n=new Date,i=function(e){return(e<10?"0":"")+e},a=[],s=0;s<7;++s)a.push(this.view.parent.i18n("plugin.calendar.component.calendarPanel.daysOfWeek.short."+s));this.adjustHoursSeparators(e.height);for(var o=[],l=0,c=this.getVisibleDays();l<c.length;l++){var d=c[l],h=new Date(d.getFullYear(),d.getMonth(),d.getDate()),p=new Date(d.getFullYear(),d.getMonth(),d.getDate()+1),u=h.getTime(),m=[];for(var f in this.view.model.tasks){var v=this.view.model.tasks[f];if(!(v.endTimestamp<=u||v.startTimestamp>=u+864e5)&&(this.taskMatchesSearchString(f,v.title)&&this.taskMatchesFilter(f))){var g=Math.max(v.startTimestamp,u)-u,y=Math.min(v.endTimestamp,u+864e5)-u,w=v.wholeDays;v.startTimestamp<=u&&v.endTimestamp>=u+864e5&&(w=!0);var k=new Date(g+u),b={text:v.title+(v.startTimestamp>=u&&!w?" ("+i(k.getHours())+":"+i(k.getMinutes())+")":""),model:v,fileModel:null,width:100,left:0,maxNumOfSimultTasks:0,dayTaskStart:g,dayTaskEnd:y,topContinues:v.startTimestamp<u,bottomContinues:v.endTimestamp>u+864e5,wholeDay:w,taskGroupIcons:v.taskGroupIcons};m.push(b)}}if(this.view.model.settings["show-files"])for(var D in this.view.model.files){var T=this.view.model.files[D];if(this.fileMatchesSearchString(T.fileName)&&this.fileMatchesFilter(D)){var C=this.getRoundedFileStartTimestamp(T);if(!(C<=u||C>=u+864e5)){var M=C+t.FILE_DURATION_MS,S=(g=Math.max(C,u)-u,y=Math.min(M,u+864e5)-u,{text:T.fileName,model:null,fileModel:T,width:100,left:0,maxNumOfSimultTasks:0,dayTaskStart:g,dayTaskEnd:y,topContinues:!1,bottomContinues:!1,wholeDay:!1,taskGroupIcons:[]});m.push(S)}}}this.arrangeTasks(m);var _={day:{date:h,tasks:m,isToday:r.DateUtils.isToday(h,n),startTimestamp:h.getTime(),dateStr:a[(h.getDay()+6)%7]+", "+i(h.getDate())+"."+i(h.getMonth()+1)+"."+h.getFullYear(),dayId:h.getDate()+"."+h.getMonth()+"."+h.getFullYear(),dayOfWeek:h.toLocaleDateString("en",{weekday:"long"}).toLowerCase()},start:h,end:p};o.push(_)}return o},t.prototype.arrangeTasks=function(e,n){void 0===n&&(n=100),e.sort((function(e,t){return(e.model?e.model.startTimestamp:e.fileModel.createdAt)-(t.model?t.model.startTimestamp:t.fileModel.createdAt)}));for(var i=[],a=0,s=e;a<s.length;a++){if(!(E=s[a]).wholeDay){var o=E.model?E.model.startTimestamp:this.getRoundedFileStartTimestamp(E.fileModel),r=E.model?E.model.endTimestamp:o+t.FILE_DURATION_MS;i.push({at:o,task:E,start:!0}),i.push({at:r,task:E,start:!1})}}i.sort((function(e,t){return e.at!=t.at?e.at-t.at:(e.start?1:0)-(t.start?1:0)}));for(var l=0,c={},d=0,h=i;d<h.length;d++){var p=(O=h[d]).task.model?O.task.model.id:O.task.fileModel.identifier;if(O.start){for(var u in++l,c)c[u]=Math.max(c[u],l);c[p]=l}else--l,O.task.maxNumOfSimultTasks=c[p],delete c[p]}l=0;for(var m=[],f=[],v=0,g=i;v<g.length;v++){(O=g[v]).start?(++l,f.push(O.task)):--l,0==l&&f.length>0&&(m.push(f),f=[])}for(var y=0,w=m;y<w.length;y++){for(var k=w[y],b=0,D=0,T=k;D<T.length;D++){var C=T[D];b=Math.max(b,C.maxNumOfSimultTasks)}for(var M=0,S=k;M<S.length;M++){(C=S[M]).maxNumOfSimultTasks=b}}for(var _=0,P=e;_<P.length;_++){var E;(E=P[_]).wholeDay||(E.width=n/E.maxNumOfSimultTasks)}for(var I=[],x=0,$=i;x<$.length;x++){var O;if((O=$[x]).start){I.sort((function(e,t){return e.left-t.left}));for(var L=0,A=0,H=I;A<H.length;A++){var R=H[A];if(R.left-L>=O.task.width)break;L=R.left+R.width}O.task.left=L,I.push(O.task)}else{var N=I.indexOf(O.task);N>=0&&I.splice(N,1)}}},t.prototype.fillEntries=function(e){for(var t=this.$entriesContainer.children(),n=this.$fixedTasksContainer.find(".entry"),i=0;i<e.length;++i){var a=e[i],o=t.eq(i),r=n.eq(i),l=o.find(".entry-tasks"),c=r.find(".entry-tasks").find(".pf-content");l.html(""),c.html(""),r.find(".entry-header").prop("title",a.day.dateStr).text(a.day.dateStr),o[0].setAttribute("data-day",a.day.dayId),r[0].setAttribute("data-day",a.day.dayId),o.toggleClass("today",a.day.isToday),r.toggleClass("today",a.day.isToday),r[0].setAttribute("data-day-of-week",a.day.dayOfWeek);for(var d=0,h=a.day.tasks;d<h.length;d++){var p=h[d],u=document.createElement("div");u.setAttribute("draggable","true"),u.setAttribute("data-task-id",p.model?p.model.id:""),u.setAttribute("data-file-id",p.fileModel?p.fileModel.identifier:""),p.model?u.className="task is-task task-status-"+p.model.status+(p.width<100?" narrow":"")+" has-task-tooltip":u.className="task is-file"+(p.width<100?" narrow":"")+" has-file-tooltip",p.topContinues&&(u.className+=" top-continues"),p.bottomContinues&&(u.className+=" bottom-continues"),!p.wholeDay&&p.dayTaskEnd-p.dayTaskStart<=9e5&&(u.className+=" compact"),p.wholeDay||(u.style.top=p.dayTaskStart/864e3+"%",u.style.bottom=100-p.dayTaskEnd/864e3+"%",u.style.left=p.left+"%",u.style.width=p.width+"%");var m=document.createElement("div");if(m.className="task-inner",m.innerText=p.text,p.taskGroupIcons&&p.taskGroupIcons.length>0)for(var f=0,v=p.taskGroupIcons;f<v.length;f++){var g=v[f],y=this.view.emptyTgIconTemplates[this.view.getIconId(g)].cloneNode(!0);y.style.color=g.color,s.JQuery(m).prepend(y)}else if(p.fileModel&&p.fileModel.icon){var w=document.createElement("span");w.className="file-icon "+p.fileModel.icon,s.JQuery(m).prepend(w)}u.appendChild(m),p.wholeDay?c[0].appendChild(u):l[0].appendChild(u)}}},t.prototype.updateFixedTasksContainerHeight=function(){var e=0;this.$fixedTasksContainer.find(".entry").each((function(t,n){e=Math.max(e,s.JQuery(n).find(".task").length)})),this.$fixedTasksContainer.css("height",19*e+23)},t.prototype.updateTasksLineClamp=function(){if(!this.$entriesContainer.is(":visible"))return!0;var e=this.$entriesContainer.find(".task");if(0==e.length)return!0;var t=!1,n=[];return e.each((function(e,i){var a=s.JQuery(i),o=a.height();o>0&&(t=!0);var r=Math.floor((o-l.WeekRenderer.TASK_PADDING_TOP_PLUS_BOTTOM)/l.WeekRenderer.TASK_LINE_HEIGHT);n.push({$el:a,lc:Math.max(1,r)})})),n.forEach((function(e){e.$el.find(".task-inner")[0].style.webkitLineClamp=e.lc})),t},t.prototype.adjustHoursSeparators=function(e){for(var t=[1,2,3,4,6],n=t[t.length-1],i=0,a=t;i<a.length;i++){if(24/(r=a[i])*40<e){n=r;break}}for(var s=0,o=t;s<o.length;s++){var r=o[s];this.$container.toggleClass("hour-separators-1_"+r,r==n)}},t.prototype.onContainerResize=function(){var e=this,t=this.$entriesContainer[0].getBoundingClientRect();this.adjustHoursSeparators(t.height),this.updateTasksLineClamp()||s.Q().then((function(){var t=e.$entriesContainer[0].getBoundingClientRect();e.adjustHoursSeparators(t.height),e.updateTasksLineClamp()}))},t.prototype.taskMatchesSearchString=function(e,t){t=o.SearchFilter.prepareHaystack(t).replace(/<(?:.|\n)*?>/gm,"");var n=this.view.searchStr;return n.length>0&&"#"==n[0]?0==e.indexOf(n.substr(1)):t.indexOf(n)>=0},t.prototype.getRoundedFileStartTimestamp=function(e){var n=e.createdAt;return t.FILE_ROUND_START_MS&&(n=Math.round(n/t.FILE_ROUND_START_MS)*t.FILE_ROUND_START_MS),n},t.FILE_DURATION_MS=18e5,t.FILE_ROUND_START_MS=9e5,t}(o.Renderer);n.StaticDaysRenderer=d,d.prototype.className="com.privmx.plugin.calendar.component.calendarPanel.renderers.StaticDaysRenderer"},{"../../../main/DateUtils":21,"../VirtualScrollZoom":4,"./Renderer":7,"./WeekRenderer":11,"pmc-web":27}],11:[function(e,t,n){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=e("pmc-web"),o=e("../../../main/DateUtils"),r=e("./FastListRenderer"),l=e("../template/entry-week.html"),c=e("../VirtualScrollZoom"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dayWidth=400,t.cachedDays=null,t.cachedDaysByName=null,t.rects=[],t.centerAfterRenderArgs=null,t}return a(t,e),t.prototype.init=function(){var e=this;if(!this.firstVisibleWeek){var n=o.DateUtils.weekStartDate(new Date);this.firstVisibleWeek=new Date(n.getFullYear(),n.getMonth(),n.getDate()-7*t.VISIBLE_RANGE_DELTA_W),this.lastVisibleWeek=new Date(n.getFullYear(),n.getMonth(),n.getDate()+7*t.VISIBLE_RANGE_DELTA_W)}this.emptyEntryTemplate=this.view.templateManager.createTemplate(l.func).renderToJQ()[0];var i=this.view.$container.find(".mode.mode-week"),a=i.find(".fl-container")[0];s.JQuery(a).pfScroll(),a=a.childNodes[0];var r=i.find(".fl-padding-container")[0],d=i.find(".fl-entries-container")[0];s.JQuery(d).on("mousewheel",this.onMouseWheel.bind(this)),this.fastList=this.fastListCreator.create(a,r,d),this.fastList.setEmptyElementCreator(this.createFastListEmptyElement.bind(this)),this.fastList.setElementFiller(this.fillFastListElement.bind(this)),this.fastList.setBeforeRender(this.beforeFastListRender.bind(this)),this.fastList.setAfterRender(this.afterFastListRender.bind(this)),this.fastList.setAfterContainerResize(this.afterFastListResize.bind(this),!1,i[0]);var h=new c.VirtualScrollZoom(-t.HEADERS_HEIGHT);return this.vsz=h,h.$container=s.JQuery(d),this.updateVszElements(),h.init(),this.applySettings(!1),s.Q().then((function(){e.updateFastListEntries(),e.centerFastList(),e.fastList.init()}))},t.prototype.updateVszElements=function(){var e=this;this.vsz.elements=[],s.JQuery(this.fastList.entriesContainer).find(".entry-tasks").each((function(t,n){e.vsz.elements.push({$element:s.JQuery(n),$viewport:s.JQuery(n).closest(".entry.day")})}));var t=s.JQuery(this.fastList.entriesContainer).closest(".mode.mode-week").find(".hours-container-inner");this.vsz.elements.push({$element:t,$viewport:t.closest(".hours-container")})},t.prototype.getRendererName=function(){return"week"},t.prototype.renderFastList=function(e){void 0===e&&(e=!1),this.fastList.render(e)},t.prototype.beforeFastListRender=function(){this.rects=[]},t.prototype.afterFastListRender=function(e,t){if(t){var n=this.getActiveDate();n&&this.view.setSelectedDate(n.getDate(),n.getMonth(),n.getFullYear(),!1)}else this.goToDate(this.view.model.selectedDay,this.view.model.selectedMonth,this.view.model.selectedYear);this.view.updateSelection();for(var i=null,a=this.view.mouseX,s=this.view.mouseY,o=0,r=this.rects;o<r.length;o++){if(a>=(d=r[o]).x1&&a<d.x2&&s>=d.y1&&s<d.y2){i=d.taskId;break}}if(null!==i)for(var l=0,c=this.rects;l<c.length;l++){var d;(d=c[l]).taskId==i&&d.el.classList.add("hover")}this.updateVszElements(),this.vsz.repaint(),this.centerAfterRenderArgs&&this.fastList.center(this.centerAfterRenderArgs.entryId,this.centerAfterRenderArgs.delta)&&(this.centerAfterRenderArgs=null)},t.prototype.onMouseWheel=function(e){if(this.zoomMode!=r.ZoomMode.FIXED&&(!e.shiftKey||e.ctrlKey||e.altKey)&&e.ctrlKey&&e.altKey){e.preventDefault(),e.stopPropagation();var t=s.JQuery(this.fastList.container).offset().left,n=e.pageX-t,i=this.fastList.container.scrollTop+n,a=e.deltaY;a<0?this.zoomIn(i,n):a>0&&this.zoomOut(i,n)}},t.prototype.zoomInOut=function(e,n,i){void 0===n&&(n=null),void 0===i&&(i=null),null===i&&(i=s.JQuery(this.fastList.container).width()/2),null===n&&(n=this.fastList.container.scrollTop+i);e?this.zoom*t.ZOOM_FACTOR<=4&&(this.zoom*=t.ZOOM_FACTOR,n*=t.ZOOM_FACTOR):this.zoom/t.ZOOM_FACTOR>=.25&&(this.zoom/=t.ZOOM_FACTOR,n/=t.ZOOM_FACTOR);var a=n-i;this.fastList.container.scrollTo(0,Math.round(a)),this.updateZoom()},t.prototype.goToDate=function(e,t,n){var i=-1,a=new Date(n,t,e,12);for(var s in this.fastList.entries){var o=this.fastList.entries[s];if(o.data.start<=a&&o.data.end>=a){i=parseInt(s);break}}i>=0&&(this.fastList.center(i)||(this.centerAfterRenderArgs={entryId:i,delta:null}))},t.prototype.getActiveDate=function(){for(var e=this.fastList.prevContainerInfo?this.fastList.prevContainerInfo[1]:this.fastList.container.clientHeight,t=(this.fastList.prevContainerInfo?this.fastList.prevContainerInfo[0]:this.fastList.container.scrollTop)+e/2,n=0,i=this.fastList.entries;n<i.length;n++){var a=i[n];if(a.startsAt<t&&a.startsAt+a.height>=t)return a.data.day.date}return null},t.prototype.adjustHoursSeparators=function(e){for(var t=[1,2,3,4],n=t[t.length-1],i=0,a=t;i<a.length;i++){if(24/(l=a[i])*40<e){n=l;break}}for(var o=0,r=t;o<r.length;o++){var l=r[o];s.JQuery(this.fastList.container).closest(".mode-week").toggleClass("hour-separators-1_"+l,l==n)}},t.prototype.getPrevNextAbsDelta=function(){return 1},t.prototype.updateFastListEntries=function(){var e=[],n=7*(2*t.VISIBLE_RANGE_DELTA_W+1),i=this.firstVisibleWeek.getFullYear(),a=this.firstVisibleWeek.getMonth(),s=this.firstVisibleWeek.getDate(),r=new Date,l={},c=[],d=this.fastList.container.parentElement.parentElement.getBoundingClientRect();this.fastList.container.parentElement.style.width=d.height+"px",this.fastList.container.parentElement.style.height=d.width+"px";var h=this.view.getFragmentsContainerRect();if(this.adjustHoursSeparators(h.h),this.cachedDays){var p=r.getTime();for(var u in c=this.cachedDays,l=this.cachedDaysByName){(w=l[u]).tasks=[],w.isToday=p>=w.startTimestamp&&p<w.startTimestamp+864e5}}else{for(var m=function(e){return(e<10?"0":"")+e},f=[],v=0;v<7;++v)f.push(this.view.parent.i18n("plugin.calendar.component.calendarPanel.daysOfWeek.short."+v));for(v=0;v<n;++v){var g=new Date(i,a,s+v),y=g.getDate()+"."+g.getMonth()+"."+g.getFullYear(),w={date:g,tasks:[],dayNumber:g.getDate(),isToday:o.DateUtils.isToday(g,r),startTimestamp:g.getTime(),dateStr:f[(g.getDay()+6)%7]+", "+m(g.getDate())+"."+m(g.getMonth()+1)+"."+g.getFullYear(),dayId:g.getDate()+"."+g.getMonth()+"."+g.getFullYear()};c.push(w),l[y]=w}this.cachedDays=c,this.cachedDaysByName=l}var k=function(e){return(e<10?"0":"")+e},b=this.dayWidth*this.zoom;for(var D in this.view.model.tasks){var T=this.view.model.tasks[D];if(this.taskMatchesSearchString(D,T.title)&&this.taskMatchesFilter(D)){var C=T.wholeDays,M=new Date(T.startTimestamp),S=C?864e5:T.endTimestamp-T.startTimestamp,_=Math.ceil((S+1e3*(60*(60*M.getHours()+M.getMinutes())+M.getSeconds()))/864e5);for(v=0;v<_;++v){if(w=l[y=(se=new Date(T.startTimestamp+864e5*v)).getDate()+"."+se.getMonth()+"."+se.getFullYear()]){var P=Math.max(T.startTimestamp,w.startTimestamp)-w.startTimestamp,E=Math.min(T.endTimestamp,w.startTimestamp+864e5)-w.startTimestamp;w.tasks.push({model:T,fileModel:null,text:T.title.trim()+(T.startTimestamp>=w.startTimestamp&&!C?" ("+k(M.getHours())+":"+k(M.getMinutes())+")":""),width:b,left:0,maxNumOfSimultTasks:0,dayTaskStart:P,dayTaskEnd:E,topContinues:T.startTimestamp<w.startTimestamp,bottomContinues:T.endTimestamp>w.startTimestamp+864e5,wholeDay:C||T.startTimestamp<=w.startTimestamp&&T.endTimestamp>=w.startTimestamp+864e5})}}}}if(this.view.model.settings["show-files"])for(var I in this.view.model.files){var x=this.view.model.files[I];if(this.fileMatchesSearchString(x.fileName))if(this.fileMatchesFilter(I))if(w=l[y=(se=new Date(x.createdAt)).getDate()+"."+se.getMonth()+"."+se.getFullYear()]){E=P=Math.max(x.createdAt,w.startTimestamp)-w.startTimestamp;w.tasks.push({model:null,fileModel:x,text:x.fileName,width:b,left:0,maxNumOfSimultTasks:0,dayTaskStart:P,dayTaskEnd:E,topContinues:!1,bottomContinues:!1,wholeDay:!1})}}for(var $=0,O=c;$<O.length;$++){(w=O[$]).tasks.sort((function(e,t){return(e.model?e.model.startTimestamp:e.fileModel.createdAt)-(t.model?t.model.startTimestamp:t.fileModel.createdAt)}))}for(var L=0,A=c;L<A.length;L++){for(var H=[],R=0,N=(w=A[L]).tasks;R<N.length;R++){var F=(T=N[R]).model?T.model.startTimestamp:T.fileModel.createdAt,V=T.model?T.model.endTimestamp:T.fileModel.createdAt;H.push({at:F,task:T,start:!0}),H.push({at:V,task:T,start:!1})}H.sort((function(e,t){return e.at!=t.at?e.at-t.at:(e.start?1:0)-(t.start?1:0)}));for(var z=0,W={},Y=0,B=H;Y<B.length;Y++){var j=(X=B[Y]).task.model?X.task.model.id:X.task.fileModel.identifier;if(X.start){for(var J in++z,W)W[J]=Math.max(W[J],z);W[j]=z}else--z,X.task.maxNumOfSimultTasks=W[j],delete W[j]}for(var K=this.dayWidth*this.zoom,U=0,Q=w.tasks;U<Q.length;U++){(T=Q[U]).width=K/T.maxNumOfSimultTasks}for(var G=[],Z=0,q=H;Z<q.length;Z++){var X;if((X=q[Z]).start){G.sort((function(e,t){return e.left-t.left}));for(var ee=0,te=0,ne=G;te<ne.length;te++){var ie=ne[te];if(ie.left-ee>=X.task.width)break;ee=ie.left+ie.width}X.task.left=ee,G.push(X.task)}else{var ae=G.indexOf(X.task);ae>=0&&G.splice(ae,1)}}}for(v=0;v<c.length;++v){var se=c[v].date,oe=new Date(se.getFullYear(),se.getMonth(),se.getDate()+1);e.push({data:{day:c[v],start:se,end:oe,containerRectWidth:h.w,containerRectHeight:h.h,containerRectLeft:h.x,containerRectTop:h.y},height:this.dayWidth*this.zoom,startsAt:0})}this.fastList.setEntries(e)},t.prototype.fillFastListElement=function(e,n,i){e.style.width=n.data.containerRectHeight+"px",e.style.height=n.height+"px",e.classList.add("day"),e.classList.toggle("today",n.data.day.isToday),e.setAttribute("data-day",n.data.day.dayId);var a=e.children[0];a.style.width=n.height+"px",a.style.height=n.data.containerRectHeight+"px";var s=a.children[0];s.textContent=n.data.day.dateStr,s.title=n.data.day.dateStr;var o=a.children[1];o.innerHTML="";for(var r=this.fastList.getScrollTop(),l=n.data.containerRectLeft+t.LEFT_HEADERS_WIDTH+this.dayWidth*this.zoom*i-r,c=t.HEADERS_HEIGHT+n.data.containerRectTop,d=n.data.containerRectHeight-t.HEADERS_HEIGHT,h=0,p=n.data.day.tasks;h<p.length;h++){var u=p[h],m=(u.dayTaskEnd-u.dayTaskStart)/864e5*d,f=Math.floor((m-t.TASK_PADDING_TOP_PLUS_BOTTOM)/t.TASK_LINE_HEIGHT),v=document.createElement("div");v.setAttribute("draggable","true"),v.setAttribute("data-task-id",u.model?u.model.id:null),v.setAttribute("data-file-id",u.fileModel?u.fileModel.identifier:null),u.model?v.className="task task-status-"+u.model.status+(u.width<100?" narrow":"")+" has-task-tooltip":v.className="task task-file"+(u.width<100?" narrow":"")+" has-file-tooltip",u.topContinues&&(v.className+=" top-continues"),u.bottomContinues&&(v.className+=" bottom-continues"),!u.wholeDay&&u.dayTaskEnd-u.dayTaskStart<=9e5&&(v.className+=" compact");var g=u.left+l,y=u.dayTaskStart/864e5*d+c,w=u.width,k=y+(u.dayTaskEnd-u.dayTaskStart)/864e5*d,b=g+w;this.rects.push({x1:g,y1:y,x2:b,y2:k,el:v,taskId:u.model?u.model.id:u.fileModel.identifier}),v.style.top=u.dayTaskStart/864e3+"%",v.style.bottom=100-u.dayTaskEnd/864e3+"%",v.style.left=u.left+"px",v.style.width=u.width+"px";var D=document.createElement("div");D.className="task-inner",D.innerText=u.text,D.style.webkitLineClamp=Math.max(1,f),v.appendChild(D),o.appendChild(v)}},t.prototype.getZoomForDaysNum=function(e,t){return void 0===t&&(t=!1),(t?this.fastList.container.clientHeight:this.fastList.getClientHeight())/e/this.dayWidth},t.VISIBLE_RANGE_DELTA_W=500,t.HORIZONTAL_TASK_PADDING=8,t.HEADERS_HEIGHT=23,t.TASK_PADDING_TOP_PLUS_BOTTOM=4,t.TASK_LINE_HEIGHT=15,t.LEFT_HEADERS_WIDTH=40,t.ZOOM_FACTOR=1.1,t}(r.FastListRenderer);n.WeekRenderer=d,d.prototype.className="com.privmx.plugin.calendar.component.calendarPanel.renderers.WeekRenderer"},{"../../../main/DateUtils":21,"../VirtualScrollZoom":4,"../template/entry-week.html":14,"./FastListRenderer":5,"pmc-web":27}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.func={helper:"com.privmx.core.web-utils.MailClientViewHelper",func:function(e,t,n){var i="",a=function(e){i+=e};return a('<div class="actions-menu actions-list">\n  '),e.items.forEach((function(e){e.hidden||(a("\n    "),e.isSeparator?a('\n          <div class="separator"></div>\n        '):(a('\n    <div class="action" data-action-id="'),a(n.escapeHtml(e.id)),a('">\n      '),e.icon&&(a('\n        <span class="ico '),a(n.escapeHtml(e.icon)),a('"></span>\n      ')),a('\n      <span class="holder">\n        '),a(n.escapeHtml(n.i18n(e.labelKey))),a("\n      </span>\n    </div>\n  ")))})),a("\n</div>\n"),i}}},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.func={helper:"com.privmx.core.web-utils.MailClientViewHelper",func:function(e,t,n){var i="",a=function(e){i+=e};a('<div class="entry">\n  <div class="month-info"></div>\n  <div class="weeks">\n    ');for(var s=0;s<6;++s){a('\n      <div class="week">\n      ');for(var o=0;o<7;++o){a("\n        ");var r="";0==o&&(r+=" first-column"),6==o&&(r+=" last-column"),r+=" col-"+o,a('\n        <div class="day'),a(n.escapeHtml(r)),a('">\n          <span class="day-number"></span>\n          <div class="tasks"></div>\n          <div class="more-tasks-info"></div>\n          <div class="expanded-day-backdrop"></div>\n        </div>\n      ')}a("\n      </div>\n    ")}return a("\n  </div>\n</div>"),i}}},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.func={helper:"com.privmx.core.web-utils.MailClientViewHelper",func:function(e,t,n){var i="";return i+='<div class="entry">\n  <div class="entry-inner">\n    <div class="entry-header"></div>\n    <div class="entry-tasks"></div>\n  </div>\n</div>'}}},{}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.func={helper:"com.privmx.core.web-utils.MailClientViewHelper",func:function(e,t,n){var i="",a=function(e){i+=e},s=e&&"{"==e[0]?JSON.parse(e):null;return a('\n<span class="taskgroup-icon">\n  '),s?(a("\n    "),"shape"==s.type?(a('\n      <span class="taskgroup-icon--shape shape-'),a(n.escapeHtml(s.shape)),a('" style="color:'),a(n.escapeHtml(s.color)),a('"></span>\n    ')):"fa"==s.type&&(a('\n      <span class="taskgroup-icon--fa fa fa-'),a(n.escapeHtml(s.fa)),a('" style="color:'),a(n.escapeHtml(s.color)),a('"></span>\n    ')),a("\n  ")):(a('\n    <span class="taskgroup-icon--none">'),a(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.taskGroupIcon.none"))),a("</span>\n  ")),a("\n</span>"),i}}},{}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.func={helper:"com.privmx.core.web-utils.MailClientViewHelper",func:function(e,t,n){var i,a="",s=function(e){a+=e};s('\n<div class="panel calendar-panel-component" tabindex="-1">\n  <div class="notifications-container-wrapper"></div>\n  <div class="top">\n    <div class="left">\n      '),e.isInSummaryWindow?(s('\n      <div class="wi-element active">\n        <div class="wi-element-inner">\n          <div class="wi-element-icon bckg-icon small-icon">\n            <i class="fa fa-calendar"></i>\n          </div>\n          <div class="wi-element-name">\n            '),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.summaryWindow.title"))),s("\n          </div>\n        </div>\n      </div>\n      ")):e.isConv2Section?(s("\n        "),s(t.render(e.conv2Model,{})),s("\n      ")):e.isPrivateSection||e.isTasksAssignedToMe||e.isTasksCreatedByMe?(s('\n        <li class="conversation-element contact without-description small-icon" data-conversation-id="'),s(n.escapeHtml(e.myHashmail)),s('">\n          <span>\n            <div class="image-with-data">\n              <p class="image">\n                <canvas class="not-rendered" data-tooltip-trigger="'),s(n.escapeHtml(e.myHashmail)),s('" data-hashmail-image="'),s(n.escapeHtml(e.myHashmail)),s('" data-width="30" data-height="30" data-auto-size="true" data-auto-refresh="true" width="60" height="60" style="width: 30px; height: 30px;"></canvas>\n              </p>\n              <div class="text-col">\n                <p class="name">\n                  '),e.isPrivateSection&&(s("\n                    "),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.sidebar.private"))),s("\n                  ")),e.isTasksAssignedToMe&&(s("\n                    "),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.sidebar.assigned-to-me"))),s("\n                  ")),e.isTasksCreatedByMe&&(s("\n                    "),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.sidebar.created-by-me"))),s("\n                  ")),s("\n                </p>\n              </div>\n            </div>\n          </span>\n        </li>\n      ")):(s('\n      <div class="wi-element active">\n        <div class="wi-element-inner">\n          <div class="small-icon wi-element-icon bckg-icon '),s(n.escapeHtml(e.isPublic||!e.isRegularSection||e.isPrivateSection?"":"bckg-icon-border")),s(" "),s(n.escapeHtml(e.isPrivateSection?"":"has-section-tooltip")),s('" data-section-id="'),s(n.escapeHtml(e.projectId)),s('">\n            <img src="'),s(n.escapeHtml(n.getAssetByName("DEFAULT_PRIVMX_ICON"))),s('" class="'),s(n.escapeHtml(e.isTrash||e.isAllTasks?"hidden":"")),s('" />\n            <i class="fa fa-calendar proj-fa-icon '),s(n.escapeHtml(e.isAllTasks?"":"hidden")),s('"></i>\n            <i class="fa ico-bin proj-fa-icon '),s(n.escapeHtml(e.isTrash?"":"hidden")),s('"></i>\n          </div>\n          <div class="wi-element-name">\n            '),s(n.escapeHtml(e.projectName)),s("\n          </div>\n        </div>\n      </div>\n      ")),s('\n      <div class="buttons-go-to">\n        <span class="btn btn-sm go-to-chat" data-action="open-chat" data-window-opener="true">\n          <i class="ico-comment"></i>\n        </span>\n        <span class="btn btn-sm go-to-notes" data-action="open-notes" data-window-opener="true">\n          <i class="ico-note"></i>\n        </span>\n        <span class="btn btn-sm go-to-tasks" data-action="open-tasks" data-window-opener="true">\n          <i class="fa fa-tasks"></i>\n        </span>\n      </div>\n      <div class="extra-calendars-container"></div>\n      <div class="filter-container"></div>\n    </div>\n    <div class="datepicker-container"></div>\n    <div class="button-container">\n      <div class="mode-container"></div>\n      <button class="btn btn-xs btn-default refresh" title="'),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.view-refresh-tooltip"))),s('">\n        <span class="fa fa-refresh"></span>\n      </button>\n      <button class="btn btn-xs btn-default settings" title="'),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.view-options-tooltip"))),s('">\n        <span class="ico-settings"></span>\n      </button>\n      <button class="btn btn-success btn-sm small in-summary-as-icon" data-action="task-new" title="'),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.new-task-tooltip"))),s('" data-payload="__orphans__" data-taskgroup-project-id="'),s(n.escapeHtml(e.isConv2Section?"conv2":e.projectId?e.projectId:e.privateSectionId)),s('">\n        <i class="fa fa-plus"></i>\n        <span>'),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.new-task"))),s('</span>\n      </button>\n    </div>\n  </div>\n\t<div class="context-menu-settings context-menu">\n\t  <div class="context-menu-backdrop2"></div>\n\t  <ul class="context-menu-content">\n      <li class="context-menu-group-header">'),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.settings.headers.view-settings"))),s('</li>\n      <li>\n        <span class="hide-in-summary">\n          '),i=e.settings["enable-day-preview-panel"]?" checked":"",s('\n          <input type="checkbox" id="calendar-settings-enable-day-preview-panel-'),s(n.escapeHtml(e.uniqueSafeId)),s("-"),s(n.escapeHtml(e.calendarId)),s('" data-setting="enable-day-preview-panel" '),s(n.escapeHtml(i)),s(' />\n          <label for="calendar-settings-enable-day-preview-panel-'),s(n.escapeHtml(e.uniqueSafeId)),s("-"),s(n.escapeHtml(e.calendarId)),s('">'),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.settings.enable-day-preview-panel"))),s('</label>\n        </span>\n      </li>\n      <li>\n        <span class="hide-in-summary">\n          '),i=e.settings["show-task-preview-panel"]?" checked":"",s('\n          <input type="checkbox" id="calendar-settings-show-task-preview-panel-'),s(n.escapeHtml(e.uniqueSafeId)),s("-"),s(n.escapeHtml(e.calendarId)),s('" data-setting="show-task-preview-panel" '),s(n.escapeHtml(i)),s(' />\n          <label for="calendar-settings-show-task-preview-panel-'),s(n.escapeHtml(e.uniqueSafeId)),s("-"),s(n.escapeHtml(e.calendarId)),s('">'),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.settings.show-task-preview-panel"))),s('</label>\n        </span>\n      </li>\n      <li class="subitem hide-in-summary">\n        <span>\n          '),i=e.settings["horizontal-task-preview-window-layout"]?" checked":"",s('\n          <input type="checkbox" id="calendar-settings-horizontal-task-preview-window-layout-'),s(n.escapeHtml(e.uniqueSafeId)),s("-"),s(n.escapeHtml(e.calendarId)),s('" data-setting="horizontal-task-preview-window-layout" '),s(n.escapeHtml(i)),s(' />\n          <label for="calendar-settings-horizontal-task-preview-window-layout-'),s(n.escapeHtml(e.uniqueSafeId)),s("-"),s(n.escapeHtml(e.calendarId)),s('">'),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.settings.horizontal-task-preview-window-layout"))),s("</label>\n        </span>\n      </li>\n      <li>\n        <span>\n          "),i=e.settings["show-task-tooltip"]?" checked":"",s('\n          <input type="checkbox" id="calendar-settings-show-task-tooltip-'),s(n.escapeHtml(e.uniqueSafeId)),s("-"),s(n.escapeHtml(e.calendarId)),s('" data-setting="show-task-tooltip" '),s(n.escapeHtml(i)),s(' />\n          <label for="calendar-settings-show-task-tooltip-'),s(n.escapeHtml(e.uniqueSafeId)),s("-"),s(n.escapeHtml(e.calendarId)),s('">'),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.settings.show-task-tooltip"))),s("</label>\n        </span>\n      </li>\n      <li>\n        <span>\n          "),i=e.settings["show-files"]?" checked":"",s('\n          <input type="checkbox" id="calendar-settings-show-files-'),s(n.escapeHtml(e.uniqueSafeId)),s("-"),s(n.escapeHtml(e.calendarId)),s('" data-setting="show-files" '),s(n.escapeHtml(i)),s(' />\n          <label for="calendar-settings-show-files-'),s(n.escapeHtml(e.uniqueSafeId)),s("-"),s(n.escapeHtml(e.calendarId)),s('">'),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.settings.show-files"))),s('</label>\n        </span>\n      </li>\n      <li class="settings-item--sort-files-by">\n        <span>\n          ');var o=e.settings["sort-files-by"];s('\n          <label for="calendar-settings-sort-files-by-'),s(n.escapeHtml(e.uniqueSafeId)),s("-"),s(n.escapeHtml(e.calendarId)),s('">'),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.settings.sort-files-by"))),s('</label>\n          <ul class="option-chooser" data-setting="sort-files-by">\n            <li class="option-chooser-option '),s(n.escapeHtml("created"==o?"active":"")),s('" data-option="created">created</li>\n            <li class="option-chooser-option '),s(n.escapeHtml("modified"==o?"active":"")),s('" data-option="modified">modified</li>\n          </ul>\n        </span>\n      </li>\n\t  </ul>\n  </div>\n  <div class="modes">\n    <div class="mode mode-month">\n      <div class="day-headers">\n        ');for(var r=0;r<7;++r)s("\n          <div>"),s(n.escapeHtml(n.i18n("plugin.calendar.component.calendarPanel.daysOfWeek."+r))),s("</div>\n        ");s('\n      </div>\n      <div class="fl-container">\n        <div class="fl-padding-container">\n          <div class="fl-entries-container"></div>\n        </div>\n      </div>\n    </div>\n    <div class="mode mode-week">\n      <div class="hours-container">\n        <div class="hours-container-inner">\n          <div class="left-hours-header">\n            ');for(var l=0;l<24;++l)s("\n              <div>"),s(n.escapeHtml((l<10?"0":"")+l)),s(":00</div>\n            ");s('\n          </div>\n          <div class="hours-lines">\n            ');for(l=0;l<24;++l)s("\n              <div></div>\n            ");s('\n          </div>\n        </div>\n      </div>\n      <div class="scrollable-contents-container">\n        <div class="fl-container">\n          <div class="fl-padding-container">\n            <div class="fl-entries-container"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="mode mode-singleweek">\n      <div class="fixed-tasks-container">\n        ');for(r=0;r<7;++r)s('\n          <div class="entry day">\n            <div class="entry-inner">\n              <div class="entry-header"></div>\n              <div class="entry-tasks"></div>\n            </div>\n          </div>\n        ');s('\n      </div>\n      <div class="second-container">\n        <div class="hours-container">\n          <div class="hours-container-inner">\n            <div class="left-hours-header">\n              ');for(l=0;l<24;++l)s("\n                <div>"),s(n.escapeHtml((l<10?"0":"")+l)),s(":00</div>\n              ");s('\n            </div>\n            <div class="hours-lines">\n              ');for(l=0;l<24;++l)s("\n                <div></div>\n              ");s('\n            </div>\n          </div>\n        </div>\n        <div class="entries-container">\n          ');for(r=0;r<7;++r)s('\n            <div class="entry day">\n              <div class="entry-inner">\n                <div class="entry-tasks"></div>\n              </div>\n            </div>\n          ');s('\n        </div>\n      </div>\n    </div>\n    <div class="mode mode-singleday">\n      <div class="fixed-tasks-container">\n        ');for(r=0;r<1;++r)s('\n          <div class="entry day">\n            <div class="entry-inner">\n              <div class="entry-header"></div>\n              <div class="entry-tasks"></div>\n            </div>\n          </div>\n        ');s('\n      </div>\n      <div class="second-container">\n        <div class="hours-container">\n          <div class="hours-container-inner">\n            <div class="left-hours-header">\n              ');for(l=0;l<24;++l)s("\n                <div>"),s(n.escapeHtml((l<10?"0":"")+l)),s(":00</div>\n              ");s('\n            </div>\n            <div class="hours-lines">\n              ');for(l=0;l<24;++l)s("\n                <div></div>\n              ");s('\n            </div>\n          </div>\n        </div>\n        <div class="entries-container">\n          ');for(r=0;r<1;++r)s('\n            <div class="entry day">\n              <div class="entry-inner">\n                <div class="entry-tasks"></div>\n              </div>\n            </div>\n          ');return s('\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="zoom-buttons">\n    <div class="zoom-btn zoom-btn-minus" data-action="zoom-out"><i class="fa fa-minus"></i></div>\n    <div class="zoom-btn zoom-btn-plus" data-action="zoom-in"><i class="fa fa-plus"></i></div>\n  </div>\n</div>'),a}}},{}],17:[function(e,t,n){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=e("pmc-web"),o=e("./template/main.html"),r=function(e){function t(t){var n=e.call(this,t)||this;return n.overridePrevNextAbsDelta=null,n.popupVisible=!1,n.documentMouseDownBound=null,n.documentKeyDownBound=null,n.customSelectDay=n.addComponent("customSelectDay",new s.component.customselect.CustomSelectView(n,{})),n.customSelectMonth=n.addComponent("customSelectMonth",new s.component.customselect.CustomSelectView(n,{})),n.customSelectYear=n.addComponent("customSelectYear",new s.component.customselect.CustomSelectView(n,{})),n.documentMouseDownBound=n.onDocumentMouseDown.bind(n),n.documentKeyDownBound=n.onDocumentKeyDown.bind(n),n}return a(t,e),t.prototype.init=function(e){var t=this,n=JSON.parse(e);return this.setModel(n),this.bindEvents(),this.customSelectDay.onChange((function(e){e&&(t.model.selectedDay=Number(e),t.triggerEvent("changeDay",t.model.selectedDay))})),this.customSelectMonth.onChange((function(e){e&&(t.model.selectedMonth=Number(e),t.triggerEvent("changeMonth",t.model.selectedMonth))})),this.customSelectYear.onChange((function(e){e&&(t.model.selectedYear=Number(e),t.triggerEvent("changeYear",t.model.selectedYear))})),s.Q.all([this.customSelectDay.triggerInit(),this.customSelectMonth.triggerInit(),this.customSelectYear.triggerInit()])},t.prototype.bindEvents=function(){this.$container&&0!=this.$container.length&&!this.$container.data("events-bound")&&(this.$container.on("click",".prev-btn",this.onPrevBtnClick.bind(this)),this.$container.on("click",".next-btn",this.onNextBtnClick.bind(this)),this.$container.on("click",".ok-btn",this.onOkBtnClick.bind(this)),this.$container.on("click",".cancel-btn",this.onCancelBtnClick.bind(this)),this.$container.data("events-bound","1"))},t.prototype.setModel=function(e){this.model=e,this.render()},t.prototype.setData=function(e){this.setModel(JSON.parse(e))},t.prototype.render=function(){this.$container.empty(),this.model&&(this.bindEvents(),this.$container.append(this.templateManager.createTemplate(o.func).renderToJQ(this.model)),this.$main=this.$container.children(".date-picker-component"),this.customSelectDay.setContainer(this.$container.find(".day-container")),this.customSelectMonth.setContainer(this.$container.find(".month-container")),this.customSelectYear.setContainer(this.$container.find(".year-container")))},t.prototype.setSelectedDate=function(e,t,n){this.model.selectedDay=e,this.model.selectedMonth=t,this.model.selectedYear=n},t.prototype.onPrevBtnClick=function(){this.overridePrevNextAbsDelta?this.triggerEvent("prev",this.overridePrevNextAbsDelta()):this.triggerEvent("prev")},t.prototype.onNextBtnClick=function(){this.overridePrevNextAbsDelta?this.triggerEvent("next",this.overridePrevNextAbsDelta()):this.triggerEvent("next")},t.prototype.onOkBtnClick=function(){this.hide(),this.triggerEvent("commitPopup")},t.prototype.onCancelBtnClick=function(){this.hide(),this.triggerEvent("cancelPopup")},t.prototype.setTimestamp=function(e){this.triggerEvent("setTimestamp",e)},t.prototype.setDuration=function(e){this.triggerEvent("setDuration",e)},t.prototype.show=function(e,t){if(void 0===t&&(t=null),!this.popupVisible){t&&(this.model.options.duration?this.setDuration(t):this.setTimestamp(t));var n=e[0];this.$main.addClass("popup-visible"),this.$main.css({left:n.offsetLeft-50,top:n.offsetTop-8}),document._preventClose=!0,s.JQuery(document).on("mousedown",this.documentMouseDownBound),s.JQuery(document).on("keydown",this.documentKeyDownBound),this.popupVisible=!0}},t.prototype.hide=function(){this.popupVisible&&(this.$main.removeClass("popup-visible"),delete document._preventClose,s.JQuery(document).off("mousedown",this.documentMouseDownBound),s.JQuery(document).off("keydown",this.documentKeyDownBound),this.popupVisible=!1)},t.prototype.onDocumentMouseDown=function(e){var t=s.JQuery(e.target);s.JQuery.contains(this.$container[0],t[0])||(this.hide(),this.triggerEvent("commitPopup"))},t.prototype.onDocumentKeyDown=function(e){"Escape"==e.key?(this.hide(),this.triggerEvent("cancelPopup")):"Enter"==e.key&&(this.hide(),this.triggerEvent("commitPopup"))},t}(s.component.base.ComponentView);n.DatePickerView=r,r.prototype.className="com.privmx.plugin.calendar.component.datePicker.DatePickerView"},{"./template/main.html":18,"pmc-web":27}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.func={helper:"com.privmx.core.web-utils.MailClientViewHelper",func:function(e,t,n){var i="",a=function(e){i+=e},s="";return!1===e.options.day&&(s+=" no-day"),!1===e.options.month&&(s+=" no-month"),!1===e.options.year&&(s+=" no-year"),!1===e.options.prev&&(s+=" no-prev"),!1===e.options.next&&(s+=" no-next"),!0===e.options.today&&(s+=" with-today"),!0===e.options.popup&&(s+=" popup"),!1===e.options.buttons&&(s+=" no-buttons"),!0===e.options.duration&&(s+=" duration-picker"),a('\n<div class="date-picker-component'),a(n.escapeHtml(s)),a('">\n  <div class="date">\n    <div class="prev-btn btn btn-default"><i class="fa fa-chevron-left"></i></div>\n    <div class="day-container"></div>\n    <div class="month-container"></div>\n    <div class="year-container"></div>\n    <div class="next-btn btn btn-default"><i class="fa fa-chevron-right"></i></div>\n    <button class="today-btn btn btn-default">'),a(n.escapeHtml(n.i18n("plugin.calendar.component.datePicker.today"))),a('</button>\n  </div>\n  <div class="popup-buttons">\n    <button class="btn btn-success ok-btn">'),a(n.escapeHtml(n.i18n("plugin.calendar.component.datePicker.buttons.ok"))),a('</button>\n    <button class="btn btn-default cancel-btn">'),a(n.escapeHtml(n.i18n("plugin.calendar.component.datePicker.buttons.cancel"))),a("</button>\n  </div>\n</div>"),i}}},{}],19:[function(e,t,n){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=e("pmc-web"),o=e("./template/main.html"),r=e("../../main/DateUtils"),l=function(e){function t(t){var n=e.call(this,t)||this;return n.dragStartLeft=null,n.dragStartTop=null,n.dragStartMouseX=null,n.dragStartMouseY=null,n.documentMouseMoveBound=null,n.documentMouseUpBound=null,n.popupVisible=!1,n.documentMouseDownBound=null,n.documentKeyDownBound=null,n.customSelectMonth=n.addComponent("customSelectMonth",new s.component.customselect.CustomSelectView(n,{})),n.customSelectYear=n.addComponent("customSelectYear",new s.component.customselect.CustomSelectView(n,{})),n.documentMouseDownBound=n.onDocumentMouseDown.bind(n),n.documentKeyDownBound=n.onDocumentKeyDown.bind(n),n}return a(t,e),t.prototype.init=function(e){var t=this,n=JSON.parse(e);return this.setModel(n),this.bindEvents(),this.customSelectMonth.onChange((function(e){e&&(t.model.visibleMonth=Number(e),t.triggerEvent("changeMonth",t.model.visibleMonth))})),this.customSelectYear.onChange((function(e){e&&(t.model.visibleYear=Number(e),t.triggerEvent("changeYear",t.model.visibleYear))})),s.Q.all([this.customSelectMonth.triggerInit(),this.customSelectYear.triggerInit()])},t.prototype.bindEvents=function(){this.$container&&0!=this.$container.length&&!this.$container.data("events-bound")&&(this.$container.on("click",".prev-btn",this.onPrevBtnClick.bind(this)),this.$container.on("click",".next-btn",this.onNextBtnClick.bind(this)),this.$container.on("click",".ok-btn",this.onOkBtnClick.bind(this)),this.$container.on("click",".cancel-btn",this.onCancelBtnClick.bind(this)),this.$container.on("click","[data-dmy]",this.onDayClick.bind(this)),this.$container.on("click",".time-item",this.onTimeClick.bind(this)),this.$container.on("mousewheel",this.onMouseWheel.bind(this)),this.$container.on("mousedown",".popup",this.onPopupMouseDown.bind(this)),this.$container.data("events-bound","1"))},t.prototype.setModel=function(e){this.model=e,this.render()},t.prototype.setData=function(e){this.setModel(JSON.parse(e))},t.prototype.render=function(){this.$container.empty(),this.model&&(this.bindEvents(),this.$container.append(this.templateManager.createTemplate(o.func).renderToJQ(this.model)),this.$main=this.$container.children(".date-time-picker-component"),this.customSelectMonth.setContainer(this.$container.find(".month-container")),this.customSelectYear.setContainer(this.$container.find(".year-container")))},t.prototype.setDateTimes=function(e,t,n,i,a,s,o){this.model.visibleDay=e,this.model.visibleMonth=t,this.model.visibleYear=n,this.model.selectedDay=i,this.model.selectedMonth=a,this.model.selectedYear=s,this.model.selectedTime=o,this.fillCalendar()},t.prototype.onPrevBtnClick=function(){this.triggerEvent("prev")},t.prototype.onNextBtnClick=function(){this.triggerEvent("next")},t.prototype.onOkBtnClick=function(){this.hide(),this.triggerEvent("commitPopup")},t.prototype.onCancelBtnClick=function(){this.hide(),this.triggerEvent("cancelPopup")},t.prototype.setTimestamp=function(e){this.triggerEvent("setTimestamp",e)},t.prototype.setDuration=function(e){this.triggerEvent("setDuration",e)},t.prototype.onDayClick=function(e){var t=e.currentTarget.getAttribute("data-dmy").split(".").map((function(e){return parseInt(e)})),n=t[0],i=t[1],a=t[2];--i;var s=new Date(a,i,n,0,0,0,this.model.selectedTime).getTime();this.setTimestamp(s)},t.prototype.onTimeClick=function(e){var t=e.currentTarget.getAttribute("data-val");if(t){var n=t.split(":").map((function(e){return parseInt(e)})),i=n[0],a=n[1];this.model.selectedTime=1e3*(3600*i+60*a),this.triggerEvent("changeTime",this.model.selectedTime)}else this.model&&(this.model.selectedTime=null,this.triggerEvent("changeTime",this.model.selectedTime))},t.prototype.onMouseWheel=function(e){var t=this.$container.find(".time-container");s.JQuery.contains(t[0],e.target)||(e.deltaY<0?this.triggerEvent("next"):this.triggerEvent("prev"))},t.prototype.onPopupMouseDown=function(e){if(s.JQuery(e.target).is(".popup, .popup-buttons, .date, .time, .left, .right, .pf-content, .pf-scroll-panel, .flex-container")){var t=this.$container.find(".popup");0!=t.length&&(this.dragStartLeft=parseInt(t.css("left")),this.dragStartTop=parseInt(t.css("top")),this.dragStartMouseX=e.screenX,this.dragStartMouseY=e.screenY,this.documentMouseMoveBound=this.onDocumentMouseMove.bind(this),this.documentMouseUpBound=this.onDocumentMouseUp.bind(this),s.JQuery(document).on("mouseup",this.documentMouseUpBound),s.JQuery(document).on("mousemove",this.documentMouseMoveBound))}},t.prototype.onDocumentMouseMove=function(e){this.$container.find(".popup").css({left:this.dragStartLeft+(e.screenX-this.dragStartMouseX),top:this.dragStartTop+(e.screenY-this.dragStartMouseY)})},t.prototype.onDocumentMouseUp=function(){s.JQuery(document).off("mouseup",this.documentMouseUpBound),s.JQuery(document).off("mousemove",this.documentMouseMoveBound)},t.prototype.show=function(e,t,n,i){if(void 0===n&&(n=null),void 0===i&&(i=!1),!this.popupVisible){n?this.setTimestamp(n):this.setTimestamp((new Date).getTime()),this.$main.toggleClass("whole-days",i),this.$main.addClass("popup-visible");var a={container:{x:5,y:5,width:t.offset().left+t.width()-10,height:t.offset().top+t.height()-10},target:{x:e.offset().left,y:e.offset().top,width:e.width(),height:e.height()},popup:{x:0,y:0,width:this.$main.width(),height:this.$main.height()}};a.popup.x=a.target.x+a.target.width/2-a.popup.width/2,a.popup.y=a.target.y+a.target.height/2-a.popup.height/2,a.popup.x=Math.max(5,a.popup.x),a.popup.y=Math.max(5,a.popup.y);var o=a.popup.x+a.popup.width,r=a.popup.y+a.popup.height,l=a.container.x+a.container.width,c=a.container.y+a.container.height;o>l&&(a.popup.x-=o-l+10),r>c&&(a.popup.y-=r-c+10);a.popup.x+380>l&&(a.popup.x=l-380),this.$main.css({left:a.popup.x,top:a.popup.y,width:"380px"}),document._preventClose=!0,s.JQuery(document).on("mousedown",this.documentMouseDownBound),s.JQuery(document).on("keydown",this.documentKeyDownBound),this.popupVisible=!0}},t.prototype.hide=function(){this.popupVisible&&(this.$main.removeClass("popup-visible"),delete document._preventClose,s.JQuery(document).off("mousedown",this.documentMouseDownBound),s.JQuery(document).off("keydown",this.documentKeyDownBound),this.popupVisible=!1)},t.prototype.onDocumentMouseDown=function(e){var t=s.JQuery(e.target);s.JQuery.contains(this.$container[0],t[0])||(this.hide(),this.triggerEvent("commitPopup"))},t.prototype.onDocumentKeyDown=function(e){"Escape"==e.key?(this.hide(),this.triggerEvent("cancelPopup")):"Enter"==e.key&&(this.hide(),this.triggerEvent("commitPopup"))},t.prototype.fillCalendar=function(){var e=this.model.visibleMonth,t=this.model.visibleYear,n=0==e?11:e-1,i=0==e?t-1:t,a=11==e?0:e+1,s=11==e?t+1:t,o=new Date(t,e,1),l=r.DateUtils.numDaysInMonth(e,t),c=r.DateUtils.numDaysInMonth(n,i),d=(o.getDay()+6)%7;0==d&&(d=7);for(var h=this.$container.find(".day-container")[0],p=0;p<42;++p){var u=h.children[p],m=void 0,f=void 0,v=void 0;p<d?(m=c-(d-p)+1,f=n,v=i,u.className="prev-month",u.textContent=m.toString()):p>=d+l?(m=p-d-l+1,f=a,v=s,u.className="next-month",u.textContent=m.toString()):(m=p-d+1,f=e,v=t,u.className="curr-month",u.textContent=m.toString());var g=new Date,y=m==g.getDate()&&f==g.getMonth()&&v==g.getFullYear(),w=m==this.model.selectedDay&&f==this.model.selectedMonth&&v==this.model.selectedYear;u.classList.toggle("today",y),u.classList.toggle("selected",w),u.setAttribute("data-dmy",m+"."+(f+1)+"."+v)}},t.prototype.updateTimeItems=function(e){var t=JSON.parse(e),n=this.$container.find(".time-container");0==n.find(".pf-content").length&&n.pfScroll();var i=n.find(".pf-content");i.html("");for(var a=0,o=t;a<o.length;a++){var r=o[a];i.append("<div class='time-item item"+(r.selected?" selected":"")+"' data-val='"+r.value+"'>"+r.text+"</div>")}var l=i.find(".item.selected");l.length>0&&s.webUtils.UI.scrollViewIfNeeded(i[0],l[0])},t}(s.component.base.ComponentView);n.DateTimePickerView=l,l.prototype.className="com.privmx.plugin.calendar.component.dateTimePicker.DateTimePickerView"},{"../../main/DateUtils":21,"./template/main.html":20,"pmc-web":27}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.func={helper:"com.privmx.core.web-utils.MailClientViewHelper",func:function(e,t,n){var i="",a=function(e){i+=e};a('\n<div class="date-time-picker-component popup'),a(n.escapeHtml("")),a('">\n  <div class="flex-container">\n    <div class="left"><div class="date">\n        <div class="prev-btn btn btn-default"><i class="fa fa-chevron-left"></i></div>\n        <div class="month-container"></div>\n        <div class="year-container"></div>\n        <div class="next-btn btn btn-default"><i class="fa fa-chevron-right"></i></div>\n      </div>\n      <div class="day-container">\n        ');for(var s=0;s<42;++s)a("\n          <div></div>\n        ");return a('\n      </div>\n    </div>\n    <div class="right">\n      <div class="time">\n        <div class="time-container"></div>\n      </div>\n    </div>\n  </div>\n  <div class="popup-buttons">\n    <button class="btn btn-success ok-btn">'),a(n.escapeHtml(n.i18n("plugin.calendar.component.dateTimePicker.buttons.ok"))),a('</button>\n    <button class="btn btn-default cancel-btn">'),a(n.escapeHtml(n.i18n("plugin.calendar.component.dateTimePicker.buttons.cancel"))),a("</button>\n  </div>\n</div>"),i}}},{}],21:[function(e,t,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.MON=0]="MON",e[e.TUE=1]="TUE",e[e.WED=2]="WED",e[e.THU=3]="THU",e[e.FRI=4]="FRI",e[e.SAT=5]="SAT",e[e.SUN=6]="SUN"}(n.DayOfWeek||(n.DayOfWeek={})),function(e){e[e.JAN=0]="JAN",e[e.FEB=1]="FEB",e[e.MAR=2]="MAR",e[e.APR=3]="APR",e[e.MAY=4]="MAY",e[e.JUN=5]="JUN",e[e.JUL=6]="JUL",e[e.AUG=7]="AUG",e[e.SEP=8]="SEP",e[e.OCT=9]="OCT",e[e.NOV=10]="NOV",e[e.DEC=11]="DEC"}(i=n.Month||(n.Month={}));var a=function(){function e(){}return e.numDaysInMonth=function(e,t){var n=this._daysInMonth[e];return e==i.FEB&&this.isLeapYear(t)&&++n,n},e.firstDayOfWeekInMonth=function(e,t){return(new Date(t,e,1).getDay()+6)%7},e.lastDayOfWeekInMonth=function(e,t){return this.firstDayOfWeekInMonth(e,t)+this.numDaysInMonth(e,t)-1},e.isLeapYear=function(e){return e%4==0&&e%100!=0||e%400==0},e.prevMonth=function(e,t){return--e<0&&(e+=12,t--),[e,t]},e.nextMonth=function(e,t){return++e>11&&(e=0,t++),[e,t]},e.weekNumber=function(e,t){void 0===t&&(t=!1);var n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),i=n.getUTCDay()||7;n.setUTCDate(n.getUTCDate()+4-i);var a=new Date(Date.UTC(n.getUTCFullYear(),0,1));return Math.ceil(((n.getTime()-a.getTime())/864e5+1)/7)},e.numWeeksInYear=function(e){var t=new Date(e,11,31);return this.weekNumber(t)},e.numWeeksBetween=function(e,t){return Math.abs((t-e)/6048e5)},e.weekStartDate=function(e){var t=(e.getDay()+6)%7;return new Date(e.getFullYear(),e.getMonth(),e.getDate()-t)},e.isToday=function(e,t){return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},e.getDayMsecs=function(e){var t=e.getHours(),n=e.getMinutes()+60*t,i=e.getSeconds()+60*n;return e.getMilliseconds()+1e3*i},e.getWeekStart=function(e){var t=(e.getDay()+6)%7;return new Date(e.getFullYear(),e.getMonth(),e.getDate()-t)},e.getWeekEnd=function(e){var t=(e.getDay()+6)%7;return new Date(e.getFullYear(),e.getMonth(),e.getDate()-t+7)},e._daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31],e}();n.DateUtils=a,a.prototype.className="com.privmx.plugin.calendar.main.DateUtils"},{}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.Global="global",e.CalendarWindow="calendar",e.SummaryWindow="summary"}(n.ViewContext||(n.ViewContext={}));var i=function(){function e(){}return e.ALL_TASKS_ID="all-tasks",e.TASKS_ASSIGNED_TO_ME_ID="tasks-assigned-to-me",e.TASKS_CREATED_BY_ME_ID="tasks-created-by-me",e.TRASH_ID="trash",e}();n.CustomTasksElements=i;var a=function(){function e(){}return e.MONTH="month",e.WEEK="week",e.SINGLE_WEEK="singleweek",e.SINGLE_DAY="singleday",e}();n.Modes=a,function(e){e.allTasks="all-tasks",e.onlyIdea="only-idea",e.onlyTodo="only-todo",e.onlyInProgress="only-in-progress",e.onlyDone="only-done",e.onlyNotDone="only-not-done"}(n.Filter||(n.Filter={})),function(e){e.UNKNOWN="unknown",e.TODO="todo",e.INPROGRESS="inprogress",e.DONE="done",e.IDEA="idea"}(n.TaskStatus||(n.TaskStatus={})),function(e){e.CREATED="created",e.MODIFIED="modified"}(n.SortFilesBy||(n.SortFilesBy={})),i.prototype.className="com.privmx.plugin.calendar.main.CustomTasksElements",a.prototype.className="com.privmx.plugin.calendar.main.Modes"},{}],23:[function(e,t,n){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s,o=e("pmc-web"),r=e("./template/main.html"),l=o.Q,c=o.JQuery,d=e("../../component/calendarPanel/CalendarPanelView"),h=e("../../component/datePicker/DatePickerView"),p=e("resize-observer-polyfill");!function(e){e[e.sidebar=0]="sidebar",e[e.calendar1=1]="calendar1",e[e.calendar2=2]="calendar2",e[e.preview=3]="preview"}(s||(s={}));var u=function(e){function t(n){var i=e.call(this,n,r.func)||this;return i.calendar1Panels={},i.calendar2Panels={},i.initializedDeferred=l.defer(),i.activeProjectId1=null,i.activeProjectId2=null,i.activeProjectHostHash1=null,i.activeProjectHostHash2=null,i.pendingEnsureCorrectPanelSizes=!1,i.remoteServers={},i.activePanelId=0,window.ResizeObserver||(window.ResizeObserver=p),i.verticalSplitter=i.addComponent("verticalSplitter",new o.component.splitter.SplitterView(i,{type:"vertical",handlePlacement:"right",handleDot:!0,firstPanelMinSize:t.SIDEBAR_MIN_WIDTH,secondPanelMinSize:function(){var e=0;return e+=t.CALENDAR1_MIN_WIDTH,i.verticalSplitter2&&i.verticalSplitter2.$right&&i.verticalSplitter2.$right.children().length>0&&i._showPreviewPanel&&(e+=i.verticalSplitter2.$right.outerWidth()),i.$calendars.hasClass("two-calendars")&&(e+=i.calendarsSplitter.$right.outerWidth()),e}})),i.verticalSplitter2=i.addComponent("verticalSplitter2",new o.component.splitter.SplitterView(i,{type:"vertical",handlePlacement:"right",handleDot:!0,flip:!0,firstPanelMinSize:function(){return i._showDayPreviewPanel?t.CALENDAR2_MIN_WIDTH+i.calendarsSplitter.$left.outerWidth():t.CALENDAR2_MIN_WIDTH},secondPanelMinSize:t.PREVIEW_MIN_WIDTH})),i.horizontalSplitter=i.addComponent("horizontalSplitter",new o.component.splitter.SplitterView(i,{type:"horizontal",handlePlacement:"bottom",handleDot:!0,flip:!0,firstPanelMinSize:function(){return Math.max(t.CALENDAR1_MIN_HEIGHT,i.$calendars.hasClass("two-calendars")?t.CALENDAR2_MIN_HEIGHT:0)},secondPanelMinSize:t.PREVIEW_MIN_HEIGHT})),i.calendarsSplitter=i.addComponent("calendarsSplitter",new o.component.splitter.SplitterView(i,{type:"vertical",handlePlacement:"right",handleDot:!0,flip:!1,firstPanelMinSize:t.CALENDAR1_MIN_WIDTH,secondPanelMinSize:t.CALENDAR2_MIN_WIDTH})),i.personsComponent=i.addComponent("personsComponent",new o.component.persons.PersonsView(i,i.helper)),i.personTooltip=new o.component.persontooltip.PersonTooltipView(i.templateManager,i.personsComponent),i.sectionTooltip=i.addComponent("sectiontooltip",new o.component.sectiontooltip.SectionTooltipView(i)),i.notifications=i.addComponent("notifications",new o.component.notification.NotificationView(i,{xs:!0})),i.disabledSection=i.addComponent("disabled-section",new o.component.disabledsection.DisabledSectionView(i)),i.sidebar=i.addComponent("sidebar",new o.component.sidebar.SidebarView(i,{conv2List:{personsView:i.personsComponent,extList:{template:null}},conv2Splitter:null,customElementList:{extList:{template:null,onAfterListRender:i.onAfterRenderCustomList.bind(i)}},sectionList:{extList:{template:null}},customSectionList:{extList:{template:null}}})),i.datePicker=i.addComponent("datePicker",new h.DatePickerView(i)),i.bindEvent(i.sidebar.customElementList.customElements,"ext-list-change",i.personsComponent.refreshAvatars.bind(i.personsComponent)),i.bindEvent(i.sidebar.customElementList.customElementsA,"ext-list-change",i.personsComponent.refreshAvatars.bind(i.personsComponent)),i.turnTimeAgoRefresher(3e5),o.Starter.dispatchEvent({type:"request-task-panel-view",parent:i,name:"task-panel-view"}),i}return a(t,e),t.prototype.registerPreview=function(e,t){this.previewPanel=this.addComponent("previewPanel",t)},t.prototype.onAfterRenderCustomList=function(){this.personsComponent.refreshAvatars()},t.prototype.initWindow=function(e){var t=this;(this.setModel(e),this.$settingsMenu=this.$main.find(".context-menu-settings"),this.$sidebar=this.$main.find(".panel-sidebar"),this.$calendar1=this.$main.find(".panel-calendar1"),this.$calendar2=this.$main.find(".panel-calendar2"),this.$preview=this.$main.find(".panel-preview"),this.$calendar1.on("click",this.onCalendar1PanelClick.bind(this)),this.$calendar2.on("click",this.onCalendar2PanelClick.bind(this)),this.$preview.on("click",this.onPreviewPanelClick.bind(this)),this.$body.on("click",".close-day-preview-btn",this.onCloseDayPreviewClick.bind(this)),this.bindKeyboardEvents(),window.ResizeObserver)&&new window.ResizeObserver((function(){t.updateCalendar1HeaderRight()})).observe(this.$calendar2[0]);return this._showPreviewPanel?this.$main.children(".right-buttons").children().addClass("gray"):this.$main.children(".right-buttons").children().removeClass("gray"),this.notifications.$container=this.$main.find(".notifications-container-wrapper"),l().then((function(){return t.verticalSplitter.$container=t.$main.find(".panels"),t.verticalSplitter.triggerInit()})).then((function(){var e=c('<div class="calendar-container"></div>');return t.verticalSplitter.$right.append(e),t.verticalSplitter2.$container=e,t.verticalSplitter2.triggerInit()})).then((function(){return t.horizontalSplitter.$container=t.verticalSplitter2.$left,t.horizontalSplitter.triggerInit()})).then((function(){return t.$calendars=c("<div class='calendars one-calendar'></div>"),t.horizontalSplitter.$top.append(t.$calendars),t.horizontalSplitter.$top.css("overflow","hidden"),t._showPreviewPanel||t.hideTaskPreviewPanel(),t.updatePreviewLocation(e.horizontalTaskLayout),t.sidebar.$container=t.verticalSplitter.$left,t.sidebar.$container.addClass("sidebar-container"),t.personsComponent.$main=t.$main,l.all([t.personsComponent.triggerInit(),t.notifications.triggerInit()])})).then((function(){return t.calendarsSplitter.$container=t.$calendars,t.calendarsSplitter.triggerInit()})).then((function(){return t.calendarsSplitter.$left.append(t.$calendar1),t.calendarsSplitter.$right.append(t.$calendar2),t.sidebar.$container.on("click",t.onSidebarClick.bind(t)),t.sidebar.triggerInit()})).then((function(){t.verticalSplitter.$handle.on("mousedown",(function(){t.setFirstPanelResizable(!0)})),t.verticalSplitter2.$handle.on("mousedown",(function(){t.setFirstPanelResizable(!1)}))})).then((function(){t.$main.focus(),t.grabFocus(),t.personTooltip.init(t.sidebar.$container),t.personsComponent.refreshAvatars(),t.makeCustomScroll(t.verticalSplitter.$left.find(".sidebar")),t.initializedDeferred.resolve()})).then((function(){t.$disabledSectionContainer=c("<div class='disabled-section hidden'></div>"),t.verticalSplitter.$right.append(t.$disabledSectionContainer),t.disabledSection.$container=t.$disabledSectionContainer,t.disabledSection.triggerInit()})).then((function(){return t.previewPanel.$container=t.$preview,t.previewPanel.triggerInit()})).then((function(){return t.sectionTooltip.refreshAvatars=t.personsComponent.refreshAvatars.bind(t.personsComponent),t.sidebar.usersListTooltip.refreshAvatars=t.personsComponent.refreshAvatars.bind(t.personsComponent),t.sectionTooltip.$container=t.$main,t.sectionTooltip.triggerInit()})).then((function(){t.changeTaskPreviewPanelVisibility(t._showPreviewPanel),t.updatePreviewLocation(t._horizontalTaskLayout),t.calendarsSplitter.updateRelativeHandlePosition()})).then((function(){var e=c("<div class='common-datepicker-container'></div>");return t.$body.find(".calendars").append(e),t.datePicker.$container=e,t.datePicker.triggerInit()}))},t.prototype.checkInit=function(){return this.initializedDeferred.promise},t.prototype.setModel=function(e){this._showPreviewPanel=e.showTaskPreviewPanel,this._horizontalTaskLayout=e.horizontalTaskLayout},t.prototype.onSearchChanged=function(e,t){t&&this.personsComponent.refreshAvatars(),this.$main.toggleClass("search-on",e),this.sidebar.refreshInfoTooltips()},t.prototype.toggleDisabledSection=function(e){this.verticalSplitter.$right.children(".calendar-container").toggleClass("hidden",e),this.$disabledSectionContainer.toggleClass("hidden",!e)},t.prototype.setFirstPanelResizable=function(e){if(this.calendarsSplitter.flip!=e){this.calendarsSplitter.flip=e;var t=this.calendarsSplitter.flip?this.calendarsSplitter.relativeHandlePosition+10:this.calendarsSplitter.$component.outerWidth()-this.calendarsSplitter.relativeHandlePosition-10;t=Math.max(t,"function"==typeof this.calendarsSplitter.firstPanelMinSize?this.calendarsSplitter.firstPanelMinSize():this.calendarsSplitter.firstPanelMinSize),this.calendarsSplitter.setFirstElementSize(t)}},t.prototype.fixPanelsArrangement=function(){},t.prototype.enableDayPreviewPanel=function(){this._showDayPreviewPanel=!0,this.$calendars.removeClass("one-calendar"),this.$calendars.addClass("two-calendars"),this.updateCalendar1HeaderRight(),this.fixPanelsArrangement(),this.ensureCorrectPanelIsFocused(),this.updateCalendarPanelsVisibility(2)},t.prototype.hideDayPreviewPanel=function(){this._showDayPreviewPanel=!1,this.$calendars.addClass("one-calendar"),this.$calendars.removeClass("two-calendars"),this.$calendar1.find(".mode").css("width","auto").css("width","100%"),this.updateCalendar1HeaderRight(),this.ensureCorrectPanelIsFocused(),this.updateCalendarPanelsVisibility(2)},t.prototype.changeDayPreviewPanelVisibility=function(e){this._showDayPreviewPanel!=e&&(e?this.enableDayPreviewPanel():this.hideDayPreviewPanel(),this.ensureCorrectPanelSizes())},t.prototype.showTaskPreviewPanel=function(){this._showPreviewPanel=!0;var e=this.$calendar1.closest(".component-splitter-panel-top");e.addClass("show-task-preview-panel"),e.removeClass("hide-task-preview-panel"),e.closest(".component-splitter-panel-left").addClass("show-task-preview-panel"),e.closest(".component-splitter-panel-left").removeClass("hide-task-preview-panel"),this.fixPanelsArrangement(),this.ensureCorrectPanelIsFocused()},t.prototype.hideTaskPreviewPanel=function(){this._showPreviewPanel=!1;var e=this.$calendar1.closest(".component-splitter-panel-top");e.removeClass("show-task-preview-panel"),e.addClass("hide-task-preview-panel"),e.closest(".component-splitter-panel-left").removeClass("show-task-preview-panel"),e.closest(".component-splitter-panel-left").addClass("hide-task-preview-panel"),this.ensureCorrectPanelIsFocused()},t.prototype.changeTaskPreviewPanelVisibility=function(e){e?this.showTaskPreviewPanel():this.hideTaskPreviewPanel()},t.prototype.updatePreviewLocation=function(e){var t=this.$calendar1.closest(".component-splitter-panel-top"),n=t.closest(".component-splitter-panel-left");t.toggleClass("show-preview",e),t.toggleClass("hide-preview",!e),n.toggleClass("show-preview",!e),n.toggleClass("hide-preview",e),e?this.horizontalSplitter.$bottom.append(this.$preview):this.verticalSplitter2.$right.append(this.$preview),this.fixPanelsArrangement()},t.prototype.updateCalendar1HeaderRight=function(){},t.prototype.ensureCorrectPanelSizes=function(e){if(void 0===e&&(e=!1),this.calendarsSplitter.$component.is(":visible")){var t=this.calendarsSplitter.flip?this.calendarsSplitter.$component.outerWidth()-this.calendarsSplitter.relativeHandlePosition-10:this.calendarsSplitter.relativeHandlePosition+10;e&&(t=this.calendarsSplitter.flip?this.calendarsSplitter.relativeHandlePosition+10:this.calendarsSplitter.$component.outerWidth()-this.calendarsSplitter.relativeHandlePosition-10),t=Math.max(t,"function"==typeof this.calendarsSplitter.firstPanelMinSize?this.calendarsSplitter.firstPanelMinSize():this.calendarsSplitter.firstPanelMinSize),this.calendarsSplitter.setFirstElementSize(t)}else this.pendingEnsureCorrectPanelSizes=!0},t.prototype.setIsCalendarTabOpen=function(e){this.pendingEnsureCorrectPanelSizes&&e&&(this.pendingEnsureCorrectPanelSizes=!1,this.ensureCorrectPanelSizes(!0))},t.prototype.updateCalendarPanelsVisibility=function(e){if(void 0===e&&(e=null),2!==e){var t=this.getCalendarPanelKey(this.activeProjectHostHash1,this.activeProjectId1);for(var n in this.calendar1Panels){this.calendar1Panels[n].setIsVisible(n==t,"left")}}if(1!==e){t=this.getCalendarPanelKey(this.activeProjectHostHash2,this.activeProjectId2);for(var n in this.calendar2Panels){this.calendar2Panels[n].setIsVisible(this._showDayPreviewPanel&&n==t,"right")}}},t.prototype.bindKeyboardEvents=function(){c(document).on("keydown",this.keyboardHandler.bind(this))},t.prototype.keyboardHandler=function(e){if("ArrowLeft"!=e.key&&"ArrowRight"!=e.key||!e.altKey||!e.ctrlKey&&!e.metaKey||(e.preventDefault(),e.stopImmediatePropagation(),this.triggerEvent("history"+e.key)),"Tab"==e.key)if(e.ctrlKey||e.metaKey){e.preventDefault(),e.stopImmediatePropagation();var t=new KeyboardEvent("keydown",{key:"Tab",keyCode:9,ctrlKey:!0,shiftKey:e.shiftKey,bubbles:!0});parent.frameElement.contentDocument.dispatchEvent(t)}else e.preventDefault(),e.shiftKey?this.focusPrevPanel():this.focusNextPanel();else("r"==e.key&&e.ctrlKey||"F5"==e.key)&&(e.preventDefault(),this.triggerEvent("refresh"))},t.prototype.focusNextPanel=function(){this.switchToPanel(this.activePanelId+1,!0,1)},t.prototype.focusPrevPanel=function(){this.switchToPanel(this.activePanelId-1,!0,-1)},t.prototype.switchToPanel=function(e,t,n){var i=(e+4)%4;this.$main.find(".focus-highlight").remove();var a=c('<div class="focus-highlight"></div>'),s=this.activePanelId;this.activePanelId=i<0?i+4:i;for(var o=0;o<4;++o)(2==this.activePanelId&&!this._showDayPreviewPanel||3==this.activePanelId&&!this._showPreviewPanel)&&(this.activePanelId=(this.activePanelId+n+4)%4);if(t&&s!=this.activePanelId){var r=c(),l=c();0==this.activePanelId?r=(l=this.$main.find(".sidebar-container")).children(".sidebar").first():1==this.activePanelId?l=(r=this.$calendar1.children(".calendarpanel-container.active")).children(".panel"):2==this.activePanelId?l=(r=this.$calendar2.children(".calendarpanel-container.active")).children(".panel"):3==this.activePanelId&&(l=r=this.$preview.children(".component-task-panel-main")),a.insertAfter(r),l.focus()}setTimeout((function(){a.remove()}),500)},t.prototype.ensureCorrectPanelIsFocused=function(){this.switchToPanel(this.activePanelId,!1,1)},t.prototype.grabFocus=function(e){void 0===e&&(e=!0);var t=this.activePanelId;this.activePanelId=0==t?t+1:t-1,this.switchToPanel(t,e,0==t?1:-1)},t.prototype.onSidebarClick=function(){this.switchToPanel(0,!1,0)},t.prototype.onCalendar1PanelClick=function(){this.switchToPanel(1,!1,0)},t.prototype.onCalendar2PanelClick=function(){this.switchToPanel(2,!1,0)},t.prototype.onPreviewPanelClick=function(){this.switchToPanel(3,!1,0)},t.prototype.onCloseDayPreviewClick=function(){this.triggerEvent("closeDayPreview")},t.prototype.createCalendar1Panel=function(e,t){var n=this.getCalendarPanelKey(e,t);if(n in this.calendar1Panels)return this.calendar1Panels[n];var i=this.addComponent("calendar1Panel-"+n,new d.CalendarPanelView(this,this.personsComponent)),a=c("<div class='calendarpanel-container' data-id='"+t+"' data-host-hash='"+e+"'></div>");this.$calendar1.append(a),i.$container=a,i.triggerInit(),this.calendar1Panels[n]=i},t.prototype.openCalendar1Panel=function(e,t){var n=!1;null!=this.activeProjectId1&&this.activeProjectId1!=t&&(n=!0),this.activeProjectId1=t,this.activeProjectHostHash1=e;var i=this.$calendar1.find(".calendarpanel-container"),a=i.filter("[data-id='"+t+"'][data-host-hash='"+e+"']");i.removeClass("active"),a.addClass("active"),this.$main.find(".panels").children().children(".component-splitter-panel-right").toggleClass("hidden",0==this.$main.find(".calendarpanel-container.active").length),n&&this.flashCustomSelects(a),this.updateCalendarPanelsVisibility(1)},t.prototype.createCalendar2Panel=function(e,t){var n=this.getCalendarPanelKey(e,t);if(n in this.calendar2Panels)return this.calendar2Panels[n];var i=this.addComponent("calendar2Panel-"+n,new d.CalendarPanelView(this,this.personsComponent)),a=c("<div class='calendarpanel-container' data-id='"+t+"' data-host-hash='"+e+"'></div>");this.$calendar2.append(a),i.$container=a,i.triggerInit(),this.calendar2Panels[n]=i},t.prototype.openCalendar2Panel=function(e,t){this.activeProjectId2=t,this.activeProjectHostHash2=e;var n=this.$calendar2.find(".calendarpanel-container"),i=n.filter("[data-id='"+t+"'][data-host-hash='"+e+"']");n.removeClass("active"),i.addClass("active"),this.$main.find(".panels").children().children(".component-splitter-panel-right").toggleClass("hidden",0==this.$main.find(".calendarpanel-container.active").length),this.updateCalendarPanelsVisibility(2)},t.prototype.flashCustomSelects=function(e){if(e&&e.length>0){var t=e.find(".top .component-custom-select-main, .top .prev-btn, .top .next-btn, .top .today-btn");t.removeClass("fadeInOut"),setTimeout((function(){t.addClass("fadeInOut")}),0)}},t.prototype.expandRemoteSectionsList=function(e,t){var n,i=this;this.isRemoteHostVisible(t)?this.toggleRemoteHost(t,!1):(this.sidebar.showHostLoading(t,!1),l().then((function(){if(i.remoteServers||(i.remoteServers={}),!(t in i.remoteServers))return n=i.$main.find(".host-element[data-host-id='"+t+"']"),i.remoteListsExists(t)?void 0:l().then((function(){n.parent().append(c("<div class='remote-sections' data-host-id='"+t+"'></div>")),n.parent().append(c("<div class='remote-conversations' data-host-id='"+t+"'></div>"));var a={host:e,sectionsList:i.addComponent("remoteSectionsList-"+t,new o.component.remotesectionlist.RemoteSectionListView(i,{extList:{template:null}})),conv2List:i.addComponent("remoteConv2List-"+t,new o.component.remoteconv2list.RemoteConv2ListView(i,{personsView:i.personsComponent,extList:{template:null}}))};return a.sectionsList.sections.$container=n.parent().find(".remote-sections[data-host-id='"+t+"']"),a.conv2List.conversations.$container=n.parent().find(".remote-conversations[data-host-id='"+t+"']"),i.sidebar.remoteSectionLists[t]=a.sectionsList,i.sidebar.remoteConv2Lists[t]=a.conv2List,a.conv2List.conversations.$container.addClass("with-assigned-to-prefixes"),i.remoteServers[t]=a,l.all([a.sectionsList.triggerInit(),a.conv2List.triggerInit()])}))})).then((function(){i.toggleRemoteHost(t,!0)})))},t.prototype.toggleRemoteHost=function(e,t){var n=this.$main.find(".host-element[data-host-id='"+e+"']");n.parent().find(".remote-sections[data-host-id='"+e+"']").toggleClass("hide",!t),n.parent().find(".remote-conversations[data-host-id='"+e+"']").toggleClass("hide",!t),this.sidebar.hostList.toggleHostElementIsExpanded(e,t)},t.prototype.isRemoteHostVisible=function(e){return!this.$main.find(".host-element[data-host-id='"+e+"']").find(".fa.expanded").hasClass("hide")},t.prototype.remoteListsExists=function(e){return this.$main.find(".host-element[data-host-id='"+e+"']").parent().find(".remote-sections[data-host-id='"+e+"']").length>0},t.prototype.getCalendarPanelKey=function(e,t){return e+"--"+t},t.SIDEBAR_MIN_WIDTH=100,t.CALENDAR1_MIN_WIDTH=340,t.CALENDAR1_MIN_HEIGHT=100,t.CALENDAR2_MIN_WIDTH=100,t.CALENDAR2_MIN_HEIGHT=100,t.PREVIEW_MIN_WIDTH=100,t.PREVIEW_MIN_HEIGHT=50,t}(o.window.base.BaseWindowView);n.CalendarWindowView=u,u.prototype.className="com.privmx.plugin.calendar.window.calendar.CalendarWindowView"},{"../../component/calendarPanel/CalendarPanelView":3,"../../component/datePicker/DatePickerView":17,"./template/main.html":24,"pmc-web":27,"resize-observer-polyfill":1}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.func={helper:"com.privmx.core.web-utils.MailClientViewHelper",func:function(e,t,n){var i="";return i+='<div class="calendar-plugin">\n  <div class="panels">\n    <div class="panel-sidebar">\n      \n    </div>\n    <div class="panel-calendar1">\n      \n    </div>\n    <div class="panel-calendar2">\n        <div class="close-day-preview-btn">\n          <i class="fa fa-times"></i>\n        </div>\n      \n    </div>\n    <div class="panel-preview">\n      \n    </div>\n  </div>\n</div>'}}},{}],25:[function(e,t,n){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=e("pmc-web"),o=e("./template/main.html"),r=function(e){function t(t){return e.call(this,t,o.func)||this}return a(t,e),t.prototype.openIframe=function(e,t){s.Starter.registerDockedWindow(e,t,this.$mainContainer[0]).setAttribute("id","iframe-"+e)},t}(s.window.base.BaseAppWindowView);n.MainWindowView=r,r.prototype.className="com.privmx.plugin.calendar.window.main.MainWindowView"},{"./template/main.html":26,"pmc-web":27}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.func={helper:"com.privmx.core.web-utils.MailClientViewHelper",func:function(e,t,n){var i="";return i+='<div class="window-main">\n  <div class="app-nav-bar"></div>\n  <div class="app-main-container">\n  </div>\n</div>\n    '}}},{}],27:[function(e,t,n){var i=privmxViewRequire("privmx-view");t.exports=i},{}]},{},[2]);
//# sourceMappingURL=view.js.map
