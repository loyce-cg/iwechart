!function e(t,i,n){function a(o,d){if(!i[o]){if(!t[o]){var r="function"==typeof require&&require;if(!d&&r)return r(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[o]={exports:{}};t[o][0].call(c.exports,(function(e){return a(t[o][1][e]||e)}),c,c.exports,e,t,i,n)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,i){var n=privmxViewRequire("privmx-view");t.exports=n},{}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../window/apps/AppsWindowView");e("pmc-web").Starter.objectFactory.register(n.AppsWindowView)},{"../window/apps/AppsWindowView":3,"pmc-web":1}],3:[function(e,t,i){"use strict";var n,a=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var s=e("pmc-web"),o=e("./template/main.html"),d=e("./template/section.html"),r=function(e){function t(t){var i=e.call(this,t,o.func)||this;i.userGuideVisible=!1,i.loadedModules={},i.scheduledModules={},i._delayedClickTimeout=null,i._nextSpinnerRemoval=s.Q(),i.loadedModules.chat=!1,i.loadedModules.notes2=!1,i.loadedModules.tasks=!1,i.loadedModules.calendar=!1;var n=new s.webUtils.VisibilityObserver(document.body),a=!1;return i.sectionList=i.addComponent("sectionList",new s.component.extlist.ExtListView(i,{template:d.func,onAfterListRender:function(){if(n.isTargetVisible)i.updateSplitSectionsNames();else if(!a)return n.addSingleShotCallback((function(e){a=!1,e&&i.updateSplitSectionsNames()})),void(a=!0)}})),i.basicTooltip=i.addComponent("basicTooltip",new s.component.tooltip.TooltipView(i)),i}return a(t,e),t.prototype.initWindow=function(e){var i=this;s.JQuery(window).on("resize",this.onResizeWindow.bind(this)),this.$main.on("click","[data-trigger]",this.onTriggerClick.bind(this)),this.$main.on("click","[data-section-id]",this.onSectionClick.bind(this)),this.makeCustomScroll(this.$main.find(".sections")),this.sectionList.$container=this.$main.find(".sections-inner"),this.$main.find(".sections").css("height",t.MAX_SECTIONS_CONTAINER_HEIGHT+"px"),this.$loadingUnread=this.$main.find(".loading-unread-counts");var n=this.$main.find(".launchers");return n.on("click",".number.badge",this.onBadgeClick.bind(this)),n.on("dblclick",".number.badge",this.onBadgeDoubleClick.bind(this)),n.on("mouseenter",".number.badge",this.onBadgeMouseEnter.bind(this)),n.on("mouseleave",".number.badge",this.onBadgeMouseLeave.bind(this)),e.chatFullyLoaded?this.setAppWindowBadgeFullyLoaded("chat",!0):this.updateSpinners(null,"chat",!0),e.notes2FullyLoaded?this.setAppWindowBadgeFullyLoaded("notes2",!0):this.updateSpinners(null,"notes2",!0),e.tasksFullyLoaded?this.setAppWindowBadgeFullyLoaded("tasks",!0):this.updateSpinners(null,"tasks",!0),e.calendarFullyLoaded?this.setAppWindowBadgeFullyLoaded("calendar",!0):this.updateSpinners(null,"calendar",!0),this.sectionList.triggerInit().then((function(){return i.basicTooltip.$container=i.$main,i.basicTooltip.isEnabled=function(e){return"ignore"!=s.JQuery(document.body).attr("data-unread-badge-click-action")},i.basicTooltip.triggerInit()}))},t.prototype.onTriggerClick=function(e){var i=this;this.clearDelayedClickTimeout();var n=s.JQuery(e.currentTarget),a=n.data("trigger");if("launch-app-window"==a){var o=this.$body.attr("data-unread-badge-click-action"),d="true"==s.JQuery(document.body).attr("data-unread-badge-use-double-click");"ignore"==o||0==s.JQuery(e.target).closest(".number.badge").length?this.triggerEvent("appWindowOpen",n.data("app-window")):d&&(this._delayedClickTimeout=setTimeout((function(){i.triggerEvent("appWindowOpen",n.data("app-window"))}),t.SINGLE_CLICK_DELAY))}else this.navBar.triggerCustomAction(a,e)},t.prototype.onSectionClick=function(e){var i=this;this.clearDelayedClickTimeout();var n=s.JQuery(e.target).closest("[data-section-id]"),a=this.$body.attr("data-unread-badge-click-action"),o="true"==s.JQuery(document.body).attr("data-unread-badge-use-double-click");"ignore"!=a&&s.JQuery(e.target).closest(".number.badge").length>0?o&&(this._delayedClickTimeout=setTimeout((function(){i.triggerEvent("sectionClick",n.data("section-id"))}),t.SINGLE_CLICK_DELAY)):this.triggerEvent("sectionClick",n.data("section-id"))},t.prototype.setAppWindowBadge=function(e,t){var i=this.$main.find(".app-launcher[data-app-window='"+e+"'] .badge");this.setBadge(i,t)},t.prototype.scheduleSetAppWindowBadgeFullyLoaded=function(e,i){var n=this;i?this.scheduledModules[e]||(this.scheduledModules[e]=!0,this._nextSpinnerRemoval=this._nextSpinnerRemoval.then((function(){n.setAppWindowBadgeFullyLoaded(e,i);var a=s.Q.defer();return setTimeout((function(){a.resolve()}),t.MIN_TIME_BETWEEN_LOADING_SPINNERS_REMOVAL),a.promise}))):this.setAppWindowBadgeFullyLoaded(e,i)},t.prototype.setAppWindowBadgeFullyLoaded=function(e,t){var i=this;this.loadedModules[e]!=t&&(this.loadedModules[e]=t,this.updateSpinners(null,e,!t,!0));var n=!0;for(var a in this.loadedModules)if(!this.loadedModules[a])return void(n=!1);n&&(s.JQuery.when(this.$loadingUnread.fadeOut(500)).done((function(){i.$loadingUnread.children().remove()})),this.setAllSpinnersHidden(!0))},t.prototype.setBadge=function(e,t){t?e.text(t).addClass("visible"):e.removeClass("visible")},t.prototype.updateSplitSectionsNames=function(){var e={wordBreak:{isEnabled:!0,minWordLength:6,minPrefixLength:3,minSuffixLength:3}},t=new s.webUtils.ellipsis.Ellipsis(e),i=new s.webUtils.ellipsis.Ellipsis(e);this.$main.find(".sections .wi-element-name").each((function(e,n){var a=s.JQuery(n);a.find(".section-breadcrumb").remove();var o=a.data("breadcrumb").trim(),d=a.data("section-name").trim(),r=[];o.length>0&&r.push({text:o+" ",textToHtml:function(e){return'<span class="section-breadcrumb">'+e+"</span>"}}),d.length>0&&r.push({text:d,textToHtml:function(e){return e}}),(a.hasClass("bold")?i:t).apply(a,r)}))},t.prototype.getFilesPos=function(){var e=this.$main.find(".app-launcher[data-app-window=notes2]")[0].getBoundingClientRect();return{x:e.x+e.width/2,y:e.y+e.height/2}},t.prototype.showFilesUserGuide=function(){var e=this;s.Q().then((function(){return e.userGuide=e.addComponent("userguide",new s.component.userguide.UserGuideView(e)),e.$main.append(s.JQuery('<div class="user-guide-container"></div>')),e.userGuide.$container=e.$main.find(".user-guide-container"),e.userGuide.triggerInit()})).then((function(){e.userGuideVisible=!0}))},t.prototype.closeFilesUserGuide=function(){this.userGuideVisible=!1,this.$main.find(".user-guide-container").remove()},t.prototype.onResizeWindow=function(){var e=this;null==this.resizeDebounceTimer&&this.userGuideVisible&&(this.resizeDebounceTimer=setTimeout((function(){clearTimeout(e.resizeDebounceTimer),e.resizeDebounceTimer=null,e.userGuide.updatePos(e.getFilesPos().x,e.getFilesPos().y)}),50))},t.prototype.onBadgeClick=function(e){"true"==s.JQuery(document.body).attr("data-unread-badge-use-double-click")||this.handleBadgeSingleOrDoubleClick(e)},t.prototype.onBadgeDoubleClick=function(e){"true"==s.JQuery(document.body).attr("data-unread-badge-use-double-click")&&this.handleBadgeSingleOrDoubleClick(e)},t.prototype.handleBadgeSingleOrDoubleClick=function(e){this.clearDelayedClickTimeout();var t=s.JQuery(e.target).closest("[data-app-window]").data("app-window"),i=s.JQuery(e.target).closest("[data-section-id]").data("section-id");t&&["chat","notes2","tasks"].indexOf(t)>=0?this.triggerEvent("moduleBadgeClick",t):i&&this.triggerEvent("sectionBadgeClick",i)},t.prototype.onBadgeMouseEnter=function(e){this.toggleBadgeParentHover(e,!0)},t.prototype.onBadgeMouseLeave=function(e){this.toggleBadgeParentHover(e,!1)},t.prototype.toggleBadgeParentHover=function(e,t){s.JQuery(e.target).closest("[data-app-window], [data-section-id]").toggleClass("with-badge-hover",t)},t.prototype.clearDelayedClickTimeout=function(){this._delayedClickTimeout&&(clearTimeout(this._delayedClickTimeout),this._delayedClickTimeout=null)},t.prototype.updateSpinners=function(e,t,i,n){var a=this;void 0===n&&(n=!1);var o,d=[];if(e&&(o=this.$main.find('.wi-element[data-section-id="'+e+'"]').find(".wi-element-badge.number"),d.push({$badge:o,width:i?(o.outerWidth()||0).toString():"initial",state:i}),this.$main.find('.app-launcher[data-trigger="launch-app-window"]').each((function(e,t){if((o=s.JQuery(t).find(".number.badge")).length>0){var n=!a.loadedModules[s.JQuery(t).data("app-window")]||i;d.push({$badge:o,width:n?(o.outerWidth()||0).toString():"initial",state:n})}}))),t){o=this.$main.find('.app-launcher[data-trigger="launch-app-window"][data-app-window="'+t+'"]').find(".number.badge");var r=!this.loadedModules[t]||i;d.push({$badge:o,width:r?(o.outerWidth()||0).toString():"initial",state:r}),this.$main.find(".wi-element[data-section-id]").each((function(e,t){(o=s.JQuery(t).find(".wi-element-badge.number")).length>0&&d.push({$badge:o,width:i?(o.outerWidth()||0).toString():"initial",state:i})}))}for(var l=0,c=d;l<c.length;l++){var u=c[l];if(u.$badge.css("width",u.width).toggleClass("with-spinner",u.state),u.state&&!u.$badge.hasClass("visible")&&u.$badge.addClass("visible"),!u.state&&n)0==(u.$badge[0]&&parseInt(u.$badge[0].textContent.trim())||0)&&u.$badge.removeClass("visible")}},t.prototype.setAllSpinnersHidden=function(e){this.triggerEvent("setAllSpinnersHidden",e)},t.prototype.updateStatistics=function(e,t,i){var n=this.$main.find(".modules-statistics"),a=n.find(".chat-count"),o=n.find(".tasks-count"),d=n.find(".notes2-count");a.text(e?s.webUtils.NumberFormatter.formatSimpleWithSuffix(e):"-"),o.text(t?s.webUtils.NumberFormatter.formatSimpleWithSuffix(t):"-"),d.text(i?s.webUtils.NumberFormatter.formatSimpleWithSuffix(i):"-"),n.fadeIn(500)},t.SINGLE_CLICK_DELAY=300,t.MIN_TIME_BETWEEN_LOADING_SPINNERS_REMOVAL=300,t.MAX_SECTIONS_CONTAINER_HEIGHT=240,t}(s.window.base.BaseAppWindowView);i.AppsWindowView=r,r.prototype.className="com.privmx.plugin.apps.window.apps.AppsWindowView"},{"./template/main.html":4,"./template/section.html":5,"pmc-web":1}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.func={helper:"com.privmx.core.web-utils.MailClientViewHelper",func:function(e,t,i){var n="",a=function(e){n+=e};return a('\n<div class="window-apps-main unselectable">\n  <div class="app-nav-bar"></div>\n  <div class="launchers">\n    <div class="inner">\n      <div class="inner2">\n        '),e.instanceName&&(a('\n          <div class="instance-name">\n            '),a(i.escapeHtml(e.instanceName)),a("\n          </div>\n        ")),a('\n        <div class="loading-unread-counts"><i class="fa fa-circle-o-notch fa-spin"></i></div>\n        <div class="launchers-container">\n          '),e.appWindows.forEach((function(e){var t,n;a('\n            <div class="app-launcher app-launcher-app-window" data-trigger="'),a(i.escapeHtml(e.action||"launch-app-window")),a('" data-app-window="'),a(i.escapeHtml(e.id)),a('">\n              '),0==e.icon.indexOf("fa")?(a('\n                <i class="fa '),a(i.escapeHtml(e.icon)),a('"></i>\n              ')):0==e.icon.indexOf("privmx-icon-")?(a('\n                <i class="privmx-icon '),a(i.escapeHtml(e.icon)),a('"></i>\n              ')):(a('\n                <span class="'),a(i.escapeHtml(e.icon)),a('"></span>\n              ')),a("\n              <h2><span>"),a(i.escapeHtml(e.label)),a("</span></h2>\n              "),t=e.count,n=e.id,a('\n    <span class="number badge '),a(i.escapeHtml(t>0?"visible":"")),a(' has-basic-tooltip" data-basic-id="'),a(i.escapeHtml(n)),a('">'),a(i.escapeHtml(t>0?t.toString():"")),a("</span>\n  "),a("\n            </div>\n          ")})),a('\n        </div>\n        <div class="stats-container">\n          <div class="modules-statistics">\n            <span class="item chat">'),a(i.escapeHtml(i.i18n("plugin.apps.window.apps.statistics.chat"))),a(':<span class="count chat-count"></span></span>\n            <span class="item notes2">'),a(i.escapeHtml(i.i18n("plugin.apps.window.apps.statistics.notes2"))),a(':<span class="count notes2-count"></span></span>\n            <span class="item tasks">'),a(i.escapeHtml(i.i18n("plugin.apps.window.apps.statistics.tasks"))),a(':<span class="count tasks-count"></span></span>\n          </div>  \n        </div>\n        <div class="sections">\n          <div class="sections-inner"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n  '),e.isElectron&&(a('\n    <div class="version-info">PrivMX Desktop version: '),a(i.escapeHtml(e.appVersion)),a("</div>\n  ")),a("\n</div>\n"),n}}},{}],5:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.func={helper:"com.privmx.core.web-utils.MailClientViewHelper",func:function(e,t,i){var n="",a=function(e){n+=e};return a('<div class="wi-element" data-section-id="'),a(i.escapeHtml(e.id)),a('" title="'),a(i.escapeHtml((e.breadcrumb?e.breadcrumb:"")+e.name)),a('">\n  <div class="wi-element-inner">\n    <div class="pin-button '),a(i.escapeHtml(e.pinned?"pinned":"not-pinned")),a('">\n      <i class="fa fa-thumb-tack"></i>\n    </div>\n    '),e.private?(a('\n      <div class="wi-element-icon bckg-icon bckg-icon-border">\n        <img src="'),a(i.escapeHtml(i.getAssetByName("DEFAULT_PRIVMX_ICON"))),a('" />\n      </div>\n    ')):(a('\n      <div class="wi-element-icon bckg-icon">\n        <img src="'),a(i.escapeHtml(i.getAssetByName("DEFAULT_PRIVMX_ICON"))),a('" />\n      </div>\n    ')),a('\n    <div class="wi-element-name '),a(i.escapeHtml(e.primary?"bold":"")),a('" data-max-lines="2" data-breadcrumb="'),a(i.escapeHtml(e.breadcrumb)),a('" data-section-name="'),a(i.escapeHtml(e.name)),a('">\n      '),e.breadcrumb.length>0&&(a('\n        <span class="section-breadcrumb">'),a(e.breadcrumb),a("</span>\n      ")),a("\n      "),a(i.escapeHtml(e.name)),a("\n    </div>\n  </div>\n</div>"),n}}},{}]},{},[2]);
//# sourceMappingURL=view.js.map
