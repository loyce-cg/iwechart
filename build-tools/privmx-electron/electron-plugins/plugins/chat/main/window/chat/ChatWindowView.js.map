{"version":3,"sources":["window/chat/ChatWindowView.ts"],"names":[],"mappings":"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","file":"ChatWindowView.js","sourcesContent":["import {component, webUtils, window as wnd, Q, JQuery as $, Types, Logger as RootLogger} from \"pmc-web\";\nimport {ChatMessagesView} from \"../../component/chatmessages/ChatMessagesView\";\nimport {func as mainTemplate} from \"./template/main.html\";\nimport {Model, ActiveElementInfo} from \"./ChatWindowController\";\nimport { PrivateConversationsView } from \"../../component/privateconversations/PrivateConversationsView\";\nimport { NoSectionsView } from \"../../component/nosections/NoSectionsView\";\nlet Logger = RootLogger.get(\"chat-plugin.window.chat.ChatWindowView\");\n\nexport enum FocusedElement {\n    SIDEBAR,\n    MESSAGES\n}\n\nexport interface HostEntryModel {\n    host: string;\n    sectionsList: component.remotesectionlist.RemoteSectionListView;\n    conv2List: component.remoteconv2list.RemoteConv2ListView;\n}\n\nexport class ChatWindowView extends wnd.base.BaseAppWindowView<Model> {\n    \n    static readonly SIDEBAR_MIN_WIDTH = 100;\n    static readonly MESSAGESLIST_MIN_WIDTH = 400;\n    static readonly PREVIEW_MIN_WIDTH = 200;\n    \n    sidebar: component.sidebar.SidebarView;\n    loading: component.loading.LoadingView;\n    sectionsSplitter: component.splitter.SplitterView;\n    previewSplitter: component.splitter.SplitterView;\n    // videoConference: VideoConferenceView;\n    messages: {[id: string]: ChatMessagesView};\n    remoteServers: {[hostHash: string]: HostEntryModel};\n    active: ChatMessagesView | PrivateConversationsView | component.disabledsection.DisabledSectionView | NoSectionsView;\n    personsComponent: component.persons.PersonsView;\n    personTooltip: component.persontooltip.PersonTooltipView;\n    isCtrlKeyDown: boolean = false;\n    dragDrop: component.dragdrop.DragDrop;\n    lastAction: ActiveElementInfo;\n    $chatMessagesContainer: JQuery;\n    privateConversations: PrivateConversationsView;\n    noSections: NoSectionsView;\n    $privateConversationsContainer: JQuery;\n    $noSectionsContainer: JQuery;\n\n    disabledSection: component.disabledsection.DisabledSectionView;\n    $disabledSectionContainer: JQuery;\n\n    isSearchOn: boolean = false;\n    sectionTooltip: component.sectiontooltip.SectionTooltipView;\n    userActionTimer: any;\n    \n    constructor(parent: Types.app.ViewParent) {\n        super(parent, mainTemplate);\n        \n        this.sectionsSplitter = this.addComponent(\"sectionsSplitter\", new component.splitter.SplitterView(this, {\n            firstPanelMinSize: ChatWindowView.SIDEBAR_MIN_WIDTH,\n            secondPanelMinSize: () => {\n                return ChatWindowView.MESSAGESLIST_MIN_WIDTH\n            },\n            type: \"vertical\",\n            handlePlacement: \"right\",\n            handleDot: true,\n        }));\n        this.previewSplitter = this.addComponent(\"previewSplitter\", new component.splitter.SplitterView(this, {\n            firstPanelMinSize: ChatWindowView.MESSAGESLIST_MIN_WIDTH,\n            secondPanelMinSize: () => {\n                return ChatWindowView.PREVIEW_MIN_WIDTH\n            },\n            type: \"vertical\",\n            handlePlacement: \"right\",\n            handleDot: true,\n            flip: true,\n        }));\n        this.personsComponent = this.addComponent(\"personsComponent\", new component.persons.PersonsView(this, this.helper));\n        // this.videoConference = this.addComponent(\"videoConference\", new VideoConferenceView(this, this.personsComponent));\n        this.personTooltip = new component.persontooltip.PersonTooltipView(this.templateManager, this.personsComponent);\n        this.messages = {};\n        this.sidebar = this.addComponent(\"sidebar\", new component.sidebar.SidebarView(this, {\n            conv2List: {\n                personsView: this.personsComponent,\n                extList: {\n                    template: null\n                }\n            },\n            conv2Splitter: null,\n            customElementList: {\n                extList: {\n                    template: null\n                }\n            },\n            sectionList: {\n                extList: {\n                    template: null\n                }\n            },\n            customSectionList: {\n                extList: {\n                    template: null\n                }\n            }\n        }));\n        this.privateConversations = this.addComponent(\"private-conversations\", new PrivateConversationsView(this));\n        this.disabledSection = this.addComponent(\"disabled-section\", new component.disabledsection.DisabledSectionView(this));\n        this.noSections = this.addComponent(\"no-sections\", new NoSectionsView(this));\n\n        this.sectionTooltip = this.addComponent(\"sectiontooltip\", new component.sectiontooltip.SectionTooltipView(this));\n        this.loading = this.addComponent(\"loading\", new component.loading.LoadingView(this));\n    }\n    \n    initWindow(model: Model): Q.Promise<void> {\n        return Q().then(() => {\n            this.turnTimeAgoRefresher();\n            this.$body.on(\"mousemove click keydown\", this.onUserAction.bind(this));\n            this.$body.on(\"keydown\", this.onKeydown.bind(this));\n            this.$body.on(\"click\", \":not(.emoji-btn)\", this.hideEmojiPicker.bind(this));\n            $(window).on(\"resize\", this.onResize.bind(this));\n            this.personsComponent.$main = this.$main;\n            return this.personsComponent.triggerInit();\n        })\n        .then(() => {\n            this.sectionsSplitter.$container = this.$mainContainer;\n            return this.sectionsSplitter.triggerInit();\n        })\n        .then(() => {\n            this.previewSplitter.$container = this.sectionsSplitter.$right;\n            return this.previewSplitter.triggerInit();\n        })\n        .then(() => {\n            this.$chatMessagesContainer = $(\"<div class='section-chats'></div>\");\n            this.$privateConversationsContainer = $(\"<div class='messages-container private' style='\" + this.getDefaultHideStyle(false) + \"'></div>\");\n            this.$noSectionsContainer = $(\"<div class='messages-container no-sections' style='\" + this.getDefaultHideStyle(false) + \"'></div>\");\n            this.$disabledSectionContainer = $(\"<div class='messages-container disabled-section' style='\" + this.getDefaultHideStyle(false) + \"'></div>\");\n            this.$chatMessagesContainer.append(this.$privateConversationsContainer);\n            this.$chatMessagesContainer.append(this.$noSectionsContainer);\n            this.$chatMessagesContainer.append(this.$disabledSectionContainer);\n            this.sectionsSplitter.$left.addClass(\"sidebar-container\");\n            this.sectionsSplitter.$right.append(this.previewSplitter.$component);\n            this.previewSplitter.$component.addClass(\"preview-splitter\");\n            this.previewSplitter.$left.append(this.$chatMessagesContainer);\n            this.sidebar.$container = this.sectionsSplitter.$left;\n            return this.sidebar.triggerInit();\n        })\n        .then(() => {\n            this.privateConversations.$container = this.$privateConversationsContainer;\n            return this.privateConversations.triggerInit();\n        })\n        .then(() => {\n            // this.videoConference.$container = this.previewSplitter.$right;\n            // return this.videoConference.triggerInit();\n            this.noSections.$container = this.$noSectionsContainer;\n            return this.noSections.triggerInit();\n        })\n        .then(() => {\n            this.disabledSection.$container = this.$disabledSectionContainer;\n            return this.disabledSection.triggerInit();\n        })\n        .then(() => {\n            this.personTooltip.init(this.$main);\n            return this.activateMessages(model.activeElementInfo);\n        })\n        .then(() => {\n            this.loading.$container = this.$chatMessagesContainer;\n            return this.loading.triggerInit();\n        })\n        .then(() => {\n            this.personsComponent.refreshAvatars();\n            this.refreshFocus();\n\n            this.sectionTooltip.refreshAvatars = this.refreshAvatars.bind(this);\n            this.sidebar.usersListTooltip.refreshAvatars = this.refreshAvatars.bind(this);\n            this.sectionTooltip.$container = this.$main;\n            return this.sectionTooltip.triggerInit();\n        })\n\n    }\n    \n    refreshAvatars(): void {\n        this.personsComponent.refreshAvatars();\n    }\n    \n    getDefaultHideStyle(toggle: boolean): string {\n        const HIDE_TYPE: string = \"display\";\n        if (HIDE_TYPE == \"visibility\") {\n            return toggle ? \"visibility: visible\": \"visibility: hidden;\";\n        }\n        else\n        if (HIDE_TYPE == \"display\") {\n            return toggle ? \"display: block\" : \"display: none;\";\n        }\n    }\n    \n    toggleContainer($container:  JQuery<HTMLElement>, toggle: boolean): void {\n        const HIDE_TYPE: string = \"display\";\n        let value: string;\n        if (HIDE_TYPE == \"visibility\") {\n            value = toggle ? \"visible\": \"hidden\";\n        }\n        else\n        if (HIDE_TYPE == \"display\") {\n            value = toggle ? \"block\" : \"none\";\n        }\n        $container.css(HIDE_TYPE, value);\n    }\n    \n    openPrivateConversations(): void {\n        if (this.active) {\n            this.toggleContainer(this.active.$container, false);\n            this.active.onDeactivate();\n        }\n        this.active = this.privateConversations;\n        this.toggleContainer(this.active.$container, true);\n    }\n\n    openNoSections(): void {\n        if (this.active) {\n            this.toggleContainer(this.active.$container, false);\n            this.active.onDeactivate();\n        }\n        this.active = this.noSections;\n        this.toggleContainer(this.active.$container, true);\n    }\n\n\n    openDisabledSectionView(): void {\n        if (this.active) {\n            this.toggleContainer(this.active.$container, false);\n            this.active.onDeactivate();\n        }\n        this.active = this.disabledSection;\n        this.toggleContainer(this.active.$container, true);\n\n    }\n\n    \n    activateMessages(element: ActiveElementInfo): Q.Promise<void> {\n        this.loading.onStartLoading();\n        this.lastAction = element;\n        if (!element || !element.elementId) {\n            this.loading.hideLoading();\n            return;\n        }\n        let id = element.conversationId || element.channelId;\n        if (id == null) {\n            if (this.active) {\n                // this.active.$container.css(\"visibility\", \"hidden\");\n                this.toggleContainer(this.active.$container, false);\n                this.active.onDeactivate();\n                this.active = null;\n            }\n            return;\n        }\n        if (!(id in this.messages)) {\n            this.messages[id] = this.addComponent(id, new ChatMessagesView(this, this.personsComponent));\n            this.messages[id].userActionsEnabled = false;\n            this.messages[id].$container = $('<div class=\"messages-container chat-messages-component\" style=\"' + this.getDefaultHideStyle(false) + '\"></div>');\n            this.$chatMessagesContainer.append(this.messages[id].$container);\n        }\n        \n        return this.messages[id].triggerInit().then(() => {\n            if (this.lastAction != element) {\n                return;\n            }\n            if (this.active) {\n                // this.active.$container.css(\"visibility\", \"hidden\");\n                this.toggleContainer(this.active.$container, false);\n                this.active.onDeactivate();\n            }\n            this.active = this.messages[id];\n            this.dragDrop = new component.dragdrop.DragDrop(this, this.active.$container.find(\".chat\").parent().parent());\n            // this.active.$container.css(\"visibility\", \"visible\");\n            this.toggleContainer(this.active.$container, true);\n            \n            this.active.rewind();\n            this.active.updateSettinsMenu(element.guiSettings);\n            this.active.updateViewSettingsMenu(element.viewSettings);\n            this.active.onActivate();\n            this.refreshFocus();\n        })\n        .fail(e => {\n            Logger.error(\"Cannot create messsages\", e);\n        })\n        .fin(() => {\n            this.loading.hideLoading();\n        })\n    }\n    \n    onResize(): void {\n        this.sectionsSplitter.redraw();\n    }\n    \n    onUserAction() {\n        // onUserAction podpiety jest do eventa mousemove, wiec dodany jest debouncer (1000 ms)\n        if (this.userActionTimer == null) {\n            this.userActionTimer = setTimeout(() => {\n                this.triggerEvent(\"userAction\");\n                clearTimeout(this.userActionTimer);\n                this.userActionTimer = null;\n            }, 1000);\n        }\n    }\n    \n    getFocusedElement(): FocusedElement {\n        let $ae = $(document.activeElement);\n        if ($ae.closest(\".sidebar-container\").length > 0) {\n            return FocusedElement.SIDEBAR;\n        }\n        if ($ae.closest(\".section-chats\").length > 0) {\n            return FocusedElement.MESSAGES;\n        }\n        return null;\n    }\n    \n    refreshFocus() {\n        let fe = this.getFocusedElement();\n        if (fe == FocusedElement.MESSAGES) {\n            if ($(document.activeElement).closest(\".messages-container\").get(0) != this.active.$container.get(0)) {\n                this.focusMessages();\n            }\n        }\n        else if (fe == null) {\n            this.sidebar.$container.focus();\n        }\n    }\n    \n    focusMessages() {\n        this.active.$container.focus();\n        setTimeout(() => {\n            let $el = this.active.$container.find(\".reply-field\");\n            $el.focus();\n            this.helper.placeInputCaretAtEnd($el.get(0), document);\n        }, 0);\n    }\n    \n    onKeydown(event: KeyboardEvent): void {\n        if (event.keyCode == webUtils.KEY_CODES.tab && !(event.ctrlKey || event.metaKey)) {\n            event.preventDefault();\n            let fe = this.getFocusedElement();\n            if (fe == FocusedElement.SIDEBAR) {\n                this.switchToPanel(FocusedElement.MESSAGES, true);\n            }\n            else {\n                this.switchToPanel(FocusedElement.SIDEBAR, true);\n            }\n        }\n    }\n    \n    grabFocus(highlight: boolean = true): void {\n        let fe = this.getFocusedElement();\n        this.switchToPanel(fe == null ? FocusedElement.SIDEBAR : fe, highlight);\n    }\n    \n    switchToPanel(fe: FocusedElement, showHighlight: boolean) {\n        this.$main.find(\".focus-hightlight\").remove();\n        let $highlight = $('<div class=\"focus-hightlight\"></div>');\n        let currentFe = this.getFocusedElement();\n        \n        if (showHighlight && currentFe != fe) {\n            if (fe == FocusedElement.SIDEBAR) {\n                if (this.active) {\n                    this.active.blurInputFocus();\n                }\n                this.sidebar.$container.focus();\n                this.$main.find(\".sidebar-container\").append($highlight);\n                //TODO: If there is no selected element in sidebar then select first one\n            }\n            else if (fe == FocusedElement.MESSAGES) {\n                this.active.$container.find(\".chat\").parent().parent().append($highlight);\n                this.focusMessages();\n            }\n        }\n        setTimeout(() => {\n            $highlight.remove();\n        }, 500);\n    }\n    \n    hideEmojiPicker(e: MouseEvent): void {\n        e.stopPropagation();\n        if (this.active instanceof component.disabledsection.DisabledSectionView) {\n            return;\n        }\n        if (this.active instanceof PrivateConversationsView) {\n            return;\n        }\n        if ($(e.target).hasClass(\"emoji-btn\")) {\n            return;\n        }\n        this.dispatchEvent({type: \"hide-emoji-picker\"});\n    }\n    \n    changeIsSearchOn(isOn: boolean): void {\n        this.isSearchOn = isOn;\n        this.sidebar.$container.toggleClass(\"search-on\", isOn);\n        this.sidebar.refreshInfoTooltips();\n    }\n    \n    expandRemoteSectionsList(host: string, hostHash: string): void {\n        if (this.isRemoteHostVisible(hostHash)) {\n            this.toggleRemoteHost(hostHash, false);\n            return;\n        }\n        let $hostElement: JQuery<HTMLElement>;\n        this.sidebar.showHostLoading(hostHash, false);\n        Q().then(() => {\n            if (! this.remoteServers) {\n                this.remoteServers = {};\n            }\n            if (hostHash in this.remoteServers) {\n                return;\n            }\n            $hostElement = this.$main.find(\".host-element[data-host-id='\" + hostHash + \"']\");\n\n            if (! this.remoteListsExists(hostHash)) {\n                return Q().then(() => {\n                    $hostElement.parent().append($(\"<div class='remote-sections' data-host-id='\" + hostHash + \"'></div>\"));\n                    $hostElement.parent().append($(\"<div class='remote-conversations' data-host-id='\" + hostHash + \"'></div>\"));\n        \n                    let hostModel: HostEntryModel = {\n                        host: host,\n                        sectionsList: this.addComponent(\"remoteSectionsList-\" + hostHash, new component.remotesectionlist.RemoteSectionListView(this, {\n                            extList: {template: null}\n                        })),\n                        conv2List: this.addComponent(\"remoteConv2List-\" + hostHash, new component.remoteconv2list.RemoteConv2ListView(this, {\n                            personsView: this.personsComponent,\n                            extList: {template: null}\n                        }))\n                    };\n                    hostModel.sectionsList.sections.$container = $hostElement.parent().find(\".remote-sections[data-host-id='\" + hostHash + \"']\");\n                    hostModel.conv2List.conversations.$container = $hostElement.parent().find(\".remote-conversations[data-host-id='\" + hostHash + \"']\");\n                    \n                    this.sidebar.remoteSectionLists[hostHash] = hostModel.sectionsList;\n                    this.sidebar.remoteConv2Lists[hostHash] = hostModel.conv2List;\n                    \n                    this.remoteServers[hostHash] = hostModel;\n                    return Q.all([\n                        hostModel.sectionsList.triggerInit(),\n                        hostModel.conv2List.triggerInit()\n                    ]);\n                })\n            }\n        })\n        .then(() => {\n            this.toggleRemoteHost(hostHash, true);\n        })\n    }\n\n    toggleRemoteHost(hostHash: string, visible: boolean) {\n        let $hostElement = this.$main.find(\".host-element[data-host-id='\" + hostHash + \"']\");\n        $hostElement.parent().find(\".remote-sections[data-host-id='\" + hostHash + \"']\").toggleClass(\"hide\", !visible);\n        $hostElement.parent().find(\".remote-conversations[data-host-id='\" + hostHash + \"']\").toggleClass(\"hide\", !visible);\n        this.sidebar.hostList.toggleHostElementIsExpanded(hostHash, visible);\n    }\n\n    isRemoteHostVisible(hostHash: string): boolean {\n        let $hostElement = this.$main.find(\".host-element[data-host-id='\" + hostHash + \"']\");\n        return ! $hostElement.find(\".fa.expanded\").hasClass(\"hide\");\n    }\n\n    remoteListsExists(hostHash: string): boolean {\n        let $hostElement = this.$main.find(\".host-element[data-host-id='\" + hostHash + \"']\");\n        let remoteSectionsExists = $hostElement.parent().find(\".remote-sections[data-host-id='\" + hostHash + \"']\").length > 0;\n        return remoteSectionsExists;\n    }\n    \n    // openVideoConferencePanel(): void {\n    //     this.$mainContainer.addClass(\"with-video-conference\");\n    // }\n    \n    // closeVideoConferencePanel(): void {\n    //     this.$mainContainer.removeClass(\"with-video-conference\");\n    // }\n    \n}\n\n(<any>ChatWindowView.prototype).className = \"com.privmx.plugin.chat.window.chat.ChatWindowView\";"],"sourceRoot":"../../../src"}